{"version":3,"file":"maplatcore_api.js","mappings":"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","sources":["webpack:///../node_modules/lodash._reinterpolate/index.js","webpack:///../node_modules/lodash.template/index.js","webpack:///../node_modules/lodash.templatesettings/index.js","webpack:///../node_modules/@babel/runtime/helpers/esm/typeof.js","webpack:///../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack:///../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack:///../node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack:///../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack:///../node_modules/@babel/runtime/helpers/esm/inherits.js","webpack:///../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","webpack:///../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack:///../node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack:///../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack:///../node_modules/@babel/runtime/helpers/esm/toArray.js","webpack:///../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","webpack:///../node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack:///../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","webpack:///../node_modules/i18next/dist/esm/i18next.js","webpack:///../node_modules/i18next-xhr-backend/dist/esm/i18nextXHRBackend.js","webpack:///../src/customevent.ts","webpack:///../src/browserlanguage.ts","webpack:///../src/logger.ts","webpack:///../src/const_ex.ts","webpack:///../src/normalize_pois.ts","webpack:///../src/source/mixin.ts","webpack:///../src/functions.ts","webpack:///../node_modules/ol/Geolocation.js","webpack:///../src/view_ex.ts","webpack:///../node_modules/ol/renderer/canvas/TileLayer.js","webpack:///../node_modules/ol/layer/Tile.js","webpack:///../node_modules/ol/geom/Circle.js","webpack:///../node_modules/ol/source/OSM.js","webpack:///../node_modules/@turf/boolean-point-in-polygon/dist/es/index.js","webpack:///../src/source/nowmap.ts","webpack:///../src/source/mapboxmap.ts","webpack:///../src/math_ex.ts","webpack:///../src/layer_mapbox.ts","webpack:///../parts/bluedot.png","webpack:///../parts/defaultpin.png","webpack:///../src/map_ex.ts","webpack:///../parts/bluedot_transparent.png","webpack:///../parts/bluedot_small.png","webpack:///../node_modules/ol/interaction/DragRotateAndZoom.js","webpack:///../src/source/histmap.ts","webpack:///../src/source/tmsmap.ts","webpack:///../node_modules/weiwudi/src/weiwudi.js","webpack:///../src/proj_ex.ts","webpack:///../src/source/store_handler.ts","webpack:///../src/source/histmap_tin.ts","webpack:///../node_modules/whatwg-fetch/fetch.js","webpack:///../src/source_ex.ts","webpack:///../parts/osm.jpg","webpack:///../parts/gsi.jpg","webpack:///../parts/gsi_ortho.jpg","webpack:///../src/freeze_locales.ts","webpack:///../src/template_works.ts","webpack:///../src/index.ts","webpack:///../parts/defaultpin_selected.png","webpack:///./maplatcore_api.js"],"sourcesContent":["/**\n * lodash 3.0.0 (Custom Build) <https://lodash.com/>\n * Build: `lodash modern modularize exports=\"npm\" -o ./`\n * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.7.0 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <https://lodash.com/license>\n */\n\n/** Used to match template delimiters. */\nvar reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\nmodule.exports = reInterpolate;\n","/**\n * Lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\nvar reInterpolate = require('lodash._reinterpolate'),\n    templateSettings = require('lodash.templatesettings');\n\n/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_SAFE_INTEGER = 9007199254740991;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    asyncTag = '[object AsyncFunction]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    domExcTag = '[object DOMException]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    nullTag = '[object Null]',\n    objectTag = '[object Object]',\n    proxyTag = '[object Proxy]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    undefinedTag = '[object Undefined]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to match empty string literals in compiled template source. */\nvar reEmptyStringLeading = /\\b__p \\+= '';/g,\n    reEmptyStringMiddle = /\\b(__p \\+=) '' \\+/g,\n    reEmptyStringTrailing = /(__e\\(.*?\\)|\\b__t\\)) \\+\\n'';/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/**\n * Used to match\n * [ES template delimiters](http://ecma-international.org/ecma-262/7.0/#sec-template-literal-lexical-components).\n */\nvar reEsTemplate = /\\$\\{([^\\\\}]*(?:\\\\.[^\\\\}]*)*)\\}/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/** Used to ensure capturing order of template delimiters. */\nvar reNoMatch = /($^)/;\n\n/** Used to match unescaped characters in compiled string literals. */\nvar reUnescapedString = /['\\n\\r\\u2028\\u2029\\\\]/g;\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/** Used to escape characters for inclusion in compiled string literals. */\nvar stringEscapes = {\n  '\\\\': '\\\\',\n  \"'\": \"'\",\n  '\\n': 'n',\n  '\\r': 'r',\n  '\\u2028': 'u2028',\n  '\\u2029': 'u2029'\n};\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\n/**\n * Used by `_.template` to escape characters for inclusion in compiled string literals.\n *\n * @private\n * @param {string} chr The matched character to escape.\n * @returns {string} Returns the escaped character.\n */\nfunction escapeStringChar(chr) {\n  return '\\\\' + stringEscapes[chr];\n}\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    Symbol = root.Symbol,\n    getPrototype = overArg(Object.getPrototypeOf, Object),\n    propertyIsEnumerable = objectProto.propertyIsEnumerable,\n    symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined,\n    nativeKeys = overArg(Object.keys, Object),\n    nativeMax = Math.max,\n    nativeNow = Date.now;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\n/**\n * Used by `_.defaults` to customize its `_.assignIn` use to assign properties\n * of source objects to the destination object for all destination properties\n * that resolve to `undefined`.\n *\n * @private\n * @param {*} objValue The destination value.\n * @param {*} srcValue The source value.\n * @param {string} key The key of the property to assign.\n * @param {Object} object The parent object of `objValue`.\n * @returns {*} Returns the value to assign.\n */\nfunction customDefaultsAssignIn(objValue, srcValue, key, object) {\n  if (objValue === undefined ||\n      (eq(objValue, objectProto[key]) && !hasOwnProperty.call(object, key))) {\n    return srcValue;\n  }\n  return objValue;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\n/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\n/**\n * Checks if `value` is an `Error`, `EvalError`, `RangeError`, `ReferenceError`,\n * `SyntaxError`, `TypeError`, or `URIError` object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an error object, else `false`.\n * @example\n *\n * _.isError(new Error);\n * // => true\n *\n * _.isError(Error);\n * // => false\n */\nfunction isError(value) {\n  if (!isObjectLike(value)) {\n    return false;\n  }\n  var tag = baseGetTag(value);\n  return tag == errorTag || tag == domExcTag ||\n    (typeof value.message == 'string' && typeof value.name == 'string' && !isPlainObject(value));\n}\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * This method is like `_.assignIn` except that it accepts `customizer`\n * which is invoked to produce the assigned values. If `customizer` returns\n * `undefined`, assignment is handled by the method instead. The `customizer`\n * is invoked with five arguments: (objValue, srcValue, key, object, source).\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @alias extendWith\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} sources The source objects.\n * @param {Function} [customizer] The function to customize assigned values.\n * @returns {Object} Returns `object`.\n * @see _.assignWith\n * @example\n *\n * function customizer(objValue, srcValue) {\n *   return _.isUndefined(objValue) ? srcValue : objValue;\n * }\n *\n * var defaults = _.partialRight(_.assignInWith, customizer);\n *\n * defaults({ 'a': 1 }, { 'b': 2 }, { 'a': 3 });\n * // => { 'a': 1, 'b': 2 }\n */\nvar assignInWith = createAssigner(function(object, source, srcIndex, customizer) {\n  copyObject(source, keysIn(source), object, customizer);\n});\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\n/**\n * Creates a compiled template function that can interpolate data properties\n * in \"interpolate\" delimiters, HTML-escape interpolated data properties in\n * \"escape\" delimiters, and execute JavaScript in \"evaluate\" delimiters. Data\n * properties may be accessed as free variables in the template. If a setting\n * object is given, it takes precedence over `_.templateSettings` values.\n *\n * **Note:** In the development build `_.template` utilizes\n * [sourceURLs](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl)\n * for easier debugging.\n *\n * For more information on precompiling templates see\n * [lodash's custom builds documentation](https://lodash.com/custom-builds).\n *\n * For more information on Chrome extension sandboxes see\n * [Chrome's extensions documentation](https://developer.chrome.com/extensions/sandboxingEval).\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category String\n * @param {string} [string=''] The template string.\n * @param {Object} [options={}] The options object.\n * @param {RegExp} [options.escape=_.templateSettings.escape]\n *  The HTML \"escape\" delimiter.\n * @param {RegExp} [options.evaluate=_.templateSettings.evaluate]\n *  The \"evaluate\" delimiter.\n * @param {Object} [options.imports=_.templateSettings.imports]\n *  An object to import into the template as free variables.\n * @param {RegExp} [options.interpolate=_.templateSettings.interpolate]\n *  The \"interpolate\" delimiter.\n * @param {string} [options.sourceURL='templateSources[n]']\n *  The sourceURL of the compiled template.\n * @param {string} [options.variable='obj']\n *  The data object variable name.\n * @param- {Object} [guard] Enables use as an iteratee for methods like `_.map`.\n * @returns {Function} Returns the compiled template function.\n * @example\n *\n * // Use the \"interpolate\" delimiter to create a compiled template.\n * var compiled = _.template('hello <%= user %>!');\n * compiled({ 'user': 'fred' });\n * // => 'hello fred!'\n *\n * // Use the HTML \"escape\" delimiter to escape data property values.\n * var compiled = _.template('<b><%- value %></b>');\n * compiled({ 'value': '<script>' });\n * // => '<b>&lt;script&gt;</b>'\n *\n * // Use the \"evaluate\" delimiter to execute JavaScript and generate HTML.\n * var compiled = _.template('<% _.forEach(users, function(user) { %><li><%- user %></li><% }); %>');\n * compiled({ 'users': ['fred', 'barney'] });\n * // => '<li>fred</li><li>barney</li>'\n *\n * // Use the internal `print` function in \"evaluate\" delimiters.\n * var compiled = _.template('<% print(\"hello \" + user); %>!');\n * compiled({ 'user': 'barney' });\n * // => 'hello barney!'\n *\n * // Use the ES template literal delimiter as an \"interpolate\" delimiter.\n * // Disable support by replacing the \"interpolate\" delimiter.\n * var compiled = _.template('hello ${ user }!');\n * compiled({ 'user': 'pebbles' });\n * // => 'hello pebbles!'\n *\n * // Use backslashes to treat delimiters as plain text.\n * var compiled = _.template('<%= \"\\\\<%- value %\\\\>\" %>');\n * compiled({ 'value': 'ignored' });\n * // => '<%- value %>'\n *\n * // Use the `imports` option to import `jQuery` as `jq`.\n * var text = '<% jq.each(users, function(user) { %><li><%- user %></li><% }); %>';\n * var compiled = _.template(text, { 'imports': { 'jq': jQuery } });\n * compiled({ 'users': ['fred', 'barney'] });\n * // => '<li>fred</li><li>barney</li>'\n *\n * // Use the `sourceURL` option to specify a custom sourceURL for the template.\n * var compiled = _.template('hello <%= user %>!', { 'sourceURL': '/basic/greeting.jst' });\n * compiled(data);\n * // => Find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector.\n *\n * // Use the `variable` option to ensure a with-statement isn't used in the compiled template.\n * var compiled = _.template('hi <%= data.user %>!', { 'variable': 'data' });\n * compiled.source;\n * // => function(data) {\n * //   var __t, __p = '';\n * //   __p += 'hi ' + ((__t = ( data.user )) == null ? '' : __t) + '!';\n * //   return __p;\n * // }\n *\n * // Use custom template delimiters.\n * _.templateSettings.interpolate = /{{([\\s\\S]+?)}}/g;\n * var compiled = _.template('hello {{ user }}!');\n * compiled({ 'user': 'mustache' });\n * // => 'hello mustache!'\n *\n * // Use the `source` property to inline compiled templates for meaningful\n * // line numbers in error messages and stack traces.\n * fs.writeFileSync(path.join(process.cwd(), 'jst.js'), '\\\n *   var JST = {\\\n *     \"main\": ' + _.template(mainText).source + '\\\n *   };\\\n * ');\n */\nfunction template(string, options, guard) {\n  // Based on John Resig's `tmpl` implementation\n  // (http://ejohn.org/blog/javascript-micro-templating/)\n  // and Laura Doktorova's doT.js (https://github.com/olado/doT).\n  var settings = templateSettings.imports._.templateSettings || templateSettings;\n\n  if (guard && isIterateeCall(string, options, guard)) {\n    options = undefined;\n  }\n  string = toString(string);\n  options = assignInWith({}, options, settings, customDefaultsAssignIn);\n\n  var imports = assignInWith({}, options.imports, settings.imports, customDefaultsAssignIn),\n      importsKeys = keys(imports),\n      importsValues = baseValues(imports, importsKeys);\n\n  var isEscaping,\n      isEvaluating,\n      index = 0,\n      interpolate = options.interpolate || reNoMatch,\n      source = \"__p += '\";\n\n  // Compile the regexp to match each delimiter.\n  var reDelimiters = RegExp(\n    (options.escape || reNoMatch).source + '|' +\n    interpolate.source + '|' +\n    (interpolate === reInterpolate ? reEsTemplate : reNoMatch).source + '|' +\n    (options.evaluate || reNoMatch).source + '|$'\n  , 'g');\n\n  // Use a sourceURL for easier debugging.\n  // The sourceURL gets injected into the source that's eval-ed, so be careful\n  // with lookup (in case of e.g. prototype pollution), and strip newlines if any.\n  // A newline wouldn't be a valid sourceURL anyway, and it'd enable code injection.\n  var sourceURL = hasOwnProperty.call(options, 'sourceURL')\n    ? ('//# sourceURL=' +\n       (options.sourceURL + '').replace(/[\\r\\n]/g, ' ') +\n       '\\n')\n    : '';\n\n  string.replace(reDelimiters, function(match, escapeValue, interpolateValue, esTemplateValue, evaluateValue, offset) {\n    interpolateValue || (interpolateValue = esTemplateValue);\n\n    // Escape characters that can't be included in string literals.\n    source += string.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n\n    // Replace delimiters with snippets.\n    if (escapeValue) {\n      isEscaping = true;\n      source += \"' +\\n__e(\" + escapeValue + \") +\\n'\";\n    }\n    if (evaluateValue) {\n      isEvaluating = true;\n      source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n    }\n    if (interpolateValue) {\n      source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n    }\n    index = offset + match.length;\n\n    // The JS engine embedded in Adobe products needs `match` returned in\n    // order to produce the correct `offset` value.\n    return match;\n  });\n\n  source += \"';\\n\";\n\n  // If `variable` is not specified wrap a with-statement around the generated\n  // code to add the data object to the top of the scope chain.\n  // Like with sourceURL, we take care to not check the option's prototype,\n  // as this configuration is a code injection vector.\n  var variable = hasOwnProperty.call(options, 'variable') && options.variable;\n  if (!variable) {\n    source = 'with (obj) {\\n' + source + '\\n}\\n';\n  }\n  // Cleanup code by stripping empty strings.\n  source = (isEvaluating ? source.replace(reEmptyStringLeading, '') : source)\n    .replace(reEmptyStringMiddle, '$1')\n    .replace(reEmptyStringTrailing, '$1;');\n\n  // Frame code as the function body.\n  source = 'function(' + (variable || 'obj') + ') {\\n' +\n    (variable\n      ? ''\n      : 'obj || (obj = {});\\n'\n    ) +\n    \"var __t, __p = ''\" +\n    (isEscaping\n       ? ', __e = _.escape'\n       : ''\n    ) +\n    (isEvaluating\n      ? ', __j = Array.prototype.join;\\n' +\n        \"function print() { __p += __j.call(arguments, '') }\\n\"\n      : ';\\n'\n    ) +\n    source +\n    'return __p\\n}';\n\n  var result = attempt(function() {\n    return Function(importsKeys, sourceURL + 'return ' + source)\n      .apply(undefined, importsValues);\n  });\n\n  // Provide the compiled function's source by its `toString` method or\n  // the `source` property as a convenience for inlining compiled templates.\n  result.source = source;\n  if (isError(result)) {\n    throw result;\n  }\n  return result;\n}\n\n/**\n * Attempts to invoke `func`, returning either the result or the caught error\n * object. Any additional arguments are provided to `func` when it's invoked.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Util\n * @param {Function} func The function to attempt.\n * @param {...*} [args] The arguments to invoke `func` with.\n * @returns {*} Returns the `func` result or error object.\n * @example\n *\n * // Avoid throwing errors for invalid selectors.\n * var elements = _.attempt(function(selector) {\n *   return document.querySelectorAll(selector);\n * }, '>_>');\n *\n * if (_.isError(elements)) {\n *   elements = [];\n * }\n */\nvar attempt = baseRest(function(func, args) {\n  try {\n    return apply(func, undefined, args);\n  } catch (e) {\n    return isError(e) ? e : new Error(e);\n  }\n});\n\n/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\n/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\n/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = template;\n","/**\n * Lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\nvar reInterpolate = require('lodash._reinterpolate');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    symbolTag = '[object Symbol]',\n    undefinedTag = '[object Undefined]';\n\n/** Used to match HTML entities and HTML characters. */\nvar reUnescapedHtml = /[&<>\"']/g,\n    reHasUnescapedHtml = RegExp(reUnescapedHtml.source);\n\n/** Used to match template delimiters. */\nvar reEscape = /<%-([\\s\\S]+?)%>/g,\n    reEvaluate = /<%([\\s\\S]+?)%>/g;\n\n/** Used to map characters to HTML entities. */\nvar htmlEscapes = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\n/**\n * The base implementation of `_.propertyOf` without support for deep paths.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyOf(object) {\n  return function(key) {\n    return object == null ? undefined : object[key];\n  };\n}\n\n/**\n * Used by `_.escape` to convert characters to HTML entities.\n *\n * @private\n * @param {string} chr The matched character to escape.\n * @returns {string} Returns the escaped character.\n */\nvar escapeHtmlChar = basePropertyOf(htmlEscapes);\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * By default, the template delimiters used by lodash are like those in\n * embedded Ruby (ERB) as well as ES2015 template strings. Change the\n * following template settings to use alternative delimiters.\n *\n * @static\n * @memberOf _\n * @type {Object}\n */\nvar templateSettings = {\n\n  /**\n   * Used to detect `data` property values to be HTML-escaped.\n   *\n   * @memberOf _.templateSettings\n   * @type {RegExp}\n   */\n  'escape': reEscape,\n\n  /**\n   * Used to detect code to be evaluated.\n   *\n   * @memberOf _.templateSettings\n   * @type {RegExp}\n   */\n  'evaluate': reEvaluate,\n\n  /**\n   * Used to detect `data` property values to inject.\n   *\n   * @memberOf _.templateSettings\n   * @type {RegExp}\n   */\n  'interpolate': reInterpolate,\n\n  /**\n   * Used to reference the data object in the template text.\n   *\n   * @memberOf _.templateSettings\n   * @type {string}\n   */\n  'variable': '',\n\n  /**\n   * Used to import variables into the compiled template.\n   *\n   * @memberOf _.templateSettings\n   * @type {Object}\n   */\n  'imports': {\n\n    /**\n     * A reference to the `lodash` function.\n     *\n     * @memberOf _.templateSettings.imports\n     * @type {Function}\n     */\n    '_': { 'escape': escape }\n  }\n};\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Converts the characters \"&\", \"<\", \">\", '\"', and \"'\" in `string` to their\n * corresponding HTML entities.\n *\n * **Note:** No other characters are escaped. To escape additional\n * characters use a third-party library like [_he_](https://mths.be/he).\n *\n * Though the \">\" character is escaped for symmetry, characters like\n * \">\" and \"/\" don't need escaping in HTML and have no special meaning\n * unless they're part of a tag or unquoted attribute value. See\n * [Mathias Bynens's article](https://mathiasbynens.be/notes/ambiguous-ampersands)\n * (under \"semi-related fun fact\") for more details.\n *\n * When working with HTML you should always\n * [quote attribute values](http://wonko.com/post/html-escaping) to reduce\n * XSS vectors.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category String\n * @param {string} [string=''] The string to escape.\n * @returns {string} Returns the escaped string.\n * @example\n *\n * _.escape('fred, barney, & pebbles');\n * // => 'fred, barney, &amp; pebbles'\n */\nfunction escape(string) {\n  string = toString(string);\n  return (string && reHasUnescapedHtml.test(string))\n    ? string.replace(reUnescapedHtml, escapeHtmlChar)\n    : string;\n}\n\nmodule.exports = templateSettings;\n","export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, toPropertyKey(descriptor.key), descriptor);\n  }\n}\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","import _typeof from \"./typeof.js\";\nimport assertThisInitialized from \"./assertThisInitialized.js\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n  return assertThisInitialized(self);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _toArray(arr) {\n  return arrayWithHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import _typeof from '@babel/runtime/helpers/esm/typeof';\nimport _classCallCheck from '@babel/runtime/helpers/esm/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/esm/createClass';\nimport _assertThisInitialized from '@babel/runtime/helpers/esm/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/esm/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/esm/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/esm/getPrototypeOf';\nimport _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport _toArray from '@babel/runtime/helpers/esm/toArray';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar consoleLogger = {\n  type: 'logger',\n  log: function log(args) {\n    this.output('log', args);\n  },\n  warn: function warn(args) {\n    this.output('warn', args);\n  },\n  error: function error(args) {\n    this.output('error', args);\n  },\n  output: function output(type, args) {\n    if (console && console[type]) console[type].apply(console, args);\n  }\n};\n\nvar Logger = function () {\n  function Logger(concreteLogger) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Logger);\n\n    this.init(concreteLogger, options);\n  }\n\n  _createClass(Logger, [{\n    key: \"init\",\n    value: function init(concreteLogger) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      this.prefix = options.prefix || 'i18next:';\n      this.logger = concreteLogger || consoleLogger;\n      this.options = options;\n      this.debug = options.debug;\n    }\n  }, {\n    key: \"setDebug\",\n    value: function setDebug(bool) {\n      this.debug = bool;\n    }\n  }, {\n    key: \"log\",\n    value: function log() {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return this.forward(args, 'log', '', true);\n    }\n  }, {\n    key: \"warn\",\n    value: function warn() {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return this.forward(args, 'warn', '', true);\n    }\n  }, {\n    key: \"error\",\n    value: function error() {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      return this.forward(args, 'error', '');\n    }\n  }, {\n    key: \"deprecate\",\n    value: function deprecate() {\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      return this.forward(args, 'warn', 'WARNING DEPRECATED: ', true);\n    }\n  }, {\n    key: \"forward\",\n    value: function forward(args, lvl, prefix, debugOnly) {\n      if (debugOnly && !this.debug) return null;\n      if (typeof args[0] === 'string') args[0] = \"\".concat(prefix).concat(this.prefix, \" \").concat(args[0]);\n      return this.logger[lvl](args);\n    }\n  }, {\n    key: \"create\",\n    value: function create(moduleName) {\n      return new Logger(this.logger, _objectSpread(_objectSpread({}, {\n        prefix: \"\".concat(this.prefix, \":\").concat(moduleName, \":\")\n      }), this.options));\n    }\n  }]);\n\n  return Logger;\n}();\n\nvar baseLogger = new Logger();\n\nvar EventEmitter = function () {\n  function EventEmitter() {\n    _classCallCheck(this, EventEmitter);\n\n    this.observers = {};\n  }\n\n  _createClass(EventEmitter, [{\n    key: \"on\",\n    value: function on(events, listener) {\n      var _this = this;\n\n      events.split(' ').forEach(function (event) {\n        _this.observers[event] = _this.observers[event] || [];\n\n        _this.observers[event].push(listener);\n      });\n      return this;\n    }\n  }, {\n    key: \"off\",\n    value: function off(event, listener) {\n      if (!this.observers[event]) return;\n\n      if (!listener) {\n        delete this.observers[event];\n        return;\n      }\n\n      this.observers[event] = this.observers[event].filter(function (l) {\n        return l !== listener;\n      });\n    }\n  }, {\n    key: \"emit\",\n    value: function emit(event) {\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      if (this.observers[event]) {\n        var cloned = [].concat(this.observers[event]);\n        cloned.forEach(function (observer) {\n          observer.apply(void 0, args);\n        });\n      }\n\n      if (this.observers['*']) {\n        var _cloned = [].concat(this.observers['*']);\n\n        _cloned.forEach(function (observer) {\n          observer.apply(observer, [event].concat(args));\n        });\n      }\n    }\n  }]);\n\n  return EventEmitter;\n}();\n\nfunction defer() {\n  var res;\n  var rej;\n  var promise = new Promise(function (resolve, reject) {\n    res = resolve;\n    rej = reject;\n  });\n  promise.resolve = res;\n  promise.reject = rej;\n  return promise;\n}\nfunction makeString(object) {\n  if (object == null) return '';\n  return '' + object;\n}\nfunction copy(a, s, t) {\n  a.forEach(function (m) {\n    if (s[m]) t[m] = s[m];\n  });\n}\n\nfunction getLastOfPath(object, path, Empty) {\n  function cleanKey(key) {\n    return key && key.indexOf('###') > -1 ? key.replace(/###/g, '.') : key;\n  }\n\n  function canNotTraverseDeeper() {\n    return !object || typeof object === 'string';\n  }\n\n  var stack = typeof path !== 'string' ? [].concat(path) : path.split('.');\n\n  while (stack.length > 1) {\n    if (canNotTraverseDeeper()) return {};\n    var key = cleanKey(stack.shift());\n    if (!object[key] && Empty) object[key] = new Empty();\n\n    if (Object.prototype.hasOwnProperty.call(object, key)) {\n      object = object[key];\n    } else {\n      object = {};\n    }\n  }\n\n  if (canNotTraverseDeeper()) return {};\n  return {\n    obj: object,\n    k: cleanKey(stack.shift())\n  };\n}\n\nfunction setPath(object, path, newValue) {\n  var _getLastOfPath = getLastOfPath(object, path, Object),\n      obj = _getLastOfPath.obj,\n      k = _getLastOfPath.k;\n\n  obj[k] = newValue;\n}\nfunction pushPath(object, path, newValue, concat) {\n  var _getLastOfPath2 = getLastOfPath(object, path, Object),\n      obj = _getLastOfPath2.obj,\n      k = _getLastOfPath2.k;\n\n  obj[k] = obj[k] || [];\n  if (concat) obj[k] = obj[k].concat(newValue);\n  if (!concat) obj[k].push(newValue);\n}\nfunction getPath(object, path) {\n  var _getLastOfPath3 = getLastOfPath(object, path),\n      obj = _getLastOfPath3.obj,\n      k = _getLastOfPath3.k;\n\n  if (!obj) return undefined;\n  return obj[k];\n}\nfunction getPathWithDefaults(data, defaultData, key) {\n  var value = getPath(data, key);\n\n  if (value !== undefined) {\n    return value;\n  }\n\n  return getPath(defaultData, key);\n}\nfunction deepExtend(target, source, overwrite) {\n  for (var prop in source) {\n    if (prop !== '__proto__' && prop !== 'constructor') {\n      if (prop in target) {\n        if (typeof target[prop] === 'string' || target[prop] instanceof String || typeof source[prop] === 'string' || source[prop] instanceof String) {\n          if (overwrite) target[prop] = source[prop];\n        } else {\n          deepExtend(target[prop], source[prop], overwrite);\n        }\n      } else {\n        target[prop] = source[prop];\n      }\n    }\n  }\n\n  return target;\n}\nfunction regexEscape(str) {\n  return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, '\\\\$&');\n}\nvar _entityMap = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;',\n  '/': '&#x2F;'\n};\nfunction escape(data) {\n  if (typeof data === 'string') {\n    return data.replace(/[&<>\"'\\/]/g, function (s) {\n      return _entityMap[s];\n    });\n  }\n\n  return data;\n}\nvar isIE10 = typeof window !== 'undefined' && window.navigator && typeof window.navigator.userAgentData === 'undefined' && window.navigator.userAgent && window.navigator.userAgent.indexOf('MSIE') > -1;\nvar chars = [' ', ',', '?', '!', ';'];\nfunction looksLikeObjectPath(key, nsSeparator, keySeparator) {\n  nsSeparator = nsSeparator || '';\n  keySeparator = keySeparator || '';\n  var possibleChars = chars.filter(function (c) {\n    return nsSeparator.indexOf(c) < 0 && keySeparator.indexOf(c) < 0;\n  });\n  if (possibleChars.length === 0) return true;\n  var r = new RegExp(\"(\".concat(possibleChars.map(function (c) {\n    return c === '?' ? '\\\\?' : c;\n  }).join('|'), \")\"));\n  var matched = !r.test(key);\n\n  if (!matched) {\n    var ki = key.indexOf(keySeparator);\n\n    if (ki > 0 && !r.test(key.substring(0, ki))) {\n      matched = true;\n    }\n  }\n\n  return matched;\n}\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$1(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction deepFind(obj, path) {\n  var keySeparator = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '.';\n  if (!obj) return undefined;\n  if (obj[path]) return obj[path];\n  var paths = path.split(keySeparator);\n  var current = obj;\n\n  for (var i = 0; i < paths.length; ++i) {\n    if (!current) return undefined;\n\n    if (typeof current[paths[i]] === 'string' && i + 1 < paths.length) {\n      return undefined;\n    }\n\n    if (current[paths[i]] === undefined) {\n      var j = 2;\n      var p = paths.slice(i, i + j).join(keySeparator);\n      var mix = current[p];\n\n      while (mix === undefined && paths.length > i + j) {\n        j++;\n        p = paths.slice(i, i + j).join(keySeparator);\n        mix = current[p];\n      }\n\n      if (mix === undefined) return undefined;\n\n      if (path.endsWith(p)) {\n        if (typeof mix === 'string') return mix;\n        if (p && typeof mix[p] === 'string') return mix[p];\n      }\n\n      var joinedPath = paths.slice(i + j).join(keySeparator);\n      if (joinedPath) return deepFind(mix, joinedPath, keySeparator);\n      return undefined;\n    }\n\n    current = current[paths[i]];\n  }\n\n  return current;\n}\n\nvar ResourceStore = function (_EventEmitter) {\n  _inherits(ResourceStore, _EventEmitter);\n\n  var _super = _createSuper(ResourceStore);\n\n  function ResourceStore(data) {\n    var _this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      ns: ['translation'],\n      defaultNS: 'translation'\n    };\n\n    _classCallCheck(this, ResourceStore);\n\n    _this = _super.call(this);\n\n    if (isIE10) {\n      EventEmitter.call(_assertThisInitialized(_this));\n    }\n\n    _this.data = data || {};\n    _this.options = options;\n\n    if (_this.options.keySeparator === undefined) {\n      _this.options.keySeparator = '.';\n    }\n\n    if (_this.options.ignoreJSONStructure === undefined) {\n      _this.options.ignoreJSONStructure = true;\n    }\n\n    return _this;\n  }\n\n  _createClass(ResourceStore, [{\n    key: \"addNamespaces\",\n    value: function addNamespaces(ns) {\n      if (this.options.ns.indexOf(ns) < 0) {\n        this.options.ns.push(ns);\n      }\n    }\n  }, {\n    key: \"removeNamespaces\",\n    value: function removeNamespaces(ns) {\n      var index = this.options.ns.indexOf(ns);\n\n      if (index > -1) {\n        this.options.ns.splice(index, 1);\n      }\n    }\n  }, {\n    key: \"getResource\",\n    value: function getResource(lng, ns, key) {\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n      var ignoreJSONStructure = options.ignoreJSONStructure !== undefined ? options.ignoreJSONStructure : this.options.ignoreJSONStructure;\n      var path = [lng, ns];\n      if (key && typeof key !== 'string') path = path.concat(key);\n      if (key && typeof key === 'string') path = path.concat(keySeparator ? key.split(keySeparator) : key);\n\n      if (lng.indexOf('.') > -1) {\n        path = lng.split('.');\n      }\n\n      var result = getPath(this.data, path);\n      if (result || !ignoreJSONStructure || typeof key !== 'string') return result;\n      return deepFind(this.data && this.data[lng] && this.data[lng][ns], key, keySeparator);\n    }\n  }, {\n    key: \"addResource\",\n    value: function addResource(lng, ns, key, value) {\n      var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {\n        silent: false\n      };\n      var keySeparator = this.options.keySeparator;\n      if (keySeparator === undefined) keySeparator = '.';\n      var path = [lng, ns];\n      if (key) path = path.concat(keySeparator ? key.split(keySeparator) : key);\n\n      if (lng.indexOf('.') > -1) {\n        path = lng.split('.');\n        value = ns;\n        ns = path[1];\n      }\n\n      this.addNamespaces(ns);\n      setPath(this.data, path, value);\n      if (!options.silent) this.emit('added', lng, ns, key, value);\n    }\n  }, {\n    key: \"addResources\",\n    value: function addResources(lng, ns, resources) {\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {\n        silent: false\n      };\n\n      for (var m in resources) {\n        if (typeof resources[m] === 'string' || Object.prototype.toString.apply(resources[m]) === '[object Array]') this.addResource(lng, ns, m, resources[m], {\n          silent: true\n        });\n      }\n\n      if (!options.silent) this.emit('added', lng, ns, resources);\n    }\n  }, {\n    key: \"addResourceBundle\",\n    value: function addResourceBundle(lng, ns, resources, deep, overwrite) {\n      var options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {\n        silent: false\n      };\n      var path = [lng, ns];\n\n      if (lng.indexOf('.') > -1) {\n        path = lng.split('.');\n        deep = resources;\n        resources = ns;\n        ns = path[1];\n      }\n\n      this.addNamespaces(ns);\n      var pack = getPath(this.data, path) || {};\n\n      if (deep) {\n        deepExtend(pack, resources, overwrite);\n      } else {\n        pack = _objectSpread$1(_objectSpread$1({}, pack), resources);\n      }\n\n      setPath(this.data, path, pack);\n      if (!options.silent) this.emit('added', lng, ns, resources);\n    }\n  }, {\n    key: \"removeResourceBundle\",\n    value: function removeResourceBundle(lng, ns) {\n      if (this.hasResourceBundle(lng, ns)) {\n        delete this.data[lng][ns];\n      }\n\n      this.removeNamespaces(ns);\n      this.emit('removed', lng, ns);\n    }\n  }, {\n    key: \"hasResourceBundle\",\n    value: function hasResourceBundle(lng, ns) {\n      return this.getResource(lng, ns) !== undefined;\n    }\n  }, {\n    key: \"getResourceBundle\",\n    value: function getResourceBundle(lng, ns) {\n      if (!ns) ns = this.options.defaultNS;\n      if (this.options.compatibilityAPI === 'v1') return _objectSpread$1(_objectSpread$1({}, {}), this.getResource(lng, ns));\n      return this.getResource(lng, ns);\n    }\n  }, {\n    key: \"getDataByLanguage\",\n    value: function getDataByLanguage(lng) {\n      return this.data[lng];\n    }\n  }, {\n    key: \"hasLanguageSomeTranslations\",\n    value: function hasLanguageSomeTranslations(lng) {\n      var data = this.getDataByLanguage(lng);\n      var n = data && Object.keys(data) || [];\n      return !!n.find(function (v) {\n        return data[v] && Object.keys(data[v]).length > 0;\n      });\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return this.data;\n    }\n  }]);\n\n  return ResourceStore;\n}(EventEmitter);\n\nvar postProcessor = {\n  processors: {},\n  addPostProcessor: function addPostProcessor(module) {\n    this.processors[module.name] = module;\n  },\n  handle: function handle(processors, value, key, options, translator) {\n    var _this = this;\n\n    processors.forEach(function (processor) {\n      if (_this.processors[processor]) value = _this.processors[processor].process(value, key, options, translator);\n    });\n    return value;\n  }\n};\n\nfunction ownKeys$2(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$2(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$2(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$2(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper$1(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct$1(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct$1() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar checkedLoadedFor = {};\n\nvar Translator = function (_EventEmitter) {\n  _inherits(Translator, _EventEmitter);\n\n  var _super = _createSuper$1(Translator);\n\n  function Translator(services) {\n    var _this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Translator);\n\n    _this = _super.call(this);\n\n    if (isIE10) {\n      EventEmitter.call(_assertThisInitialized(_this));\n    }\n\n    copy(['resourceStore', 'languageUtils', 'pluralResolver', 'interpolator', 'backendConnector', 'i18nFormat', 'utils'], services, _assertThisInitialized(_this));\n    _this.options = options;\n\n    if (_this.options.keySeparator === undefined) {\n      _this.options.keySeparator = '.';\n    }\n\n    _this.logger = baseLogger.create('translator');\n    return _this;\n  }\n\n  _createClass(Translator, [{\n    key: \"changeLanguage\",\n    value: function changeLanguage(lng) {\n      if (lng) this.language = lng;\n    }\n  }, {\n    key: \"exists\",\n    value: function exists(key) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        interpolation: {}\n      };\n\n      if (key === undefined || key === null) {\n        return false;\n      }\n\n      var resolved = this.resolve(key, options);\n      return resolved && resolved.res !== undefined;\n    }\n  }, {\n    key: \"extractFromKey\",\n    value: function extractFromKey(key, options) {\n      var nsSeparator = options.nsSeparator !== undefined ? options.nsSeparator : this.options.nsSeparator;\n      if (nsSeparator === undefined) nsSeparator = ':';\n      var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n      var namespaces = options.ns || this.options.defaultNS || [];\n      var wouldCheckForNsInKey = nsSeparator && key.indexOf(nsSeparator) > -1;\n      var seemsNaturalLanguage = !this.options.userDefinedKeySeparator && !options.keySeparator && !this.options.userDefinedNsSeparator && !options.nsSeparator && !looksLikeObjectPath(key, nsSeparator, keySeparator);\n\n      if (wouldCheckForNsInKey && !seemsNaturalLanguage) {\n        var m = key.match(this.interpolator.nestingRegexp);\n\n        if (m && m.length > 0) {\n          return {\n            key: key,\n            namespaces: namespaces\n          };\n        }\n\n        var parts = key.split(nsSeparator);\n        if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1) namespaces = parts.shift();\n        key = parts.join(keySeparator);\n      }\n\n      if (typeof namespaces === 'string') namespaces = [namespaces];\n      return {\n        key: key,\n        namespaces: namespaces\n      };\n    }\n  }, {\n    key: \"translate\",\n    value: function translate(keys, options, lastKey) {\n      var _this2 = this;\n\n      if (_typeof(options) !== 'object' && this.options.overloadTranslationOptionHandler) {\n        options = this.options.overloadTranslationOptionHandler(arguments);\n      }\n\n      if (!options) options = {};\n      if (keys === undefined || keys === null) return '';\n      if (!Array.isArray(keys)) keys = [String(keys)];\n      var returnDetails = options.returnDetails !== undefined ? options.returnDetails : this.options.returnDetails;\n      var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n\n      var _this$extractFromKey = this.extractFromKey(keys[keys.length - 1], options),\n          key = _this$extractFromKey.key,\n          namespaces = _this$extractFromKey.namespaces;\n\n      var namespace = namespaces[namespaces.length - 1];\n      var lng = options.lng || this.language;\n      var appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;\n\n      if (lng && lng.toLowerCase() === 'cimode') {\n        if (appendNamespaceToCIMode) {\n          var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n\n          if (returnDetails) {\n            resolved.res = \"\".concat(namespace).concat(nsSeparator).concat(key);\n            return resolved;\n          }\n\n          return \"\".concat(namespace).concat(nsSeparator).concat(key);\n        }\n\n        if (returnDetails) {\n          resolved.res = key;\n          return resolved;\n        }\n\n        return key;\n      }\n\n      var resolved = this.resolve(keys, options);\n      var res = resolved && resolved.res;\n      var resUsedKey = resolved && resolved.usedKey || key;\n      var resExactUsedKey = resolved && resolved.exactUsedKey || key;\n      var resType = Object.prototype.toString.apply(res);\n      var noObject = ['[object Number]', '[object Function]', '[object RegExp]'];\n      var joinArrays = options.joinArrays !== undefined ? options.joinArrays : this.options.joinArrays;\n      var handleAsObjectInI18nFormat = !this.i18nFormat || this.i18nFormat.handleAsObject;\n      var handleAsObject = typeof res !== 'string' && typeof res !== 'boolean' && typeof res !== 'number';\n\n      if (handleAsObjectInI18nFormat && res && handleAsObject && noObject.indexOf(resType) < 0 && !(typeof joinArrays === 'string' && resType === '[object Array]')) {\n        if (!options.returnObjects && !this.options.returnObjects) {\n          if (!this.options.returnedObjectHandler) {\n            this.logger.warn('accessing an object - but returnObjects options is not enabled!');\n          }\n\n          var r = this.options.returnedObjectHandler ? this.options.returnedObjectHandler(resUsedKey, res, _objectSpread$2(_objectSpread$2({}, options), {}, {\n            ns: namespaces\n          })) : \"key '\".concat(key, \" (\").concat(this.language, \")' returned an object instead of string.\");\n\n          if (returnDetails) {\n            resolved.res = r;\n            return resolved;\n          }\n\n          return r;\n        }\n\n        if (keySeparator) {\n          var resTypeIsArray = resType === '[object Array]';\n          var copy = resTypeIsArray ? [] : {};\n          var newKeyToUse = resTypeIsArray ? resExactUsedKey : resUsedKey;\n\n          for (var m in res) {\n            if (Object.prototype.hasOwnProperty.call(res, m)) {\n              var deepKey = \"\".concat(newKeyToUse).concat(keySeparator).concat(m);\n              copy[m] = this.translate(deepKey, _objectSpread$2(_objectSpread$2({}, options), {\n                joinArrays: false,\n                ns: namespaces\n              }));\n              if (copy[m] === deepKey) copy[m] = res[m];\n            }\n          }\n\n          res = copy;\n        }\n      } else if (handleAsObjectInI18nFormat && typeof joinArrays === 'string' && resType === '[object Array]') {\n        res = res.join(joinArrays);\n        if (res) res = this.extendTranslation(res, keys, options, lastKey);\n      } else {\n        var usedDefault = false;\n        var usedKey = false;\n        var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n        var hasDefaultValue = Translator.hasDefaultValue(options);\n        var defaultValueSuffix = needsPluralHandling ? this.pluralResolver.getSuffix(lng, options.count, options) : '';\n        var defaultValue = options[\"defaultValue\".concat(defaultValueSuffix)] || options.defaultValue;\n\n        if (!this.isValidLookup(res) && hasDefaultValue) {\n          usedDefault = true;\n          res = defaultValue;\n        }\n\n        if (!this.isValidLookup(res)) {\n          usedKey = true;\n          res = key;\n        }\n\n        var missingKeyNoValueFallbackToKey = options.missingKeyNoValueFallbackToKey || this.options.missingKeyNoValueFallbackToKey;\n        var resForMissing = missingKeyNoValueFallbackToKey && usedKey ? undefined : res;\n        var updateMissing = hasDefaultValue && defaultValue !== res && this.options.updateMissing;\n\n        if (usedKey || usedDefault || updateMissing) {\n          this.logger.log(updateMissing ? 'updateKey' : 'missingKey', lng, namespace, key, updateMissing ? defaultValue : res);\n\n          if (keySeparator) {\n            var fk = this.resolve(key, _objectSpread$2(_objectSpread$2({}, options), {}, {\n              keySeparator: false\n            }));\n            if (fk && fk.res) this.logger.warn('Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.');\n          }\n\n          var lngs = [];\n          var fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);\n\n          if (this.options.saveMissingTo === 'fallback' && fallbackLngs && fallbackLngs[0]) {\n            for (var i = 0; i < fallbackLngs.length; i++) {\n              lngs.push(fallbackLngs[i]);\n            }\n          } else if (this.options.saveMissingTo === 'all') {\n            lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);\n          } else {\n            lngs.push(options.lng || this.language);\n          }\n\n          var send = function send(l, k, specificDefaultValue) {\n            var defaultForMissing = hasDefaultValue && specificDefaultValue !== res ? specificDefaultValue : resForMissing;\n\n            if (_this2.options.missingKeyHandler) {\n              _this2.options.missingKeyHandler(l, namespace, k, defaultForMissing, updateMissing, options);\n            } else if (_this2.backendConnector && _this2.backendConnector.saveMissing) {\n              _this2.backendConnector.saveMissing(l, namespace, k, defaultForMissing, updateMissing, options);\n            }\n\n            _this2.emit('missingKey', l, namespace, k, res);\n          };\n\n          if (this.options.saveMissing) {\n            if (this.options.saveMissingPlurals && needsPluralHandling) {\n              lngs.forEach(function (language) {\n                _this2.pluralResolver.getSuffixes(language, options).forEach(function (suffix) {\n                  send([language], key + suffix, options[\"defaultValue\".concat(suffix)] || defaultValue);\n                });\n              });\n            } else {\n              send(lngs, key, defaultValue);\n            }\n          }\n        }\n\n        res = this.extendTranslation(res, keys, options, resolved, lastKey);\n        if (usedKey && res === key && this.options.appendNamespaceToMissingKey) res = \"\".concat(namespace, \":\").concat(key);\n\n        if ((usedKey || usedDefault) && this.options.parseMissingKeyHandler) {\n          if (this.options.compatibilityAPI !== 'v1') {\n            res = this.options.parseMissingKeyHandler(key, usedDefault ? res : undefined);\n          } else {\n            res = this.options.parseMissingKeyHandler(res);\n          }\n        }\n      }\n\n      if (returnDetails) {\n        resolved.res = res;\n        return resolved;\n      }\n\n      return res;\n    }\n  }, {\n    key: \"extendTranslation\",\n    value: function extendTranslation(res, key, options, resolved, lastKey) {\n      var _this3 = this;\n\n      if (this.i18nFormat && this.i18nFormat.parse) {\n        res = this.i18nFormat.parse(res, _objectSpread$2(_objectSpread$2({}, this.options.interpolation.defaultVariables), options), resolved.usedLng, resolved.usedNS, resolved.usedKey, {\n          resolved: resolved\n        });\n      } else if (!options.skipInterpolation) {\n        if (options.interpolation) this.interpolator.init(_objectSpread$2(_objectSpread$2({}, options), {\n          interpolation: _objectSpread$2(_objectSpread$2({}, this.options.interpolation), options.interpolation)\n        }));\n        var skipOnVariables = typeof res === 'string' && (options && options.interpolation && options.interpolation.skipOnVariables !== undefined ? options.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables);\n        var nestBef;\n\n        if (skipOnVariables) {\n          var nb = res.match(this.interpolator.nestingRegexp);\n          nestBef = nb && nb.length;\n        }\n\n        var data = options.replace && typeof options.replace !== 'string' ? options.replace : options;\n        if (this.options.interpolation.defaultVariables) data = _objectSpread$2(_objectSpread$2({}, this.options.interpolation.defaultVariables), data);\n        res = this.interpolator.interpolate(res, data, options.lng || this.language, options);\n\n        if (skipOnVariables) {\n          var na = res.match(this.interpolator.nestingRegexp);\n          var nestAft = na && na.length;\n          if (nestBef < nestAft) options.nest = false;\n        }\n\n        if (options.nest !== false) res = this.interpolator.nest(res, function () {\n          for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          if (lastKey && lastKey[0] === args[0] && !options.context) {\n            _this3.logger.warn(\"It seems you are nesting recursively key: \".concat(args[0], \" in key: \").concat(key[0]));\n\n            return null;\n          }\n\n          return _this3.translate.apply(_this3, args.concat([key]));\n        }, options);\n        if (options.interpolation) this.interpolator.reset();\n      }\n\n      var postProcess = options.postProcess || this.options.postProcess;\n      var postProcessorNames = typeof postProcess === 'string' ? [postProcess] : postProcess;\n\n      if (res !== undefined && res !== null && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {\n        res = postProcessor.handle(postProcessorNames, res, key, this.options && this.options.postProcessPassResolved ? _objectSpread$2({\n          i18nResolved: resolved\n        }, options) : options, this);\n      }\n\n      return res;\n    }\n  }, {\n    key: \"resolve\",\n    value: function resolve(keys) {\n      var _this4 = this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var found;\n      var usedKey;\n      var exactUsedKey;\n      var usedLng;\n      var usedNS;\n      if (typeof keys === 'string') keys = [keys];\n      keys.forEach(function (k) {\n        if (_this4.isValidLookup(found)) return;\n\n        var extracted = _this4.extractFromKey(k, options);\n\n        var key = extracted.key;\n        usedKey = key;\n        var namespaces = extracted.namespaces;\n        if (_this4.options.fallbackNS) namespaces = namespaces.concat(_this4.options.fallbackNS);\n        var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n\n        var needsZeroSuffixLookup = needsPluralHandling && !options.ordinal && options.count === 0 && _this4.pluralResolver.shouldUseIntlApi();\n\n        var needsContextHandling = options.context !== undefined && (typeof options.context === 'string' || typeof options.context === 'number') && options.context !== '';\n        var codes = options.lngs ? options.lngs : _this4.languageUtils.toResolveHierarchy(options.lng || _this4.language, options.fallbackLng);\n        namespaces.forEach(function (ns) {\n          if (_this4.isValidLookup(found)) return;\n          usedNS = ns;\n\n          if (!checkedLoadedFor[\"\".concat(codes[0], \"-\").concat(ns)] && _this4.utils && _this4.utils.hasLoadedNamespace && !_this4.utils.hasLoadedNamespace(usedNS)) {\n            checkedLoadedFor[\"\".concat(codes[0], \"-\").concat(ns)] = true;\n\n            _this4.logger.warn(\"key \\\"\".concat(usedKey, \"\\\" for languages \\\"\").concat(codes.join(', '), \"\\\" won't get resolved as namespace \\\"\").concat(usedNS, \"\\\" was not yet loaded\"), 'This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!');\n          }\n\n          codes.forEach(function (code) {\n            if (_this4.isValidLookup(found)) return;\n            usedLng = code;\n            var finalKeys = [key];\n\n            if (_this4.i18nFormat && _this4.i18nFormat.addLookupKeys) {\n              _this4.i18nFormat.addLookupKeys(finalKeys, key, code, ns, options);\n            } else {\n              var pluralSuffix;\n              if (needsPluralHandling) pluralSuffix = _this4.pluralResolver.getSuffix(code, options.count, options);\n              var zeroSuffix = '_zero';\n\n              if (needsPluralHandling) {\n                finalKeys.push(key + pluralSuffix);\n\n                if (needsZeroSuffixLookup) {\n                  finalKeys.push(key + zeroSuffix);\n                }\n              }\n\n              if (needsContextHandling) {\n                var contextKey = \"\".concat(key).concat(_this4.options.contextSeparator).concat(options.context);\n                finalKeys.push(contextKey);\n\n                if (needsPluralHandling) {\n                  finalKeys.push(contextKey + pluralSuffix);\n\n                  if (needsZeroSuffixLookup) {\n                    finalKeys.push(contextKey + zeroSuffix);\n                  }\n                }\n              }\n            }\n\n            var possibleKey;\n\n            while (possibleKey = finalKeys.pop()) {\n              if (!_this4.isValidLookup(found)) {\n                exactUsedKey = possibleKey;\n                found = _this4.getResource(code, ns, possibleKey, options);\n              }\n            }\n          });\n        });\n      });\n      return {\n        res: found,\n        usedKey: usedKey,\n        exactUsedKey: exactUsedKey,\n        usedLng: usedLng,\n        usedNS: usedNS\n      };\n    }\n  }, {\n    key: \"isValidLookup\",\n    value: function isValidLookup(res) {\n      return res !== undefined && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === '');\n    }\n  }, {\n    key: \"getResource\",\n    value: function getResource(code, ns, key) {\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      if (this.i18nFormat && this.i18nFormat.getResource) return this.i18nFormat.getResource(code, ns, key, options);\n      return this.resourceStore.getResource(code, ns, key, options);\n    }\n  }], [{\n    key: \"hasDefaultValue\",\n    value: function hasDefaultValue(options) {\n      var prefix = 'defaultValue';\n\n      for (var option in options) {\n        if (Object.prototype.hasOwnProperty.call(options, option) && prefix === option.substring(0, prefix.length) && undefined !== options[option]) {\n          return true;\n        }\n      }\n\n      return false;\n    }\n  }]);\n\n  return Translator;\n}(EventEmitter);\n\nfunction capitalize(string) {\n  return string.charAt(0).toUpperCase() + string.slice(1);\n}\n\nvar LanguageUtil = function () {\n  function LanguageUtil(options) {\n    _classCallCheck(this, LanguageUtil);\n\n    this.options = options;\n    this.supportedLngs = this.options.supportedLngs || false;\n    this.logger = baseLogger.create('languageUtils');\n  }\n\n  _createClass(LanguageUtil, [{\n    key: \"getScriptPartFromCode\",\n    value: function getScriptPartFromCode(code) {\n      if (!code || code.indexOf('-') < 0) return null;\n      var p = code.split('-');\n      if (p.length === 2) return null;\n      p.pop();\n      if (p[p.length - 1].toLowerCase() === 'x') return null;\n      return this.formatLanguageCode(p.join('-'));\n    }\n  }, {\n    key: \"getLanguagePartFromCode\",\n    value: function getLanguagePartFromCode(code) {\n      if (!code || code.indexOf('-') < 0) return code;\n      var p = code.split('-');\n      return this.formatLanguageCode(p[0]);\n    }\n  }, {\n    key: \"formatLanguageCode\",\n    value: function formatLanguageCode(code) {\n      if (typeof code === 'string' && code.indexOf('-') > -1) {\n        var specialCases = ['hans', 'hant', 'latn', 'cyrl', 'cans', 'mong', 'arab'];\n        var p = code.split('-');\n\n        if (this.options.lowerCaseLng) {\n          p = p.map(function (part) {\n            return part.toLowerCase();\n          });\n        } else if (p.length === 2) {\n          p[0] = p[0].toLowerCase();\n          p[1] = p[1].toUpperCase();\n          if (specialCases.indexOf(p[1].toLowerCase()) > -1) p[1] = capitalize(p[1].toLowerCase());\n        } else if (p.length === 3) {\n          p[0] = p[0].toLowerCase();\n          if (p[1].length === 2) p[1] = p[1].toUpperCase();\n          if (p[0] !== 'sgn' && p[2].length === 2) p[2] = p[2].toUpperCase();\n          if (specialCases.indexOf(p[1].toLowerCase()) > -1) p[1] = capitalize(p[1].toLowerCase());\n          if (specialCases.indexOf(p[2].toLowerCase()) > -1) p[2] = capitalize(p[2].toLowerCase());\n        }\n\n        return p.join('-');\n      }\n\n      return this.options.cleanCode || this.options.lowerCaseLng ? code.toLowerCase() : code;\n    }\n  }, {\n    key: \"isSupportedCode\",\n    value: function isSupportedCode(code) {\n      if (this.options.load === 'languageOnly' || this.options.nonExplicitSupportedLngs) {\n        code = this.getLanguagePartFromCode(code);\n      }\n\n      return !this.supportedLngs || !this.supportedLngs.length || this.supportedLngs.indexOf(code) > -1;\n    }\n  }, {\n    key: \"getBestMatchFromCodes\",\n    value: function getBestMatchFromCodes(codes) {\n      var _this = this;\n\n      if (!codes) return null;\n      var found;\n      codes.forEach(function (code) {\n        if (found) return;\n\n        var cleanedLng = _this.formatLanguageCode(code);\n\n        if (!_this.options.supportedLngs || _this.isSupportedCode(cleanedLng)) found = cleanedLng;\n      });\n\n      if (!found && this.options.supportedLngs) {\n        codes.forEach(function (code) {\n          if (found) return;\n\n          var lngOnly = _this.getLanguagePartFromCode(code);\n\n          if (_this.isSupportedCode(lngOnly)) return found = lngOnly;\n          found = _this.options.supportedLngs.find(function (supportedLng) {\n            if (supportedLng.indexOf(lngOnly) === 0) return supportedLng;\n          });\n        });\n      }\n\n      if (!found) found = this.getFallbackCodes(this.options.fallbackLng)[0];\n      return found;\n    }\n  }, {\n    key: \"getFallbackCodes\",\n    value: function getFallbackCodes(fallbacks, code) {\n      if (!fallbacks) return [];\n      if (typeof fallbacks === 'function') fallbacks = fallbacks(code);\n      if (typeof fallbacks === 'string') fallbacks = [fallbacks];\n      if (Object.prototype.toString.apply(fallbacks) === '[object Array]') return fallbacks;\n      if (!code) return fallbacks[\"default\"] || [];\n      var found = fallbacks[code];\n      if (!found) found = fallbacks[this.getScriptPartFromCode(code)];\n      if (!found) found = fallbacks[this.formatLanguageCode(code)];\n      if (!found) found = fallbacks[this.getLanguagePartFromCode(code)];\n      if (!found) found = fallbacks[\"default\"];\n      return found || [];\n    }\n  }, {\n    key: \"toResolveHierarchy\",\n    value: function toResolveHierarchy(code, fallbackCode) {\n      var _this2 = this;\n\n      var fallbackCodes = this.getFallbackCodes(fallbackCode || this.options.fallbackLng || [], code);\n      var codes = [];\n\n      var addCode = function addCode(c) {\n        if (!c) return;\n\n        if (_this2.isSupportedCode(c)) {\n          codes.push(c);\n        } else {\n          _this2.logger.warn(\"rejecting language code not found in supportedLngs: \".concat(c));\n        }\n      };\n\n      if (typeof code === 'string' && code.indexOf('-') > -1) {\n        if (this.options.load !== 'languageOnly') addCode(this.formatLanguageCode(code));\n        if (this.options.load !== 'languageOnly' && this.options.load !== 'currentOnly') addCode(this.getScriptPartFromCode(code));\n        if (this.options.load !== 'currentOnly') addCode(this.getLanguagePartFromCode(code));\n      } else if (typeof code === 'string') {\n        addCode(this.formatLanguageCode(code));\n      }\n\n      fallbackCodes.forEach(function (fc) {\n        if (codes.indexOf(fc) < 0) addCode(_this2.formatLanguageCode(fc));\n      });\n      return codes;\n    }\n  }]);\n\n  return LanguageUtil;\n}();\n\nvar sets = [{\n  lngs: ['ach', 'ak', 'am', 'arn', 'br', 'fil', 'gun', 'ln', 'mfe', 'mg', 'mi', 'oc', 'pt', 'pt-BR', 'tg', 'tl', 'ti', 'tr', 'uz', 'wa'],\n  nr: [1, 2],\n  fc: 1\n}, {\n  lngs: ['af', 'an', 'ast', 'az', 'bg', 'bn', 'ca', 'da', 'de', 'dev', 'el', 'en', 'eo', 'es', 'et', 'eu', 'fi', 'fo', 'fur', 'fy', 'gl', 'gu', 'ha', 'hi', 'hu', 'hy', 'ia', 'it', 'kk', 'kn', 'ku', 'lb', 'mai', 'ml', 'mn', 'mr', 'nah', 'nap', 'nb', 'ne', 'nl', 'nn', 'no', 'nso', 'pa', 'pap', 'pms', 'ps', 'pt-PT', 'rm', 'sco', 'se', 'si', 'so', 'son', 'sq', 'sv', 'sw', 'ta', 'te', 'tk', 'ur', 'yo'],\n  nr: [1, 2],\n  fc: 2\n}, {\n  lngs: ['ay', 'bo', 'cgg', 'fa', 'ht', 'id', 'ja', 'jbo', 'ka', 'km', 'ko', 'ky', 'lo', 'ms', 'sah', 'su', 'th', 'tt', 'ug', 'vi', 'wo', 'zh'],\n  nr: [1],\n  fc: 3\n}, {\n  lngs: ['be', 'bs', 'cnr', 'dz', 'hr', 'ru', 'sr', 'uk'],\n  nr: [1, 2, 5],\n  fc: 4\n}, {\n  lngs: ['ar'],\n  nr: [0, 1, 2, 3, 11, 100],\n  fc: 5\n}, {\n  lngs: ['cs', 'sk'],\n  nr: [1, 2, 5],\n  fc: 6\n}, {\n  lngs: ['csb', 'pl'],\n  nr: [1, 2, 5],\n  fc: 7\n}, {\n  lngs: ['cy'],\n  nr: [1, 2, 3, 8],\n  fc: 8\n}, {\n  lngs: ['fr'],\n  nr: [1, 2],\n  fc: 9\n}, {\n  lngs: ['ga'],\n  nr: [1, 2, 3, 7, 11],\n  fc: 10\n}, {\n  lngs: ['gd'],\n  nr: [1, 2, 3, 20],\n  fc: 11\n}, {\n  lngs: ['is'],\n  nr: [1, 2],\n  fc: 12\n}, {\n  lngs: ['jv'],\n  nr: [0, 1],\n  fc: 13\n}, {\n  lngs: ['kw'],\n  nr: [1, 2, 3, 4],\n  fc: 14\n}, {\n  lngs: ['lt'],\n  nr: [1, 2, 10],\n  fc: 15\n}, {\n  lngs: ['lv'],\n  nr: [1, 2, 0],\n  fc: 16\n}, {\n  lngs: ['mk'],\n  nr: [1, 2],\n  fc: 17\n}, {\n  lngs: ['mnk'],\n  nr: [0, 1, 2],\n  fc: 18\n}, {\n  lngs: ['mt'],\n  nr: [1, 2, 11, 20],\n  fc: 19\n}, {\n  lngs: ['or'],\n  nr: [2, 1],\n  fc: 2\n}, {\n  lngs: ['ro'],\n  nr: [1, 2, 20],\n  fc: 20\n}, {\n  lngs: ['sl'],\n  nr: [5, 1, 2, 3],\n  fc: 21\n}, {\n  lngs: ['he', 'iw'],\n  nr: [1, 2, 20, 21],\n  fc: 22\n}];\nvar _rulesPluralsTypes = {\n  1: function _(n) {\n    return Number(n > 1);\n  },\n  2: function _(n) {\n    return Number(n != 1);\n  },\n  3: function _(n) {\n    return 0;\n  },\n  4: function _(n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  5: function _(n) {\n    return Number(n == 0 ? 0 : n == 1 ? 1 : n == 2 ? 2 : n % 100 >= 3 && n % 100 <= 10 ? 3 : n % 100 >= 11 ? 4 : 5);\n  },\n  6: function _(n) {\n    return Number(n == 1 ? 0 : n >= 2 && n <= 4 ? 1 : 2);\n  },\n  7: function _(n) {\n    return Number(n == 1 ? 0 : n % 10 >= 2 && n % 10 <= 4 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  8: function _(n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n != 8 && n != 11 ? 2 : 3);\n  },\n  9: function _(n) {\n    return Number(n >= 2);\n  },\n  10: function _(n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n < 7 ? 2 : n < 11 ? 3 : 4);\n  },\n  11: function _(n) {\n    return Number(n == 1 || n == 11 ? 0 : n == 2 || n == 12 ? 1 : n > 2 && n < 20 ? 2 : 3);\n  },\n  12: function _(n) {\n    return Number(n % 10 != 1 || n % 100 == 11);\n  },\n  13: function _(n) {\n    return Number(n !== 0);\n  },\n  14: function _(n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : n == 3 ? 2 : 3);\n  },\n  15: function _(n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n % 10 >= 2 && (n % 100 < 10 || n % 100 >= 20) ? 1 : 2);\n  },\n  16: function _(n) {\n    return Number(n % 10 == 1 && n % 100 != 11 ? 0 : n !== 0 ? 1 : 2);\n  },\n  17: function _(n) {\n    return Number(n == 1 || n % 10 == 1 && n % 100 != 11 ? 0 : 1);\n  },\n  18: function _(n) {\n    return Number(n == 0 ? 0 : n == 1 ? 1 : 2);\n  },\n  19: function _(n) {\n    return Number(n == 1 ? 0 : n == 0 || n % 100 > 1 && n % 100 < 11 ? 1 : n % 100 > 10 && n % 100 < 20 ? 2 : 3);\n  },\n  20: function _(n) {\n    return Number(n == 1 ? 0 : n == 0 || n % 100 > 0 && n % 100 < 20 ? 1 : 2);\n  },\n  21: function _(n) {\n    return Number(n % 100 == 1 ? 1 : n % 100 == 2 ? 2 : n % 100 == 3 || n % 100 == 4 ? 3 : 0);\n  },\n  22: function _(n) {\n    return Number(n == 1 ? 0 : n == 2 ? 1 : (n < 0 || n > 10) && n % 10 == 0 ? 2 : 3);\n  }\n};\nvar deprecatedJsonVersions = ['v1', 'v2', 'v3'];\nvar suffixesOrder = {\n  zero: 0,\n  one: 1,\n  two: 2,\n  few: 3,\n  many: 4,\n  other: 5\n};\n\nfunction createRules() {\n  var rules = {};\n  sets.forEach(function (set) {\n    set.lngs.forEach(function (l) {\n      rules[l] = {\n        numbers: set.nr,\n        plurals: _rulesPluralsTypes[set.fc]\n      };\n    });\n  });\n  return rules;\n}\n\nvar PluralResolver = function () {\n  function PluralResolver(languageUtils) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, PluralResolver);\n\n    this.languageUtils = languageUtils;\n    this.options = options;\n    this.logger = baseLogger.create('pluralResolver');\n\n    if ((!this.options.compatibilityJSON || this.options.compatibilityJSON === 'v4') && (typeof Intl === 'undefined' || !Intl.PluralRules)) {\n      this.options.compatibilityJSON = 'v3';\n      this.logger.error('Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.');\n    }\n\n    this.rules = createRules();\n  }\n\n  _createClass(PluralResolver, [{\n    key: \"addRule\",\n    value: function addRule(lng, obj) {\n      this.rules[lng] = obj;\n    }\n  }, {\n    key: \"getRule\",\n    value: function getRule(code) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (this.shouldUseIntlApi()) {\n        try {\n          return new Intl.PluralRules(code, {\n            type: options.ordinal ? 'ordinal' : 'cardinal'\n          });\n        } catch (_unused) {\n          return;\n        }\n      }\n\n      return this.rules[code] || this.rules[this.languageUtils.getLanguagePartFromCode(code)];\n    }\n  }, {\n    key: \"needsPlural\",\n    value: function needsPlural(code) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var rule = this.getRule(code, options);\n\n      if (this.shouldUseIntlApi()) {\n        return rule && rule.resolvedOptions().pluralCategories.length > 1;\n      }\n\n      return rule && rule.numbers.length > 1;\n    }\n  }, {\n    key: \"getPluralFormsOfKey\",\n    value: function getPluralFormsOfKey(code, key) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this.getSuffixes(code, options).map(function (suffix) {\n        return \"\".concat(key).concat(suffix);\n      });\n    }\n  }, {\n    key: \"getSuffixes\",\n    value: function getSuffixes(code) {\n      var _this = this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var rule = this.getRule(code, options);\n\n      if (!rule) {\n        return [];\n      }\n\n      if (this.shouldUseIntlApi()) {\n        return rule.resolvedOptions().pluralCategories.sort(function (pluralCategory1, pluralCategory2) {\n          return suffixesOrder[pluralCategory1] - suffixesOrder[pluralCategory2];\n        }).map(function (pluralCategory) {\n          return \"\".concat(_this.options.prepend).concat(pluralCategory);\n        });\n      }\n\n      return rule.numbers.map(function (number) {\n        return _this.getSuffix(code, number, options);\n      });\n    }\n  }, {\n    key: \"getSuffix\",\n    value: function getSuffix(code, count) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var rule = this.getRule(code, options);\n\n      if (rule) {\n        if (this.shouldUseIntlApi()) {\n          return \"\".concat(this.options.prepend).concat(rule.select(count));\n        }\n\n        return this.getSuffixRetroCompatible(rule, count);\n      }\n\n      this.logger.warn(\"no plural rule found for: \".concat(code));\n      return '';\n    }\n  }, {\n    key: \"getSuffixRetroCompatible\",\n    value: function getSuffixRetroCompatible(rule, count) {\n      var _this2 = this;\n\n      var idx = rule.noAbs ? rule.plurals(count) : rule.plurals(Math.abs(count));\n      var suffix = rule.numbers[idx];\n\n      if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {\n        if (suffix === 2) {\n          suffix = 'plural';\n        } else if (suffix === 1) {\n          suffix = '';\n        }\n      }\n\n      var returnSuffix = function returnSuffix() {\n        return _this2.options.prepend && suffix.toString() ? _this2.options.prepend + suffix.toString() : suffix.toString();\n      };\n\n      if (this.options.compatibilityJSON === 'v1') {\n        if (suffix === 1) return '';\n        if (typeof suffix === 'number') return \"_plural_\".concat(suffix.toString());\n        return returnSuffix();\n      } else if (this.options.compatibilityJSON === 'v2') {\n        return returnSuffix();\n      } else if (this.options.simplifyPluralSuffix && rule.numbers.length === 2 && rule.numbers[0] === 1) {\n        return returnSuffix();\n      }\n\n      return this.options.prepend && idx.toString() ? this.options.prepend + idx.toString() : idx.toString();\n    }\n  }, {\n    key: \"shouldUseIntlApi\",\n    value: function shouldUseIntlApi() {\n      return !deprecatedJsonVersions.includes(this.options.compatibilityJSON);\n    }\n  }]);\n\n  return PluralResolver;\n}();\n\nfunction ownKeys$3(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$3(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$3(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$3(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nvar Interpolator = function () {\n  function Interpolator() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Interpolator);\n\n    this.logger = baseLogger.create('interpolator');\n    this.options = options;\n\n    this.format = options.interpolation && options.interpolation.format || function (value) {\n      return value;\n    };\n\n    this.init(options);\n  }\n\n  _createClass(Interpolator, [{\n    key: \"init\",\n    value: function init() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      if (!options.interpolation) options.interpolation = {\n        escapeValue: true\n      };\n      var iOpts = options.interpolation;\n      this.escape = iOpts.escape !== undefined ? iOpts.escape : escape;\n      this.escapeValue = iOpts.escapeValue !== undefined ? iOpts.escapeValue : true;\n      this.useRawValueToEscape = iOpts.useRawValueToEscape !== undefined ? iOpts.useRawValueToEscape : false;\n      this.prefix = iOpts.prefix ? regexEscape(iOpts.prefix) : iOpts.prefixEscaped || '{{';\n      this.suffix = iOpts.suffix ? regexEscape(iOpts.suffix) : iOpts.suffixEscaped || '}}';\n      this.formatSeparator = iOpts.formatSeparator ? iOpts.formatSeparator : iOpts.formatSeparator || ',';\n      this.unescapePrefix = iOpts.unescapeSuffix ? '' : iOpts.unescapePrefix || '-';\n      this.unescapeSuffix = this.unescapePrefix ? '' : iOpts.unescapeSuffix || '';\n      this.nestingPrefix = iOpts.nestingPrefix ? regexEscape(iOpts.nestingPrefix) : iOpts.nestingPrefixEscaped || regexEscape('$t(');\n      this.nestingSuffix = iOpts.nestingSuffix ? regexEscape(iOpts.nestingSuffix) : iOpts.nestingSuffixEscaped || regexEscape(')');\n      this.nestingOptionsSeparator = iOpts.nestingOptionsSeparator ? iOpts.nestingOptionsSeparator : iOpts.nestingOptionsSeparator || ',';\n      this.maxReplaces = iOpts.maxReplaces ? iOpts.maxReplaces : 1000;\n      this.alwaysFormat = iOpts.alwaysFormat !== undefined ? iOpts.alwaysFormat : false;\n      this.resetRegExp();\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      if (this.options) this.init(this.options);\n    }\n  }, {\n    key: \"resetRegExp\",\n    value: function resetRegExp() {\n      var regexpStr = \"\".concat(this.prefix, \"(.+?)\").concat(this.suffix);\n      this.regexp = new RegExp(regexpStr, 'g');\n      var regexpUnescapeStr = \"\".concat(this.prefix).concat(this.unescapePrefix, \"(.+?)\").concat(this.unescapeSuffix).concat(this.suffix);\n      this.regexpUnescape = new RegExp(regexpUnescapeStr, 'g');\n      var nestingRegexpStr = \"\".concat(this.nestingPrefix, \"(.+?)\").concat(this.nestingSuffix);\n      this.nestingRegexp = new RegExp(nestingRegexpStr, 'g');\n    }\n  }, {\n    key: \"interpolate\",\n    value: function interpolate(str, data, lng, options) {\n      var _this = this;\n\n      var match;\n      var value;\n      var replaces;\n      var defaultData = this.options && this.options.interpolation && this.options.interpolation.defaultVariables || {};\n\n      function regexSafe(val) {\n        return val.replace(/\\$/g, '$$$$');\n      }\n\n      var handleFormat = function handleFormat(key) {\n        if (key.indexOf(_this.formatSeparator) < 0) {\n          var path = getPathWithDefaults(data, defaultData, key);\n          return _this.alwaysFormat ? _this.format(path, undefined, lng, _objectSpread$3(_objectSpread$3(_objectSpread$3({}, options), data), {}, {\n            interpolationkey: key\n          })) : path;\n        }\n\n        var p = key.split(_this.formatSeparator);\n        var k = p.shift().trim();\n        var f = p.join(_this.formatSeparator).trim();\n        return _this.format(getPathWithDefaults(data, defaultData, k), f, lng, _objectSpread$3(_objectSpread$3(_objectSpread$3({}, options), data), {}, {\n          interpolationkey: k\n        }));\n      };\n\n      this.resetRegExp();\n      var missingInterpolationHandler = options && options.missingInterpolationHandler || this.options.missingInterpolationHandler;\n      var skipOnVariables = options && options.interpolation && options.interpolation.skipOnVariables !== undefined ? options.interpolation.skipOnVariables : this.options.interpolation.skipOnVariables;\n      var todos = [{\n        regex: this.regexpUnescape,\n        safeValue: function safeValue(val) {\n          return regexSafe(val);\n        }\n      }, {\n        regex: this.regexp,\n        safeValue: function safeValue(val) {\n          return _this.escapeValue ? regexSafe(_this.escape(val)) : regexSafe(val);\n        }\n      }];\n      todos.forEach(function (todo) {\n        replaces = 0;\n\n        while (match = todo.regex.exec(str)) {\n          var matchedVar = match[1].trim();\n          value = handleFormat(matchedVar);\n\n          if (value === undefined) {\n            if (typeof missingInterpolationHandler === 'function') {\n              var temp = missingInterpolationHandler(str, match, options);\n              value = typeof temp === 'string' ? temp : '';\n            } else if (options && options.hasOwnProperty(matchedVar)) {\n              value = '';\n            } else if (skipOnVariables) {\n              value = match[0];\n              continue;\n            } else {\n              _this.logger.warn(\"missed to pass in variable \".concat(matchedVar, \" for interpolating \").concat(str));\n\n              value = '';\n            }\n          } else if (typeof value !== 'string' && !_this.useRawValueToEscape) {\n            value = makeString(value);\n          }\n\n          var safeValue = todo.safeValue(value);\n          str = str.replace(match[0], safeValue);\n\n          if (skipOnVariables) {\n            todo.regex.lastIndex += safeValue.length;\n            todo.regex.lastIndex -= match[0].length;\n          } else {\n            todo.regex.lastIndex = 0;\n          }\n\n          replaces++;\n\n          if (replaces >= _this.maxReplaces) {\n            break;\n          }\n        }\n      });\n      return str;\n    }\n  }, {\n    key: \"nest\",\n    value: function nest(str, fc) {\n      var _this2 = this;\n\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var match;\n      var value;\n\n      var clonedOptions = _objectSpread$3({}, options);\n\n      clonedOptions.applyPostProcessor = false;\n      delete clonedOptions.defaultValue;\n\n      function handleHasOptions(key, inheritedOptions) {\n        var sep = this.nestingOptionsSeparator;\n        if (key.indexOf(sep) < 0) return key;\n        var c = key.split(new RegExp(\"\".concat(sep, \"[ ]*{\")));\n        var optionsString = \"{\".concat(c[1]);\n        key = c[0];\n        optionsString = this.interpolate(optionsString, clonedOptions);\n        optionsString = optionsString.replace(/'/g, '\"');\n\n        try {\n          clonedOptions = JSON.parse(optionsString);\n          if (inheritedOptions) clonedOptions = _objectSpread$3(_objectSpread$3({}, inheritedOptions), clonedOptions);\n        } catch (e) {\n          this.logger.warn(\"failed parsing options string in nesting for key \".concat(key), e);\n          return \"\".concat(key).concat(sep).concat(optionsString);\n        }\n\n        delete clonedOptions.defaultValue;\n        return key;\n      }\n\n      while (match = this.nestingRegexp.exec(str)) {\n        var formatters = [];\n        var doReduce = false;\n\n        if (match[0].indexOf(this.formatSeparator) !== -1 && !/{.*}/.test(match[1])) {\n          var r = match[1].split(this.formatSeparator).map(function (elem) {\n            return elem.trim();\n          });\n          match[1] = r.shift();\n          formatters = r;\n          doReduce = true;\n        }\n\n        value = fc(handleHasOptions.call(this, match[1].trim(), clonedOptions), clonedOptions);\n        if (value && match[0] === str && typeof value !== 'string') return value;\n        if (typeof value !== 'string') value = makeString(value);\n\n        if (!value) {\n          this.logger.warn(\"missed to resolve \".concat(match[1], \" for nesting \").concat(str));\n          value = '';\n        }\n\n        if (doReduce) {\n          value = formatters.reduce(function (v, f) {\n            return _this2.format(v, f, options.lng, _objectSpread$3(_objectSpread$3({}, options), {}, {\n              interpolationkey: match[1].trim()\n            }));\n          }, value.trim());\n        }\n\n        str = str.replace(match[0], value);\n        this.regexp.lastIndex = 0;\n      }\n\n      return str;\n    }\n  }]);\n\n  return Interpolator;\n}();\n\nfunction ownKeys$4(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$4(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$4(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$4(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction parseFormatStr(formatStr) {\n  var formatName = formatStr.toLowerCase().trim();\n  var formatOptions = {};\n\n  if (formatStr.indexOf('(') > -1) {\n    var p = formatStr.split('(');\n    formatName = p[0].toLowerCase().trim();\n    var optStr = p[1].substring(0, p[1].length - 1);\n\n    if (formatName === 'currency' && optStr.indexOf(':') < 0) {\n      if (!formatOptions.currency) formatOptions.currency = optStr.trim();\n    } else if (formatName === 'relativetime' && optStr.indexOf(':') < 0) {\n      if (!formatOptions.range) formatOptions.range = optStr.trim();\n    } else {\n      var opts = optStr.split(';');\n      opts.forEach(function (opt) {\n        if (!opt) return;\n\n        var _opt$split = opt.split(':'),\n            _opt$split2 = _toArray(_opt$split),\n            key = _opt$split2[0],\n            rest = _opt$split2.slice(1);\n\n        var val = rest.join(':');\n        if (!formatOptions[key.trim()]) formatOptions[key.trim()] = val.trim();\n        if (val.trim() === 'false') formatOptions[key.trim()] = false;\n        if (val.trim() === 'true') formatOptions[key.trim()] = true;\n        if (!isNaN(val.trim())) formatOptions[key.trim()] = parseInt(val.trim(), 10);\n      });\n    }\n  }\n\n  return {\n    formatName: formatName,\n    formatOptions: formatOptions\n  };\n}\n\nvar Formatter = function () {\n  function Formatter() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, Formatter);\n\n    this.logger = baseLogger.create('formatter');\n    this.options = options;\n    this.formats = {\n      number: function number(val, lng, options) {\n        return new Intl.NumberFormat(lng, options).format(val);\n      },\n      currency: function currency(val, lng, options) {\n        return new Intl.NumberFormat(lng, _objectSpread$4(_objectSpread$4({}, options), {}, {\n          style: 'currency'\n        })).format(val);\n      },\n      datetime: function datetime(val, lng, options) {\n        return new Intl.DateTimeFormat(lng, _objectSpread$4({}, options)).format(val);\n      },\n      relativetime: function relativetime(val, lng, options) {\n        return new Intl.RelativeTimeFormat(lng, _objectSpread$4({}, options)).format(val, options.range || 'day');\n      },\n      list: function list(val, lng, options) {\n        return new Intl.ListFormat(lng, _objectSpread$4({}, options)).format(val);\n      }\n    };\n    this.init(options);\n  }\n\n  _createClass(Formatter, [{\n    key: \"init\",\n    value: function init(services) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        interpolation: {}\n      };\n      var iOpts = options.interpolation;\n      this.formatSeparator = iOpts.formatSeparator ? iOpts.formatSeparator : iOpts.formatSeparator || ',';\n    }\n  }, {\n    key: \"add\",\n    value: function add(name, fc) {\n      this.formats[name.toLowerCase().trim()] = fc;\n    }\n  }, {\n    key: \"format\",\n    value: function format(value, _format, lng, options) {\n      var _this = this;\n\n      var formats = _format.split(this.formatSeparator);\n\n      var result = formats.reduce(function (mem, f) {\n        var _parseFormatStr = parseFormatStr(f),\n            formatName = _parseFormatStr.formatName,\n            formatOptions = _parseFormatStr.formatOptions;\n\n        if (_this.formats[formatName]) {\n          var formatted = mem;\n\n          try {\n            var valOptions = options && options.formatParams && options.formatParams[options.interpolationkey] || {};\n            var l = valOptions.locale || valOptions.lng || options.locale || options.lng || lng;\n            formatted = _this.formats[formatName](mem, l, _objectSpread$4(_objectSpread$4(_objectSpread$4({}, formatOptions), options), valOptions));\n          } catch (error) {\n            _this.logger.warn(error);\n          }\n\n          return formatted;\n        } else {\n          _this.logger.warn(\"there was no format function for \".concat(formatName));\n        }\n\n        return mem;\n      }, value);\n      return result;\n    }\n  }]);\n\n  return Formatter;\n}();\n\nfunction ownKeys$5(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$5(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$5(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$5(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper$2(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct$2(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct$2() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction removePending(q, name) {\n  delete q.pending[name];\n  q.pendingCount--;\n}\n\nvar Connector = function (_EventEmitter) {\n  _inherits(Connector, _EventEmitter);\n\n  var _super = _createSuper$2(Connector);\n\n  function Connector(backend, store, services) {\n    var _this;\n\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    _classCallCheck(this, Connector);\n\n    _this = _super.call(this);\n\n    if (isIE10) {\n      EventEmitter.call(_assertThisInitialized(_this));\n    }\n\n    _this.backend = backend;\n    _this.store = store;\n    _this.services = services;\n    _this.languageUtils = services.languageUtils;\n    _this.options = options;\n    _this.logger = baseLogger.create('backendConnector');\n    _this.waitingReads = [];\n    _this.maxParallelReads = options.maxParallelReads || 10;\n    _this.readingCalls = 0;\n    _this.state = {};\n    _this.queue = [];\n\n    if (_this.backend && _this.backend.init) {\n      _this.backend.init(services, options.backend, options);\n    }\n\n    return _this;\n  }\n\n  _createClass(Connector, [{\n    key: \"queueLoad\",\n    value: function queueLoad(languages, namespaces, options, callback) {\n      var _this2 = this;\n\n      var toLoad = {};\n      var pending = {};\n      var toLoadLanguages = {};\n      var toLoadNamespaces = {};\n      languages.forEach(function (lng) {\n        var hasAllNamespaces = true;\n        namespaces.forEach(function (ns) {\n          var name = \"\".concat(lng, \"|\").concat(ns);\n\n          if (!options.reload && _this2.store.hasResourceBundle(lng, ns)) {\n            _this2.state[name] = 2;\n          } else if (_this2.state[name] < 0) ; else if (_this2.state[name] === 1) {\n            if (pending[name] === undefined) pending[name] = true;\n          } else {\n            _this2.state[name] = 1;\n            hasAllNamespaces = false;\n            if (pending[name] === undefined) pending[name] = true;\n            if (toLoad[name] === undefined) toLoad[name] = true;\n            if (toLoadNamespaces[ns] === undefined) toLoadNamespaces[ns] = true;\n          }\n        });\n        if (!hasAllNamespaces) toLoadLanguages[lng] = true;\n      });\n\n      if (Object.keys(toLoad).length || Object.keys(pending).length) {\n        this.queue.push({\n          pending: pending,\n          pendingCount: Object.keys(pending).length,\n          loaded: {},\n          errors: [],\n          callback: callback\n        });\n      }\n\n      return {\n        toLoad: Object.keys(toLoad),\n        pending: Object.keys(pending),\n        toLoadLanguages: Object.keys(toLoadLanguages),\n        toLoadNamespaces: Object.keys(toLoadNamespaces)\n      };\n    }\n  }, {\n    key: \"loaded\",\n    value: function loaded(name, err, data) {\n      var s = name.split('|');\n      var lng = s[0];\n      var ns = s[1];\n      if (err) this.emit('failedLoading', lng, ns, err);\n\n      if (data) {\n        this.store.addResourceBundle(lng, ns, data);\n      }\n\n      this.state[name] = err ? -1 : 2;\n      var loaded = {};\n      this.queue.forEach(function (q) {\n        pushPath(q.loaded, [lng], ns);\n        removePending(q, name);\n        if (err) q.errors.push(err);\n\n        if (q.pendingCount === 0 && !q.done) {\n          Object.keys(q.loaded).forEach(function (l) {\n            if (!loaded[l]) loaded[l] = {};\n            var loadedKeys = Object.keys(loaded[l]);\n\n            if (loadedKeys.length) {\n              loadedKeys.forEach(function (ns) {\n                if (loadedKeys[ns] !== undefined) loaded[l][ns] = true;\n              });\n            }\n          });\n          q.done = true;\n\n          if (q.errors.length) {\n            q.callback(q.errors);\n          } else {\n            q.callback();\n          }\n        }\n      });\n      this.emit('loaded', loaded);\n      this.queue = this.queue.filter(function (q) {\n        return !q.done;\n      });\n    }\n  }, {\n    key: \"read\",\n    value: function read(lng, ns, fcName) {\n      var _this3 = this;\n\n      var tried = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n      var wait = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 350;\n      var callback = arguments.length > 5 ? arguments[5] : undefined;\n      if (!lng.length) return callback(null, {});\n\n      if (this.readingCalls >= this.maxParallelReads) {\n        this.waitingReads.push({\n          lng: lng,\n          ns: ns,\n          fcName: fcName,\n          tried: tried,\n          wait: wait,\n          callback: callback\n        });\n        return;\n      }\n\n      this.readingCalls++;\n      return this.backend[fcName](lng, ns, function (err, data) {\n        if (err && data && tried < 5) {\n          setTimeout(function () {\n            _this3.read.call(_this3, lng, ns, fcName, tried + 1, wait * 2, callback);\n          }, wait);\n          return;\n        }\n\n        _this3.readingCalls--;\n\n        if (_this3.waitingReads.length > 0) {\n          var next = _this3.waitingReads.shift();\n\n          _this3.read(next.lng, next.ns, next.fcName, next.tried, next.wait, next.callback);\n        }\n\n        callback(err, data);\n      });\n    }\n  }, {\n    key: \"prepareLoading\",\n    value: function prepareLoading(languages, namespaces) {\n      var _this4 = this;\n\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var callback = arguments.length > 3 ? arguments[3] : undefined;\n\n      if (!this.backend) {\n        this.logger.warn('No backend was added via i18next.use. Will not load resources.');\n        return callback && callback();\n      }\n\n      if (typeof languages === 'string') languages = this.languageUtils.toResolveHierarchy(languages);\n      if (typeof namespaces === 'string') namespaces = [namespaces];\n      var toLoad = this.queueLoad(languages, namespaces, options, callback);\n\n      if (!toLoad.toLoad.length) {\n        if (!toLoad.pending.length) callback();\n        return null;\n      }\n\n      toLoad.toLoad.forEach(function (name) {\n        _this4.loadOne(name);\n      });\n    }\n  }, {\n    key: \"load\",\n    value: function load(languages, namespaces, callback) {\n      this.prepareLoading(languages, namespaces, {}, callback);\n    }\n  }, {\n    key: \"reload\",\n    value: function reload(languages, namespaces, callback) {\n      this.prepareLoading(languages, namespaces, {\n        reload: true\n      }, callback);\n    }\n  }, {\n    key: \"loadOne\",\n    value: function loadOne(name) {\n      var _this5 = this;\n\n      var prefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : '';\n      var s = name.split('|');\n      var lng = s[0];\n      var ns = s[1];\n      this.read(lng, ns, 'read', undefined, undefined, function (err, data) {\n        if (err) _this5.logger.warn(\"\".concat(prefix, \"loading namespace \").concat(ns, \" for language \").concat(lng, \" failed\"), err);\n        if (!err && data) _this5.logger.log(\"\".concat(prefix, \"loaded namespace \").concat(ns, \" for language \").concat(lng), data);\n\n        _this5.loaded(name, err, data);\n      });\n    }\n  }, {\n    key: \"saveMissing\",\n    value: function saveMissing(languages, namespace, key, fallbackValue, isUpdate) {\n      var options = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n\n      if (this.services.utils && this.services.utils.hasLoadedNamespace && !this.services.utils.hasLoadedNamespace(namespace)) {\n        this.logger.warn(\"did not save key \\\"\".concat(key, \"\\\" as the namespace \\\"\").concat(namespace, \"\\\" was not yet loaded\"), 'This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!');\n        return;\n      }\n\n      if (key === undefined || key === null || key === '') return;\n\n      if (this.backend && this.backend.create) {\n        this.backend.create(languages, namespace, key, fallbackValue, null, _objectSpread$5(_objectSpread$5({}, options), {}, {\n          isUpdate: isUpdate\n        }));\n      }\n\n      if (!languages || !languages[0]) return;\n      this.store.addResource(languages[0], namespace, key, fallbackValue);\n    }\n  }]);\n\n  return Connector;\n}(EventEmitter);\n\nfunction get() {\n  return {\n    debug: false,\n    initImmediate: true,\n    ns: ['translation'],\n    defaultNS: ['translation'],\n    fallbackLng: ['dev'],\n    fallbackNS: false,\n    supportedLngs: false,\n    nonExplicitSupportedLngs: false,\n    load: 'all',\n    preload: false,\n    simplifyPluralSuffix: true,\n    keySeparator: '.',\n    nsSeparator: ':',\n    pluralSeparator: '_',\n    contextSeparator: '_',\n    partialBundledLanguages: false,\n    saveMissing: false,\n    updateMissing: false,\n    saveMissingTo: 'fallback',\n    saveMissingPlurals: true,\n    missingKeyHandler: false,\n    missingInterpolationHandler: false,\n    postProcess: false,\n    postProcessPassResolved: false,\n    returnNull: true,\n    returnEmptyString: true,\n    returnObjects: false,\n    joinArrays: false,\n    returnedObjectHandler: false,\n    parseMissingKeyHandler: false,\n    appendNamespaceToMissingKey: false,\n    appendNamespaceToCIMode: false,\n    overloadTranslationOptionHandler: function handle(args) {\n      var ret = {};\n      if (_typeof(args[1]) === 'object') ret = args[1];\n      if (typeof args[1] === 'string') ret.defaultValue = args[1];\n      if (typeof args[2] === 'string') ret.tDescription = args[2];\n\n      if (_typeof(args[2]) === 'object' || _typeof(args[3]) === 'object') {\n        var options = args[3] || args[2];\n        Object.keys(options).forEach(function (key) {\n          ret[key] = options[key];\n        });\n      }\n\n      return ret;\n    },\n    interpolation: {\n      escapeValue: true,\n      format: function format(value, _format, lng, options) {\n        return value;\n      },\n      prefix: '{{',\n      suffix: '}}',\n      formatSeparator: ',',\n      unescapePrefix: '-',\n      nestingPrefix: '$t(',\n      nestingSuffix: ')',\n      nestingOptionsSeparator: ',',\n      maxReplaces: 1000,\n      skipOnVariables: true\n    }\n  };\n}\nfunction transformOptions(options) {\n  if (typeof options.ns === 'string') options.ns = [options.ns];\n  if (typeof options.fallbackLng === 'string') options.fallbackLng = [options.fallbackLng];\n  if (typeof options.fallbackNS === 'string') options.fallbackNS = [options.fallbackNS];\n\n  if (options.supportedLngs && options.supportedLngs.indexOf('cimode') < 0) {\n    options.supportedLngs = options.supportedLngs.concat(['cimode']);\n  }\n\n  return options;\n}\n\nfunction ownKeys$6(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread$6(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys$6(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys$6(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper$3(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct$3(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct$3() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction noop() {}\n\nfunction bindMemberFunctions(inst) {\n  var mems = Object.getOwnPropertyNames(Object.getPrototypeOf(inst));\n  mems.forEach(function (mem) {\n    if (typeof inst[mem] === 'function') {\n      inst[mem] = inst[mem].bind(inst);\n    }\n  });\n}\n\nvar I18n = function (_EventEmitter) {\n  _inherits(I18n, _EventEmitter);\n\n  var _super = _createSuper$3(I18n);\n\n  function I18n() {\n    var _this;\n\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var callback = arguments.length > 1 ? arguments[1] : undefined;\n\n    _classCallCheck(this, I18n);\n\n    _this = _super.call(this);\n\n    if (isIE10) {\n      EventEmitter.call(_assertThisInitialized(_this));\n    }\n\n    _this.options = transformOptions(options);\n    _this.services = {};\n    _this.logger = baseLogger;\n    _this.modules = {\n      external: []\n    };\n    bindMemberFunctions(_assertThisInitialized(_this));\n\n    if (callback && !_this.isInitialized && !options.isClone) {\n      if (!_this.options.initImmediate) {\n        _this.init(options, callback);\n\n        return _possibleConstructorReturn(_this, _assertThisInitialized(_this));\n      }\n\n      setTimeout(function () {\n        _this.init(options, callback);\n      }, 0);\n    }\n\n    return _this;\n  }\n\n  _createClass(I18n, [{\n    key: \"init\",\n    value: function init() {\n      var _this2 = this;\n\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 ? arguments[1] : undefined;\n\n      if (typeof options === 'function') {\n        callback = options;\n        options = {};\n      }\n\n      if (!options.defaultNS && options.ns) {\n        if (typeof options.ns === 'string') {\n          options.defaultNS = options.ns;\n        } else if (options.ns.indexOf('translation') < 0) {\n          options.defaultNS = options.ns[0];\n        }\n      }\n\n      var defOpts = get();\n      this.options = _objectSpread$6(_objectSpread$6(_objectSpread$6({}, defOpts), this.options), transformOptions(options));\n\n      if (this.options.compatibilityAPI !== 'v1') {\n        this.options.interpolation = _objectSpread$6(_objectSpread$6({}, defOpts.interpolation), this.options.interpolation);\n      }\n\n      if (options.keySeparator !== undefined) {\n        this.options.userDefinedKeySeparator = options.keySeparator;\n      }\n\n      if (options.nsSeparator !== undefined) {\n        this.options.userDefinedNsSeparator = options.nsSeparator;\n      }\n\n      function createClassOnDemand(ClassOrObject) {\n        if (!ClassOrObject) return null;\n        if (typeof ClassOrObject === 'function') return new ClassOrObject();\n        return ClassOrObject;\n      }\n\n      if (!this.options.isClone) {\n        if (this.modules.logger) {\n          baseLogger.init(createClassOnDemand(this.modules.logger), this.options);\n        } else {\n          baseLogger.init(null, this.options);\n        }\n\n        var formatter;\n\n        if (this.modules.formatter) {\n          formatter = this.modules.formatter;\n        } else if (typeof Intl !== 'undefined') {\n          formatter = Formatter;\n        }\n\n        var lu = new LanguageUtil(this.options);\n        this.store = new ResourceStore(this.options.resources, this.options);\n        var s = this.services;\n        s.logger = baseLogger;\n        s.resourceStore = this.store;\n        s.languageUtils = lu;\n        s.pluralResolver = new PluralResolver(lu, {\n          prepend: this.options.pluralSeparator,\n          compatibilityJSON: this.options.compatibilityJSON,\n          simplifyPluralSuffix: this.options.simplifyPluralSuffix\n        });\n\n        if (formatter && (!this.options.interpolation.format || this.options.interpolation.format === defOpts.interpolation.format)) {\n          s.formatter = createClassOnDemand(formatter);\n          s.formatter.init(s, this.options);\n          this.options.interpolation.format = s.formatter.format.bind(s.formatter);\n        }\n\n        s.interpolator = new Interpolator(this.options);\n        s.utils = {\n          hasLoadedNamespace: this.hasLoadedNamespace.bind(this)\n        };\n        s.backendConnector = new Connector(createClassOnDemand(this.modules.backend), s.resourceStore, s, this.options);\n        s.backendConnector.on('*', function (event) {\n          for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n            args[_key - 1] = arguments[_key];\n          }\n\n          _this2.emit.apply(_this2, [event].concat(args));\n        });\n\n        if (this.modules.languageDetector) {\n          s.languageDetector = createClassOnDemand(this.modules.languageDetector);\n          s.languageDetector.init(s, this.options.detection, this.options);\n        }\n\n        if (this.modules.i18nFormat) {\n          s.i18nFormat = createClassOnDemand(this.modules.i18nFormat);\n          if (s.i18nFormat.init) s.i18nFormat.init(this);\n        }\n\n        this.translator = new Translator(this.services, this.options);\n        this.translator.on('*', function (event) {\n          for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n            args[_key2 - 1] = arguments[_key2];\n          }\n\n          _this2.emit.apply(_this2, [event].concat(args));\n        });\n        this.modules.external.forEach(function (m) {\n          if (m.init) m.init(_this2);\n        });\n      }\n\n      this.format = this.options.interpolation.format;\n      if (!callback) callback = noop;\n\n      if (this.options.fallbackLng && !this.services.languageDetector && !this.options.lng) {\n        var codes = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);\n        if (codes.length > 0 && codes[0] !== 'dev') this.options.lng = codes[0];\n      }\n\n      if (!this.services.languageDetector && !this.options.lng) {\n        this.logger.warn('init: no languageDetector is used and no lng is defined');\n      }\n\n      var storeApi = ['getResource', 'hasResourceBundle', 'getResourceBundle', 'getDataByLanguage'];\n      storeApi.forEach(function (fcName) {\n        _this2[fcName] = function () {\n          var _this2$store;\n\n          return (_this2$store = _this2.store)[fcName].apply(_this2$store, arguments);\n        };\n      });\n      var storeApiChained = ['addResource', 'addResources', 'addResourceBundle', 'removeResourceBundle'];\n      storeApiChained.forEach(function (fcName) {\n        _this2[fcName] = function () {\n          var _this2$store2;\n\n          (_this2$store2 = _this2.store)[fcName].apply(_this2$store2, arguments);\n\n          return _this2;\n        };\n      });\n      var deferred = defer();\n\n      var load = function load() {\n        var finish = function finish(err, t) {\n          if (_this2.isInitialized && !_this2.initializedStoreOnce) _this2.logger.warn('init: i18next is already initialized. You should call init just once!');\n          _this2.isInitialized = true;\n          if (!_this2.options.isClone) _this2.logger.log('initialized', _this2.options);\n\n          _this2.emit('initialized', _this2.options);\n\n          deferred.resolve(t);\n          callback(err, t);\n        };\n\n        if (_this2.languages && _this2.options.compatibilityAPI !== 'v1' && !_this2.isInitialized) return finish(null, _this2.t.bind(_this2));\n\n        _this2.changeLanguage(_this2.options.lng, finish);\n      };\n\n      if (this.options.resources || !this.options.initImmediate) {\n        load();\n      } else {\n        setTimeout(load, 0);\n      }\n\n      return deferred;\n    }\n  }, {\n    key: \"loadResources\",\n    value: function loadResources(language) {\n      var _this3 = this;\n\n      var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n      var usedCallback = callback;\n      var usedLng = typeof language === 'string' ? language : this.language;\n      if (typeof language === 'function') usedCallback = language;\n\n      if (!this.options.resources || this.options.partialBundledLanguages) {\n        if (usedLng && usedLng.toLowerCase() === 'cimode') return usedCallback();\n        var toLoad = [];\n\n        var append = function append(lng) {\n          if (!lng) return;\n\n          var lngs = _this3.services.languageUtils.toResolveHierarchy(lng);\n\n          lngs.forEach(function (l) {\n            if (toLoad.indexOf(l) < 0) toLoad.push(l);\n          });\n        };\n\n        if (!usedLng) {\n          var fallbacks = this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);\n          fallbacks.forEach(function (l) {\n            return append(l);\n          });\n        } else {\n          append(usedLng);\n        }\n\n        if (this.options.preload) {\n          this.options.preload.forEach(function (l) {\n            return append(l);\n          });\n        }\n\n        this.services.backendConnector.load(toLoad, this.options.ns, function (e) {\n          if (!e && !_this3.resolvedLanguage && _this3.language) _this3.setResolvedLanguage(_this3.language);\n          usedCallback(e);\n        });\n      } else {\n        usedCallback(null);\n      }\n    }\n  }, {\n    key: \"reloadResources\",\n    value: function reloadResources(lngs, ns, callback) {\n      var deferred = defer();\n      if (!lngs) lngs = this.languages;\n      if (!ns) ns = this.options.ns;\n      if (!callback) callback = noop;\n      this.services.backendConnector.reload(lngs, ns, function (err) {\n        deferred.resolve();\n        callback(err);\n      });\n      return deferred;\n    }\n  }, {\n    key: \"use\",\n    value: function use(module) {\n      if (!module) throw new Error('You are passing an undefined module! Please check the object you are passing to i18next.use()');\n      if (!module.type) throw new Error('You are passing a wrong module! Please check the object you are passing to i18next.use()');\n\n      if (module.type === 'backend') {\n        this.modules.backend = module;\n      }\n\n      if (module.type === 'logger' || module.log && module.warn && module.error) {\n        this.modules.logger = module;\n      }\n\n      if (module.type === 'languageDetector') {\n        this.modules.languageDetector = module;\n      }\n\n      if (module.type === 'i18nFormat') {\n        this.modules.i18nFormat = module;\n      }\n\n      if (module.type === 'postProcessor') {\n        postProcessor.addPostProcessor(module);\n      }\n\n      if (module.type === 'formatter') {\n        this.modules.formatter = module;\n      }\n\n      if (module.type === '3rdParty') {\n        this.modules.external.push(module);\n      }\n\n      return this;\n    }\n  }, {\n    key: \"setResolvedLanguage\",\n    value: function setResolvedLanguage(l) {\n      if (!l || !this.languages) return;\n      if (['cimode', 'dev'].indexOf(l) > -1) return;\n\n      for (var li = 0; li < this.languages.length; li++) {\n        var lngInLngs = this.languages[li];\n        if (['cimode', 'dev'].indexOf(lngInLngs) > -1) continue;\n\n        if (this.store.hasLanguageSomeTranslations(lngInLngs)) {\n          this.resolvedLanguage = lngInLngs;\n          break;\n        }\n      }\n    }\n  }, {\n    key: \"changeLanguage\",\n    value: function changeLanguage(lng, callback) {\n      var _this4 = this;\n\n      this.isLanguageChangingTo = lng;\n      var deferred = defer();\n      this.emit('languageChanging', lng);\n\n      var setLngProps = function setLngProps(l) {\n        _this4.language = l;\n        _this4.languages = _this4.services.languageUtils.toResolveHierarchy(l);\n        _this4.resolvedLanguage = undefined;\n\n        _this4.setResolvedLanguage(l);\n      };\n\n      var done = function done(err, l) {\n        if (l) {\n          setLngProps(l);\n\n          _this4.translator.changeLanguage(l);\n\n          _this4.isLanguageChangingTo = undefined;\n\n          _this4.emit('languageChanged', l);\n\n          _this4.logger.log('languageChanged', l);\n        } else {\n          _this4.isLanguageChangingTo = undefined;\n        }\n\n        deferred.resolve(function () {\n          return _this4.t.apply(_this4, arguments);\n        });\n        if (callback) callback(err, function () {\n          return _this4.t.apply(_this4, arguments);\n        });\n      };\n\n      var setLng = function setLng(lngs) {\n        if (!lng && !lngs && _this4.services.languageDetector) lngs = [];\n        var l = typeof lngs === 'string' ? lngs : _this4.services.languageUtils.getBestMatchFromCodes(lngs);\n\n        if (l) {\n          if (!_this4.language) {\n            setLngProps(l);\n          }\n\n          if (!_this4.translator.language) _this4.translator.changeLanguage(l);\n          if (_this4.services.languageDetector) _this4.services.languageDetector.cacheUserLanguage(l);\n        }\n\n        _this4.loadResources(l, function (err) {\n          done(err, l);\n        });\n      };\n\n      if (!lng && this.services.languageDetector && !this.services.languageDetector.async) {\n        setLng(this.services.languageDetector.detect());\n      } else if (!lng && this.services.languageDetector && this.services.languageDetector.async) {\n        this.services.languageDetector.detect(setLng);\n      } else {\n        setLng(lng);\n      }\n\n      return deferred;\n    }\n  }, {\n    key: \"getFixedT\",\n    value: function getFixedT(lng, ns, keyPrefix) {\n      var _this5 = this;\n\n      var fixedT = function fixedT(key, opts) {\n        var options;\n\n        if (_typeof(opts) !== 'object') {\n          for (var _len3 = arguments.length, rest = new Array(_len3 > 2 ? _len3 - 2 : 0), _key3 = 2; _key3 < _len3; _key3++) {\n            rest[_key3 - 2] = arguments[_key3];\n          }\n\n          options = _this5.options.overloadTranslationOptionHandler([key, opts].concat(rest));\n        } else {\n          options = _objectSpread$6({}, opts);\n        }\n\n        options.lng = options.lng || fixedT.lng;\n        options.lngs = options.lngs || fixedT.lngs;\n        options.ns = options.ns || fixedT.ns;\n        var keySeparator = _this5.options.keySeparator || '.';\n        var resultKey = keyPrefix ? \"\".concat(keyPrefix).concat(keySeparator).concat(key) : key;\n        return _this5.t(resultKey, options);\n      };\n\n      if (typeof lng === 'string') {\n        fixedT.lng = lng;\n      } else {\n        fixedT.lngs = lng;\n      }\n\n      fixedT.ns = ns;\n      fixedT.keyPrefix = keyPrefix;\n      return fixedT;\n    }\n  }, {\n    key: \"t\",\n    value: function t() {\n      var _this$translator;\n\n      return this.translator && (_this$translator = this.translator).translate.apply(_this$translator, arguments);\n    }\n  }, {\n    key: \"exists\",\n    value: function exists() {\n      var _this$translator2;\n\n      return this.translator && (_this$translator2 = this.translator).exists.apply(_this$translator2, arguments);\n    }\n  }, {\n    key: \"setDefaultNamespace\",\n    value: function setDefaultNamespace(ns) {\n      this.options.defaultNS = ns;\n    }\n  }, {\n    key: \"hasLoadedNamespace\",\n    value: function hasLoadedNamespace(ns) {\n      var _this6 = this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n      if (!this.isInitialized) {\n        this.logger.warn('hasLoadedNamespace: i18next was not initialized', this.languages);\n        return false;\n      }\n\n      if (!this.languages || !this.languages.length) {\n        this.logger.warn('hasLoadedNamespace: i18n.languages were undefined or empty', this.languages);\n        return false;\n      }\n\n      var lng = this.resolvedLanguage || this.languages[0];\n      var fallbackLng = this.options ? this.options.fallbackLng : false;\n      var lastLng = this.languages[this.languages.length - 1];\n      if (lng.toLowerCase() === 'cimode') return true;\n\n      var loadNotPending = function loadNotPending(l, n) {\n        var loadState = _this6.services.backendConnector.state[\"\".concat(l, \"|\").concat(n)];\n\n        return loadState === -1 || loadState === 2;\n      };\n\n      if (options.precheck) {\n        var preResult = options.precheck(this, loadNotPending);\n        if (preResult !== undefined) return preResult;\n      }\n\n      if (this.hasResourceBundle(lng, ns)) return true;\n      if (!this.services.backendConnector.backend || this.options.resources && !this.options.partialBundledLanguages) return true;\n      if (loadNotPending(lng, ns) && (!fallbackLng || loadNotPending(lastLng, ns))) return true;\n      return false;\n    }\n  }, {\n    key: \"loadNamespaces\",\n    value: function loadNamespaces(ns, callback) {\n      var _this7 = this;\n\n      var deferred = defer();\n\n      if (!this.options.ns) {\n        callback && callback();\n        return Promise.resolve();\n      }\n\n      if (typeof ns === 'string') ns = [ns];\n      ns.forEach(function (n) {\n        if (_this7.options.ns.indexOf(n) < 0) _this7.options.ns.push(n);\n      });\n      this.loadResources(function (err) {\n        deferred.resolve();\n        if (callback) callback(err);\n      });\n      return deferred;\n    }\n  }, {\n    key: \"loadLanguages\",\n    value: function loadLanguages(lngs, callback) {\n      var deferred = defer();\n      if (typeof lngs === 'string') lngs = [lngs];\n      var preloaded = this.options.preload || [];\n      var newLngs = lngs.filter(function (lng) {\n        return preloaded.indexOf(lng) < 0;\n      });\n\n      if (!newLngs.length) {\n        if (callback) callback();\n        return Promise.resolve();\n      }\n\n      this.options.preload = preloaded.concat(newLngs);\n      this.loadResources(function (err) {\n        deferred.resolve();\n        if (callback) callback(err);\n      });\n      return deferred;\n    }\n  }, {\n    key: \"dir\",\n    value: function dir(lng) {\n      if (!lng) lng = this.resolvedLanguage || (this.languages && this.languages.length > 0 ? this.languages[0] : this.language);\n      if (!lng) return 'rtl';\n      var rtlLngs = ['ar', 'shu', 'sqr', 'ssh', 'xaa', 'yhd', 'yud', 'aao', 'abh', 'abv', 'acm', 'acq', 'acw', 'acx', 'acy', 'adf', 'ads', 'aeb', 'aec', 'afb', 'ajp', 'apc', 'apd', 'arb', 'arq', 'ars', 'ary', 'arz', 'auz', 'avl', 'ayh', 'ayl', 'ayn', 'ayp', 'bbz', 'pga', 'he', 'iw', 'ps', 'pbt', 'pbu', 'pst', 'prp', 'prd', 'ug', 'ur', 'ydd', 'yds', 'yih', 'ji', 'yi', 'hbo', 'men', 'xmn', 'fa', 'jpr', 'peo', 'pes', 'prs', 'dv', 'sam', 'ckb'];\n      return rtlLngs.indexOf(this.services.languageUtils.getLanguagePartFromCode(lng)) > -1 || lng.toLowerCase().indexOf('-arab') > 1 ? 'rtl' : 'ltr';\n    }\n  }, {\n    key: \"cloneInstance\",\n    value: function cloneInstance() {\n      var _this8 = this;\n\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var callback = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : noop;\n\n      var mergedOptions = _objectSpread$6(_objectSpread$6(_objectSpread$6({}, this.options), options), {\n        isClone: true\n      });\n\n      var clone = new I18n(mergedOptions);\n      var membersToCopy = ['store', 'services', 'language'];\n      membersToCopy.forEach(function (m) {\n        clone[m] = _this8[m];\n      });\n      clone.services = _objectSpread$6({}, this.services);\n      clone.services.utils = {\n        hasLoadedNamespace: clone.hasLoadedNamespace.bind(clone)\n      };\n      clone.translator = new Translator(clone.services, clone.options);\n      clone.translator.on('*', function (event) {\n        for (var _len4 = arguments.length, args = new Array(_len4 > 1 ? _len4 - 1 : 0), _key4 = 1; _key4 < _len4; _key4++) {\n          args[_key4 - 1] = arguments[_key4];\n        }\n\n        clone.emit.apply(clone, [event].concat(args));\n      });\n      clone.init(mergedOptions, callback);\n      clone.translator.options = clone.options;\n      clone.translator.backendConnector.services.utils = {\n        hasLoadedNamespace: clone.hasLoadedNamespace.bind(clone)\n      };\n      return clone;\n    }\n  }, {\n    key: \"toJSON\",\n    value: function toJSON() {\n      return {\n        options: this.options,\n        store: this.store,\n        language: this.language,\n        languages: this.languages,\n        resolvedLanguage: this.resolvedLanguage\n      };\n    }\n  }]);\n\n  return I18n;\n}(EventEmitter);\n\n_defineProperty(I18n, \"createInstance\", function () {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var callback = arguments.length > 1 ? arguments[1] : undefined;\n  return new I18n(options, callback);\n});\n\nvar instance = I18n.createInstance();\ninstance.createInstance = I18n.createInstance;\n\nvar createInstance = instance.createInstance;\nvar init = instance.init;\nvar loadResources = instance.loadResources;\nvar reloadResources = instance.reloadResources;\nvar use = instance.use;\nvar changeLanguage = instance.changeLanguage;\nvar getFixedT = instance.getFixedT;\nvar t = instance.t;\nvar exists = instance.exists;\nvar setDefaultNamespace = instance.setDefaultNamespace;\nvar hasLoadedNamespace = instance.hasLoadedNamespace;\nvar loadNamespaces = instance.loadNamespaces;\nvar loadLanguages = instance.loadLanguages;\n\nexport default instance;\nexport { changeLanguage, createInstance, exists, getFixedT, hasLoadedNamespace, init, loadLanguages, loadNamespaces, loadResources, reloadResources, setDefaultNamespace, t, use };\n","import _classCallCheck from '@babel/runtime/helpers/esm/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/esm/createClass';\nimport _defineProperty from '@babel/runtime/helpers/esm/defineProperty';\nimport _typeof from '@babel/runtime/helpers/esm/typeof';\n\nvar arr = [];\nvar each = arr.forEach;\nvar slice = arr.slice;\nfunction defaults(obj) {\n  each.call(slice.call(arguments, 1), function (source) {\n    if (source) {\n      for (var prop in source) {\n        if (obj[prop] === undefined) obj[prop] = source[prop];\n      }\n    }\n  });\n  return obj;\n}\n\nfunction addQueryString(url, params) {\n  if (params && _typeof(params) === 'object') {\n    var queryString = '',\n        e = encodeURIComponent; // Must encode data\n\n    for (var paramName in params) {\n      queryString += '&' + e(paramName) + '=' + e(params[paramName]);\n    }\n\n    if (!queryString) {\n      return url;\n    }\n\n    url = url + (url.indexOf('?') !== -1 ? '&' : '?') + queryString.slice(1);\n  }\n\n  return url;\n} // https://gist.github.com/Xeoncross/7663273\n\n\nfunction ajax(url, options, callback, data, cache) {\n  if (data && _typeof(data) === 'object') {\n    if (!cache) {\n      data['_t'] = new Date();\n    } // URL encoded form data must be in querystring format\n\n\n    data = addQueryString('', data).slice(1);\n  }\n\n  if (options.queryStringParams) {\n    url = addQueryString(url, options.queryStringParams);\n  }\n\n  try {\n    var x;\n\n    if (XMLHttpRequest) {\n      x = new XMLHttpRequest();\n    } else {\n      x = new ActiveXObject('MSXML2.XMLHTTP.3.0');\n    }\n\n    x.open(data ? 'POST' : 'GET', url, 1);\n\n    if (!options.crossDomain) {\n      x.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n    }\n\n    x.withCredentials = !!options.withCredentials;\n\n    if (data) {\n      x.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n    }\n\n    if (x.overrideMimeType) {\n      x.overrideMimeType(\"application/json\");\n    }\n\n    var h = options.customHeaders;\n    h = typeof h === 'function' ? h() : h;\n\n    if (h) {\n      for (var i in h) {\n        x.setRequestHeader(i, h[i]);\n      }\n    }\n\n    x.onreadystatechange = function () {\n      x.readyState > 3 && callback && callback(x.responseText, x);\n    };\n\n    x.send(data);\n  } catch (e) {\n    console && console.log(e);\n  }\n}\n\nfunction getDefaults() {\n  return {\n    loadPath: '/locales/{{lng}}/{{ns}}.json',\n    addPath: '/locales/add/{{lng}}/{{ns}}',\n    allowMultiLoading: false,\n    parse: JSON.parse,\n    parsePayload: function parsePayload(namespace, key, fallbackValue) {\n      return _defineProperty({}, key, fallbackValue || '');\n    },\n    crossDomain: false,\n    ajax: ajax\n  };\n}\n\nvar Backend =\n/*#__PURE__*/\nfunction () {\n  function Backend(services) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Backend);\n\n    this.init(services, options);\n    this.type = 'backend';\n  }\n\n  _createClass(Backend, [{\n    key: \"init\",\n    value: function init(services) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      this.services = services;\n      this.options = defaults(options, this.options || {}, getDefaults());\n    }\n  }, {\n    key: \"readMulti\",\n    value: function readMulti(languages, namespaces, callback) {\n      var loadPath = this.options.loadPath;\n\n      if (typeof this.options.loadPath === 'function') {\n        loadPath = this.options.loadPath(languages, namespaces);\n      }\n\n      var url = this.services.interpolator.interpolate(loadPath, {\n        lng: languages.join('+'),\n        ns: namespaces.join('+')\n      });\n      this.loadUrl(url, callback);\n    }\n  }, {\n    key: \"read\",\n    value: function read(language, namespace, callback) {\n      var loadPath = this.options.loadPath;\n\n      if (typeof this.options.loadPath === 'function') {\n        loadPath = this.options.loadPath([language], [namespace]);\n      }\n\n      var url = this.services.interpolator.interpolate(loadPath, {\n        lng: language,\n        ns: namespace\n      });\n      this.loadUrl(url, callback);\n    }\n  }, {\n    key: \"loadUrl\",\n    value: function loadUrl(url, callback) {\n      var _this = this;\n\n      this.options.ajax(url, this.options, function (data, xhr) {\n        if (xhr.status >= 500 && xhr.status < 600) return callback('failed loading ' + url, true\n        /* retry */\n        );\n        if (xhr.status >= 400 && xhr.status < 500) return callback('failed loading ' + url, false\n        /* no retry */\n        );\n        var ret, err;\n\n        try {\n          ret = _this.options.parse(data, url);\n        } catch (e) {\n          err = 'failed parsing ' + url + ' to json';\n        }\n\n        if (err) return callback(err, false);\n        callback(null, ret);\n      });\n    }\n  }, {\n    key: \"create\",\n    value: function create(languages, namespace, key, fallbackValue) {\n      var _this2 = this;\n\n      if (typeof languages === 'string') languages = [languages];\n      var payload = this.options.parsePayload(namespace, key, fallbackValue);\n      languages.forEach(function (lng) {\n        var url = _this2.services.interpolator.interpolate(_this2.options.addPath, {\n          lng: lng,\n          ns: namespace\n        });\n\n        _this2.options.ajax(url, _this2.options, function (data, xhr) {//const statusCode = xhr.status.toString();\n          // TODO: if statusCode === 4xx do log\n        }, payload);\n      });\n    }\n  }]);\n\n  return Backend;\n}();\n\nBackend.type = 'backend';\n\nexport default Backend;\n","import Event from \"ol/events/Event\";\n\nexport default class CustomEvent extends Event {\n  detail: any;\n  constructor(type: string, detail: any) {\n    super(type);\n    this.detail = detail;\n  }\n}\n","const browserLanguage = (): string => {\n  const ua = window.navigator.userAgent.toLowerCase();\n  try {\n    let lang;\n    // Chrome\n    if (ua.indexOf(\"chrome\") != -1) {\n      lang = (\n        navigator.languages[0] ||\n        (navigator as any).browserLanguage ||\n        navigator.language ||\n        (navigator as any).userLanguage\n      ).split(\";\");\n      return lang[0];\n    }\n    // Other\n    else {\n      lang = (\n        (navigator as any).browserLanguage ||\n        navigator.language ||\n        (navigator as any).userLanguage\n      ).split(\";\");\n      return lang[0];\n    }\n  } catch (e) {\n    return \"\";\n  }\n};\nexport default browserLanguage;\n","type AllLoggerLevelKeys = \"ALL\" | \"DEBUG\" | \"INFO\" | \"WARN\" | \"ERROR\" | \"OFF\";\nconst excludeKeys = [\"ALL\", \"OFF\"] as const;\ntype LoggerLevelKeys = Exclude<AllLoggerLevelKeys, typeof excludeKeys[number]>;\ntype TLogger = { [key in Lowercase<LoggerLevelKeys>]: Console[\"log\"] };\n\nexport const LOGGER_LEVEL = {\n  ALL: -99,\n  DEBUG: -1,\n  INFO: 0,\n  WARN: 1,\n  ERROR: 2,\n  OFF: 99\n} as const;\n\n// eslint-disable-next-line\nexport interface Logger extends TLogger {}\n\nexport class Logger {\n  constructor(\n    public level: typeof LOGGER_LEVEL[AllLoggerLevelKeys] = LOGGER_LEVEL.INFO\n  ) {\n    this.make();\n  }\n\n  private make() {\n    const keys = (Object.keys(LOGGER_LEVEL) as AllLoggerLevelKeys[]).filter(\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-expect-error\n      key => !excludeKeys.includes(key)\n    ) as LoggerLevelKeys[];\n\n    for (const key of keys) {\n      const l = LOGGER_LEVEL[key];\n      const lowerCaseKey = key.toLowerCase() as Lowercase<LoggerLevelKeys>;\n      // eslint-disable-next-line @typescript-eslint/no-empty-function\n      this[lowerCaseKey] = this.level <= l ? console.log : () => {};\n    }\n  }\n}\n","export const MERC_MAX = 20037508.342789244;\nexport const MERC_CROSSMATRIX: number[][] = [\n  [0.0, 0.0],\n  [0.0, 1.0],\n  [1.0, 0.0],\n  [0.0, -1.0],\n  [-1.0, 0.0]\n];\n\n// PNG\nexport const transPng =\n  \"data:image/png;base64,\" +\n  \"iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAAB3RJTUUH3QgIBToaSbAjlwAAABd0\" +\n  \"RVh0U29mdHdhcmUAR0xEUE5HIHZlciAzLjRxhaThAAAACHRwTkdHTEQzAAAAAEqAKR8AAAAEZ0FN\" +\n  \"QQAAsY8L/GEFAAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAAFRJREFUeNrtwQEBAAAAgJD+\" +\n  \"r+4ICgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" +\n  \"AAAAAAAAAAAAABgBDwABHHIJwwAAAABJRU5ErkJggg==\";\n\n// \nexport const tileSize = 256;\n\n// canvas\nexport const canvBase = `<canvas width=\"${tileSize}\" height=\"${tileSize}\" src=\"${transPng}\"></canvas>`;\n","// Async initializer 6: Load pois setting\nexport async function nodesLoader(\n  nodes: string | Record<string, unknown>\n): Promise<Record<string, unknown>> {\n  if (typeof nodes === \"string\") {\n    return new Promise((resolve, reject) => {\n      const url = nodes.match(/\\//) ? nodes : `pois/${nodes}`;\n\n      const xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.responseType = \"json\";\n\n      xhr.onload = function (_e) {\n        if (this.status == 200 || this.status == 0) {\n          // 0 for UIWebView\n          try {\n            let resp: string | Record<string, unknown> = this.response;\n            if (typeof resp === \"string\") resp = JSON.parse(resp);\n            resolve(resp as Record<string, unknown>);\n          } catch (err) {\n            reject(err);\n          }\n        } else {\n          reject(\"Fail to load poi json\");\n        }\n      };\n      xhr.send();\n    });\n  } else {\n    return nodes;\n  }\n}\n\n//pois: Process layers\nexport async function normalizeLayers(layers: any, options: any) {\n  // Resolve url cases\n  layers = await nodesLoader(layers);\n\n  //In case \"layers\" is array\n  if (Array.isArray(layers)) {\n    layers = await Promise.all(layers.map(async x => await nodesLoader(x)));\n    //In case of array of FeatureCollection\n    if (layers.length > 0 && layers[0].type === \"FeatureCollection\") {\n      layers = layers.reduce((prev: any, layer: any, index: any) => {\n        let key = layer.id || (layer.properties && layer.properties.id);\n        if (!key) {\n          if (index === 0) key = \"main\";\n          else throw \"POI layers include bad key setting\";\n        }\n        prev[key] = normalizeLayer(layer, key, options);\n        return prev;\n      }, {});\n      //In case old type single layer spec\n    } else {\n      layers = {\n        main: normalizeLayer(layers, \"main\", options)\n      };\n    }\n    // In case of single FeatureCollection\n  } else if (layers.type === \"FeatureCollection\") {\n    const key =\n      layers.id || (layers.properties && layers.properties.id) || \"main\";\n    layers = { [key]: normalizeLayer(layers, key, options) };\n    // In case current non-geojson layers spec\n  } else {\n    Object.keys(layers).map(key => {\n      layers[key] = normalizeLayer(layers[key], key, options);\n    });\n  }\n\n  // Add main layer if not exists\n  if (!layers[\"main\"]) {\n    layers[\"main\"] = normalizeLayer([], \"main\", options);\n  }\n  Object.keys(layers).map(key => {\n    addIdToPoi(layers, key, options);\n  });\n\n  return layers;\n}\n\n//pois: Process layers\nexport function normalizeLayer(layer: any, key: any, options: any) {\n  //In case \"layer\" is array (Old spec)\n  if (Array.isArray(layer)) {\n    layer = {\n      pois: layer.map(x => normalizePoi(x))\n    };\n    //In case \"layer\" is FeatureCollection\n  } else if (layer.type === \"FeatureCollection\") {\n    const buffer = Object.assign({}, layer.properties || {});\n    if (layer.name) buffer.name = layer.name;\n    buffer.pois = layer.features.map((x: any) => normalizePoi(x));\n    layer = buffer;\n  }\n\n  if (typeof layer.id === \"undefined\") {\n    layer.id = key;\n  } else {\n    if (layer.id !== key) throw \"POI layers include bad key setting\";\n  }\n  if (!layer.namespaceID)\n    layer.namespaceID = `${\n      options.namespace ? `${options.namespace}#` : \"\"\n    }${key}`;\n  if (!layer.name) layer.name = key === \"main\" ? options.name : key;\n  if (!layer.pois) layer.pois = [];\n\n  return layer;\n}\n\n//pois: Process poi\nexport function normalizePoi(poi: any) {\n  //In case \"poi\" is GeoJson(Point)\n  if (poi.type === \"Feature\") {\n    const buffer = Object.assign({}, poi.properties || {});\n    buffer.lnglat = poi.geometry.coordinates;\n    if (!buffer.id) buffer.id = poi.id;\n    if (!buffer.name) buffer.name = poi.name;\n    poi = buffer;\n  }\n  if (!poi.lnglat)\n    poi.lnglat = [poi.lng || poi.longitude, poi.lat || poi.latitude];\n  delete poi.lng;\n  delete poi.lat;\n  delete poi.longitude;\n  delete poi.latitude;\n  return poi;\n}\n\n// Add id to every pois\nexport function addIdToPoi(layers: any, key: any, options: any) {\n  if (!layers[key]) return;\n  const cluster = layers[key];\n  const pois = cluster.pois;\n  if (!cluster.__nextId) {\n    cluster.__nextId = 0;\n  }\n  pois.map((poi: any) => {\n    if (!poi.id) {\n      poi.id = `${key}_${cluster.__nextId}`;\n      cluster.__nextId++;\n    }\n    if (!poi.namespaceID) {\n      poi.namespaceID = `${options.namespace ? `${options.namespace}#` : \"\"}${\n        poi.id\n      }`;\n    }\n  });\n}\n","import Weiwudi from \"weiwudi\";\nimport { MaplatMap } from \"../map_ex\";\nimport { Coordinate } from \"ol/coordinate\";\nimport { transform } from \"ol/proj\";\nimport { canvBase, MERC_CROSSMATRIX, MERC_MAX } from \"../const_ex\";\nimport {\n  addIdToPoi,\n  normalizeLayer,\n  normalizeLayers,\n  normalizePoi\n} from \"../normalize_pois\";\nimport { normalizeArg } from \"../functions\";\nimport { polygon } from \"@turf/helpers\";\nimport centroid from \"@turf/centroid\";\nimport { Feature, Polygon } from \"@turf/turf\";\nimport { Size } from \"ol/size\";\nimport { View as mlView } from \"../view_ex\";\n\n// eslint-disable-next-line @typescript-eslint/ban-types\ntype Constructor<T = {}> = new (...args: any[]) => T;\ntype ViewpointObject = {\n  x?: number;\n  y?: number;\n  latitude?: number;\n  longitude?: number;\n  mercZoom?: number;\n  zoom?: number;\n  direction?: number;\n  rotation?: number;\n};\nexport type ViewpointArray = [Coordinate?, number?, number?]; // Center, zoom, rotation\nexport type CrossCoordinatesArray = [\n  Coordinate[], // Coordinates of center and around 4 points\n  Size? // size\n];\n\nexport function setCustomFunction<TBase extends Constructor>(Base: TBase) {\n  abstract class Mixin extends Base {\n    weiwudi?: Weiwudi;\n    _map?: MaplatMap;\n    homePosition?: Coordinate;\n    mercZoom?: number;\n    pois: any;\n    officialTitle = \"\";\n    title = \"\";\n    mapID = \"\";\n    label = \"\";\n    initialWait?: Promise<any>;\n    maxZoom?: number;\n    minZoom?: number;\n    envelope?: Feature<Polygon>;\n    centroid?: number[];\n    homeMarginPixels = 0;\n\n    abstract insideCheckSysCoord(sysCoord: Coordinate): boolean;\n\n    getCacheEnable() {\n      return !!this.weiwudi;\n    }\n\n    async getTileCacheStatsAsync() {\n      if (!this.weiwudi) return {};\n      try {\n        return await this.weiwudi.stats();\n      } catch (e) {\n        return {};\n      }\n    }\n\n    async getTileCacheSizeAsync() {\n      const stats = await this.getTileCacheStatsAsync();\n      return stats.size || 0;\n    }\n\n    async fetchAllTileCacheAsync(callback: any) {\n      if (!this.weiwudi) return;\n      try {\n        const listner = (e: any) => {\n          callback(e.type, e.detail);\n        };\n        const deleteListner = (e: any) => {\n          this.weiwudi!.removeEventListener(\"proceed\", listner);\n          this.weiwudi!.removeEventListener(\"finish\", deleteListner);\n          this.weiwudi!.removeEventListener(\"stop\", deleteListner);\n          this.weiwudi!.removeEventListener(\"canceled\", deleteListner);\n          listner(e);\n        };\n        this.weiwudi.addEventListener(\"proceed\", listner);\n        this.weiwudi.addEventListener(\"finish\", deleteListner);\n        this.weiwudi.addEventListener(\"stop\", deleteListner);\n        this.weiwudi.addEventListener(\"canceled\", deleteListner);\n        await this.weiwudi.fetchAll();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    async cancelTileCacheAsync() {\n      if (!this.weiwudi) return;\n      try {\n        await this.weiwudi.cancel();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    async clearTileCacheAsync() {\n      if (!this.weiwudi) return;\n      try {\n        await this.weiwudi.clean();\n      } catch (e) {} // eslint-disable-line no-empty\n    }\n\n    getMap() {\n      return this._map!;\n    }\n\n    setMap(map: MaplatMap) {\n      this._map = map;\n    }\n\n    // lnglatmercZoomzoomdirectionrotation\n    setViewpointRadian(cond: ViewpointObject) {\n      let merc: Coordinate;\n      let xy: Coordinate;\n      const mercZoom = cond.mercZoom;\n      const zoom = cond.zoom;\n      const direction = cond.direction;\n      const rotation = cond.rotation;\n      const map = this.getMap();\n      const view = map?.getView();\n      if (cond.latitude !== undefined && cond.longitude !== undefined) {\n        merc = transform(\n          [cond.longitude, cond.latitude],\n          \"EPSG:4326\",\n          \"EPSG:3857\"\n        );\n      }\n      if (cond.x !== undefined && cond.y != undefined) {\n        xy = [cond.x, cond.y];\n      }\n      this.viewpoint2MercsAsync()\n        .then(mercs => this.mercs2MercViewpoint(mercs))\n        .then(mercViewpoint => {\n          const mercs = this.mercViewpoint2Mercs([\n            merc || mercViewpoint[0],\n            mercZoom || mercViewpoint[1] || 17,\n            direction !== null ? direction : mercViewpoint[2]\n          ]);\n          this.mercs2ViewpointAsync(mercs).then(viewpoint => {\n            if (merc != null) {\n              view?.setCenter(viewpoint[0]);\n            } else if (xy != null) {\n              view?.setCenter(xy);\n            }\n            if (mercZoom != null) {\n              view?.setZoom(viewpoint[1]!);\n            } else if (zoom != null) {\n              view?.setZoom(zoom);\n            }\n            if (direction != null) {\n              view?.setRotation(viewpoint[2]!);\n            } else if (rotation != null) {\n              view?.setRotation(rotation);\n            }\n          });\n        });\n    }\n\n    setViewpoint(cond: ViewpointObject) {\n      if (cond.rotation) {\n        cond.rotation = (cond.rotation * Math.PI) / 180;\n      }\n      if (cond.direction) {\n        cond.direction = (cond.direction * Math.PI) / 180;\n      }\n      this.setViewpointRadian(cond);\n    }\n\n    abstract defZoom(screenSize?: Size): number;\n\n    goHome() {\n      const ratio = 1; //window.devicePixelRatio;\n      const map = this.getMap() as any;\n      let div = map.getTarget() as any;\n      if (typeof div === \"string\") {\n        div = document.getElementById(div);\n      }\n      const homeMarginPixels = map.homeMarginPixels;\n      const screenSize = [\n        (div.clientWidth - homeMarginPixels - 10) * ratio,\n        (div.clientHeight - homeMarginPixels - 10) * ratio\n      ];\n\n      const options = {\n        longitude: this.homePosition![0],\n        latitude: this.homePosition![1],\n        zoom: this.defZoom(screenSize)\n      } as ViewpointObject;\n      if (this.getMap().northUp) options.direction = 0;\n      else options.rotation = 0;\n      this.setViewpointRadian(options);\n    }\n\n    resetRotation() {\n      this.setViewpointRadian({ rotation: 0 });\n    }\n\n    resetDirection() {\n      this.setViewpointRadian({ direction: 0 });\n    }\n\n    resetCirculation() {\n      if (this.getMap().northUp) this.resetDirection();\n      else this.resetRotation();\n    }\n\n    setGPSMarkerAsync(position: any, ignoreMove = false) {\n      const map = this.getMap();\n      const view = map?.getView();\n      if (!position) {\n        return new Promise((resolve, _reject) => {\n          map?.setGPSPosition(null);\n          resolve(true);\n        });\n      }\n      const mercs = this.mercsFromGPSValue(position.lnglat, position.acc);\n\n      return this.mercs2SysCoordsAsync_multiLayer([mercs])\n        .then(results => {\n          const hide = !results[0];\n          const xys = hide ? results[1]! : results[0]!;\n          const sub = !hide ? results[1] : null;\n          const pos: any = { xy: xys[0][0] };\n          if (!this.insideCheckSysCoord(xys[0][0]!)) {\n            map?.handleGPS(false, true);\n            return false;\n          }\n          const news = xys[0].slice(1);\n\n          pos.rad = news.reduce(\n            (prev: number, curr: Coordinate, index: number) => {\n              const ret =\n                prev +\n                Math.sqrt(\n                  Math.pow(curr[0] - pos.xy[0], 2) +\n                    Math.pow(curr[1] - pos.xy[1], 2)\n                );\n              return index === 3 ? ret / 4.0 : ret;\n            },\n            0\n          );\n          if (!ignoreMove) view?.setCenter(pos.xy);\n          map?.setGPSPosition(pos, hide ? \"hide\" : null);\n          if (sub) {\n            map?.setGPSPosition({ xy: sub[0][0] }, \"sub\");\n          }\n          return true;\n        })\n        .catch(err => {\n          throw err;\n        });\n    }\n\n    setGPSMarker(position: any, ignoreMove = false) {\n      // eslint-disable-next-line @typescript-eslint/no-empty-function\n      this.setGPSMarkerAsync(position, ignoreMove).then(() => {});\n    }\n\n    mercsFromGPSValue(lnglat: Coordinate, acc: number) {\n      const merc = transform(lnglat, \"EPSG:4326\", \"EPSG:3857\");\n      const latrad = (lnglat[1] * Math.PI) / 180;\n      const delta = acc / Math.cos(latrad);\n      return MERC_CROSSMATRIX.map(xy => [\n        xy[0] * delta + merc[0],\n        xy[1] * delta + merc[1]\n      ]);\n    }\n\n    // theta\n    rotateMatrix(xys: number[][], theta?: number): Coordinate[] {\n      if (theta === undefined) {\n        theta = this.getMap().getView().getRotation();\n      }\n      const result: number[][] = [];\n      for (let i = 0; i < xys.length; i++) {\n        const xy = xys[i];\n        const x = xy[0] * Math.cos(theta) - xy[1] * Math.sin(theta);\n        const y = xy[0] * Math.sin(theta) + xy[1] * Math.cos(theta);\n        result.push([x, y]);\n      }\n      return result;\n    }\n\n    async resolvePois(pois?: any) {\n      this.pois = await normalizeLayers(pois || [], {\n        name: this.officialTitle || this.title,\n        namespace: this.mapID\n      });\n    }\n\n    getPoi(id: string) {\n      let ret = undefined;\n      Object.keys(this.pois).map(key => {\n        this.pois[key].pois.map((poi: any, i: number) => {\n          if (poi.id === id) {\n            ret = this.pois[key].pois[i];\n          }\n        });\n      });\n      return ret;\n    }\n\n    addPoi(data: any, clusterId?: string) {\n      if (!clusterId) {\n        clusterId = \"main\";\n      }\n      if (this.pois[clusterId]) {\n        data = normalizePoi(data);\n        this.pois[clusterId][\"pois\"].push(data);\n        addIdToPoi(this.pois, clusterId, {\n          name: this.officialTitle || this.title,\n          namespace: this.mapID\n        });\n        return data.namespaceID;\n      }\n    }\n\n    removePoi(id: string) {\n      Object.keys(this.pois).map(key => {\n        this.pois[key].pois.map((poi: any, i: number) => {\n          if (poi.id === id) {\n            delete this.pois[key].pois[i];\n          }\n        });\n      });\n    }\n\n    clearPoi(clusterId?: string) {\n      if (!clusterId) {\n        clusterId = \"main\";\n      }\n      if (clusterId === \"all\") {\n        Object.keys(this.pois).map(key => {\n          this.pois[key][\"pois\"] = [];\n        });\n      } else if (this.pois[clusterId]) {\n        this.pois[clusterId][\"pois\"] = [];\n      }\n    }\n\n    listPoiLayers(hideOnly = false, nonzero = false) {\n      return Object.keys(this.pois)\n        .sort((a, b) => {\n          if (a === \"main\") return -1;\n          else if (b === \"main\") return 1;\n          else if (a < b) return -1;\n          else if (a > b) return 1;\n          else return 0;\n        })\n        .map(key => this.pois[key])\n        .filter(layer =>\n          nonzero\n            ? hideOnly\n              ? layer.pois.length && layer.hide\n              : layer.pois.length\n            : hideOnly\n            ? layer.hide\n            : true\n        );\n    }\n\n    getPoiLayer(id: string) {\n      return this.pois[id];\n    }\n\n    addPoiLayer(id: string, data: any) {\n      if (id === \"main\") return;\n      if (this.pois[id]) return;\n      this.pois[id] = normalizeLayer(data || [], id, {\n        name: this.officialTitle || this.title,\n        namespace: this.mapID\n      });\n    }\n\n    removePoiLayer(id: string) {\n      if (id === \"main\") return;\n      if (!this.pois[id]) return;\n      delete this.pois[id];\n    }\n\n    // unifyTerm\n    // https://github.com/code4history/MaplatCore/issues/19\n\n    abstract merc2XyAsync(merc: Coordinate): Promise<Coordinate>;\n    abstract merc2XyAsync_ignoreBackground(\n      merc: Coordinate\n    ): Promise<Coordinate | void>;\n    abstract xy2MercAsync(xy: Coordinate): Promise<Coordinate>;\n    abstract xy2SysCoord(xy: Coordinate): Coordinate;\n    abstract sysCoord2Xy(sysCoord: Coordinate): Coordinate;\n    abstract viewpoint2MercsAsync(\n      viewpoint?: ViewpointArray,\n      size?: Size\n    ): Promise<CrossCoordinatesArray>;\n    abstract mercs2ViewpointAsync(\n      mercs: CrossCoordinatesArray\n    ): Promise<ViewpointArray>;\n    abstract mercs2SysCoordsAsync_multiLayer(\n      mercs: CrossCoordinatesArray\n    ): Promise<(CrossCoordinatesArray | undefined)[]>;\n\n    merc2SysCoordAsync_ignoreBackground(\n      merc: Coordinate\n    ): Promise<Coordinate | void> {\n      return this.merc2XyAsync_ignoreBackground(merc).then(xy =>\n        xy ? this.xy2SysCoord(xy) : undefined\n      );\n    }\n\n    merc2SysCoordAsync(merc: Coordinate): Promise<Coordinate> {\n      return this.merc2XyAsync(merc).then(xy =>\n        xy ? this.xy2SysCoord(xy) : xy\n      );\n    }\n\n    sysCoord2MercAsync(sysCoord: Coordinate): Promise<Coordinate> {\n      const xy = this.sysCoord2Xy(sysCoord);\n      return this.xy2MercAsync(xy);\n    }\n\n    // size()zoom\n    zoom2Radius(size: Size, zoom?: number) {\n      const radius = Math.floor(Math.min(size[0], size[1]) / 4);\n      if (zoom === undefined) {\n        zoom = (this.getMap().getView() as mlView).getDecimalZoom();\n      }\n      return (radius * MERC_MAX) / 128 / Math.pow(2, zoom!);\n    }\n\n    // 5zoom, rotate\n    viewpoint2SysCoords(\n      viewpoint?: ViewpointArray,\n      size?: Size\n    ): CrossCoordinatesArray {\n      return this.mercViewpoint2Mercs(viewpoint, size);\n    }\n\n    mercViewpoint2Mercs(\n      viewpoint?: ViewpointArray,\n      size?: Size\n    ): CrossCoordinatesArray {\n      let center = viewpoint ? viewpoint[0] : undefined;\n      const zoom = viewpoint ? viewpoint[1] : undefined;\n      const rotate = viewpoint ? viewpoint[2] : undefined;\n      if (center === undefined) {\n        center = this.getMap().getView().getCenter();\n      }\n      if (size === undefined) {\n        size = this.getMap().getSize()!;\n      }\n      const radius = this.zoom2Radius(size, zoom);\n      const crossDelta = this.rotateMatrix(MERC_CROSSMATRIX, rotate);\n      const cross = crossDelta.map(xy => [\n        xy[0] * radius + center![0],\n        xy[1] * radius + center![1]\n      ]);\n      return [cross, size];\n    }\n\n    // 5\n    sysCoords2Viewpoint(sysCoords: CrossCoordinatesArray): ViewpointArray {\n      return this.mercs2MercViewpoint(sysCoords);\n    }\n\n    // 5\n    mercs2MercViewpoint(mercs: CrossCoordinatesArray): ViewpointArray {\n      const center = mercs[0][0];\n      let size = mercs[1];\n      const nesw = mercs[0].slice(1, 5);\n      const neswDelta = nesw.map(val => [\n        val[0] - center[0],\n        val[1] - center[1]\n      ]);\n      const normal = [\n        [0.0, 1.0],\n        [1.0, 0.0],\n        [0.0, -1.0],\n        [-1.0, 0.0]\n      ];\n      let abss = 0;\n      let cosx = 0;\n      let sinx = 0;\n      for (let i = 0; i < 4; i++) {\n        const delta = neswDelta[i];\n        const norm = normal[i];\n        const abs = Math.sqrt(Math.pow(delta[0], 2) + Math.pow(delta[1], 2));\n        abss += abs;\n        const outer = delta[0] * norm[1] - delta[1] * norm[0];\n        const inner = Math.acos(\n          (delta[0] * norm[0] + delta[1] * norm[1]) / abs\n        );\n        const theta = outer > 0.0 ? -1.0 * inner : inner;\n        cosx += Math.cos(theta);\n        sinx += Math.sin(theta);\n      }\n      const scale = abss / 4.0;\n      const omega = Math.atan2(sinx, cosx);\n\n      if (!size) size = this.getMap().getSize()!;\n      const radius = Math.floor(Math.min(size[0], size[1]) / 4);\n      const zoom = Math.log((radius * MERC_MAX) / 128 / scale) / Math.log(2);\n\n      return [center, zoom, omega];\n    }\n\n    sysCoords2Xys(sysCoords: CrossCoordinatesArray): CrossCoordinatesArray {\n      return [\n        sysCoords[0].map(sysCoord => this.sysCoord2Xy(sysCoord)),\n        sysCoords[1]\n      ];\n    }\n\n    xys2SysCoords(xys: CrossCoordinatesArray): CrossCoordinatesArray {\n      return [xys[0].map(xy => this.xy2SysCoord(xy)), xys[1]];\n    }\n\n    mercs2XysAsync(\n      mercs: CrossCoordinatesArray\n    ): Promise<CrossCoordinatesArray> {\n      return Promise.all(mercs[0].map(merc => this.merc2XyAsync(merc))).then(\n        xys => [xys, mercs[1]]\n      );\n    }\n\n    xys2MercsAsync(xys: CrossCoordinatesArray): Promise<CrossCoordinatesArray> {\n      return Promise.all(xys[0].map(xy => this.xy2MercAsync(xy))).then(\n        mercs => [mercs, xys[1]]\n      );\n    }\n  }\n\n  return Mixin;\n}\n\nexport const META_KEYS = [\n  \"title\",\n  \"officialTitle\",\n  \"author\",\n  \"createdAt\",\n  \"era\",\n  \"contributor\",\n  \"mapper\",\n  \"license\",\n  \"dataLicense\",\n  \"attr\",\n  \"dataAttr\",\n  \"reference\",\n  \"description\"\n];\nconst META_KEYS_OPTION = [\n  \"title\",\n  \"official_title\",\n  \"author\",\n  \"created_at\",\n  \"era\",\n  \"contributor\",\n  \"mapper\",\n  \"license\",\n  \"data_license\",\n  \"attr\",\n  \"data_attr\",\n  \"reference\",\n  \"description\"\n];\n\nexport function setCustomInitialize(self: any, options: any) {\n  options = normalizeArg(options);\n  self.mapID = options.mapID;\n  self.homePosition = options.homePosition;\n  self.mercZoom = options.mercZoom;\n  self.label = options.label;\n  self.maxZoom = options.maxZoom;\n  self.minZoom = options.minZoom;\n  self.poiTemplate = options.poiTemplate;\n  self.poiStyle = options.poiStyle;\n  self.iconTemplate = options.iconTemplate;\n  self.icon = options.icon;\n  self.selectedIcon = options.selectedIcon;\n  self.mercatorXShift = options.mercatorXShift;\n  self.mercatorYShift = options.mercatorYShift;\n  self.weiwudi = options.weiwudi;\n  if (options.envelopeLngLats) {\n    const lngLats = options.envelopeLngLats;\n    const mercs = lngLats.map((lnglat: Coordinate) =>\n      transform(lnglat, \"EPSG:4326\", \"EPSG:3857\")\n    );\n    mercs.push(mercs[0]);\n    self.envelope = polygon([mercs]);\n    self.centroid = centroid(self.envelope).geometry?.coordinates;\n  }\n\n  for (let i = 0; i < META_KEYS.length; i++) {\n    const key = META_KEYS[i];\n    const option_key = META_KEYS_OPTION[i];\n    self[key] = options[option_key] || options[key];\n  }\n\n  const thumbWait = options.thumbnail\n    ? new Promise(resolve => {\n        self.thumbnail = options.thumbnail;\n        resolve(undefined);\n      })\n    : new Promise(resolve => {\n        self.thumbnail = `./tmbs/${options.mapID}.jpg`;\n        fetch(self.thumbnail)\n          .then(response => {\n            if (response.ok) {\n              resolve(undefined);\n            } else {\n              self.thumbnail = `./tmbs/${options.mapID}_menu.jpg`;\n              resolve(undefined);\n            }\n          })\n          .catch(_error => {\n            self.thumbnail = `./tmbs/${options.mapID}_menu.jpg`;\n            resolve(undefined);\n          });\n      }).catch(_error => {\n        self.thumbnail = `./tmbs/${options.mapID || options.sourceID}_menu.jpg`;\n      });\n  const poisWait = self.resolvePois(options.pois);\n  self.initialWait = Promise.all([poisWait, thumbWait]);\n}\n\nexport function setupTileLoadFunction(target: any) {\n  const self = target;\n  target.setTileLoadFunction(\n    (function () {\n      let numLoadingTiles = 0;\n      const tileLoadFn = self.getTileLoadFunction();\n      const tImageLoader = function (\n        _tileCoord: any,\n        src: any,\n        tCanv: any,\n        sx: any,\n        sy: any,\n        sw: any,\n        sh: any\n      ) {\n        return new Promise((resolve, _reject) => {\n          const loader = function (src: any, fallback: any = undefined) {\n            if (numLoadingTiles === 0) {\n              // console.log('loading');\n            }\n            ++numLoadingTiles;\n            const tImage = document.createElement(\"img\"); // eslint-disable-line no-undef\n            tImage.crossOrigin = \"Anonymous\";\n            tImage.onload = tImage.onerror = function () {\n              if (tImage.width && tImage.height) {\n                const ctx = tCanv.getContext(\"2d\");\n                const dx = sx === 0 ? 256 - sw : 0;\n                const dy = sy === 0 ? 256 - sh : 0;\n                sw = sx + sw > tImage.width ? tImage.width - sx : sw;\n                sh = sy + sh > tImage.height ? tImage.height - sy : sh;\n                ctx.drawImage(tImage, sx, sy, sw, sh, dx, dy, sw, sh);\n                resolve(undefined);\n              } else {\n                if (fallback) {\n                  loader(fallback);\n                } else {\n                  resolve(\"tileLoadError\");\n                  //reject('tileLoadError');\n                }\n              }\n              --numLoadingTiles;\n              if (numLoadingTiles === 0) {\n                // console.log('idle');\n              }\n            };\n            tImage.src = src;\n          };\n\n          loader(src);\n        });\n      };\n      return function (tile: any, _src: any) {\n        const zoom = tile.tileCoord[0];\n        let tileX = tile.tileCoord[1];\n        let tileY = tile.tileCoord[2];\n\n        let pixelXShift = Math.round(\n          ((self.mercatorXShift || 0) * 128 * Math.pow(2, zoom)) / MERC_MAX\n        );\n        let pixelYShift = Math.round(\n          ((self.mercatorYShift || 0) * -128 * Math.pow(2, zoom)) / MERC_MAX\n        );\n        while (pixelXShift < 0 || pixelXShift >= 256) {\n          if (pixelXShift < 0) {\n            pixelXShift = pixelXShift + 256;\n            tileX++;\n          } else {\n            pixelXShift = pixelXShift - 256;\n            tileX--;\n          }\n        }\n        while (pixelYShift < 0 || pixelYShift >= 256) {\n          if (pixelYShift < 0) {\n            pixelYShift = pixelYShift + 256;\n            tileY++;\n          } else {\n            pixelYShift = pixelYShift - 256;\n            tileY--;\n          }\n        }\n\n        const tmp = document.createElement(\"div\");\n        tmp.innerHTML = canvBase;\n        const tCanv = tmp.childNodes[0] as HTMLCanvasElement;\n\n        const promises = [\n          [[zoom, tileX, tileY], 0, 0, 256 - pixelXShift, 256 - pixelYShift]\n        ];\n        if (pixelXShift !== 0) {\n          promises.push([\n            [zoom, tileX - 1, tileY],\n            256 - pixelXShift,\n            0,\n            pixelXShift,\n            256 - pixelYShift\n          ]);\n        }\n        if (pixelYShift !== 0) {\n          promises.push([\n            [zoom, tileX, tileY - 1],\n            0,\n            256 - pixelYShift,\n            256 - pixelXShift,\n            pixelYShift\n          ]);\n          if (pixelXShift !== 0) {\n            promises.push([\n              [zoom, tileX - 1, tileY - 1],\n              256 - pixelXShift,\n              256 - pixelYShift,\n              pixelXShift,\n              pixelYShift\n            ]);\n          }\n        }\n\n        Promise.all(\n          promises.map(item => {\n            const url = self.tileUrlFunction(\n              item[0],\n              self.tilePixelRatio_,\n              self.projection_\n            );\n            return tImageLoader(\n              item[0],\n              url,\n              tCanv,\n              item[1],\n              item[2],\n              item[3],\n              item[4]\n            );\n          })\n        )\n          .then(rets => {\n            const err = rets.reduce((prev, ret) => prev && ret, true);\n            if (err) {\n              tile.handleImageError_();\n            } else {\n              const dataUrl = tCanv.toDataURL();\n              const image = tile.getImage();\n              image.crossOrigin = null;\n              tileLoadFn(tile, dataUrl);\n            }\n          })\n          .catch(_err => {\n            tile.handleImageError_();\n          });\n      };\n    })()\n  );\n}\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { META_KEYS } from \"./source/mixin\";\n\nexport function createElement(domStr: string) {\n  const context = document;\n  const fragment = context.createDocumentFragment();\n  const nodes = [];\n  domStr = domStr\n    .replace(/(<\\/?)d([ >])/g, \"$1div$2\")\n    .replace(/(<\\/?)s([ >])/g, \"$1span$2\")\n    .replace(/ din=\"/g, ' data-i18n=\"')\n    .replace(/ dinh=\"/g, ' data-i18n-html=\"')\n    .replace(/ c=\"/g, ' class=\"');\n  // DIV\n  const tmp = fragment.appendChild(context.createElement(\"div\"));\n  tmp.innerHTML = domStr;\n  for (let i = 0; i < tmp.childNodes.length; i++) {\n    // DIVHTMLchildNodes\n    const node = tmp.childNodes[i];\n    // SCRIPT\n    if (node.nodeName && node.nodeName.toLowerCase() === \"script\") {\n      const script = context.createElement(\"script\");\n      // @ts-expect-error\n      if (node.type) {\n        // @ts-expect-error\n        script.type = node.type;\n      }\n      // @ts-expect-error\n      if (node.src) {\n        // @ts-expect-error\n        script.src = node.src;\n      } else {\n        // @ts-expect-error\n        script.text = node.text;\n      }\n      nodes[i] = script;\n    } else {\n      // SCRIPT\n      nodes[i] = node;\n    }\n  }\n  // HTML\n  return nodes;\n}\nexport function normalizeDegree(degree: number) {\n  // eslint-disable-next-line no-constant-condition\n  while (1) {\n    if (degree <= 180 && degree > -180) break;\n    const times = degree > 0 ? -1.0 : 1.0;\n    degree = degree + times * 360.0;\n  }\n  return degree;\n}\n\nexport function createMapInfo(source: any) {\n  if (!source) return;\n  const ret: any = {\n    mapID: source.mapID\n  };\n  for (let i = 0; i < META_KEYS.length; i++) {\n    const key = META_KEYS[i];\n    if (source[key]) {\n      ret[key] = source[key];\n    }\n  }\n  return ret;\n}\n\nexport function normalizeArg(options: Record<string, any>) {\n  const table = {\n    max_zoom: \"maxZoom\",\n    min_zoom: \"minZoom\",\n    envelope_lnglats: \"envelopeLngLats\",\n    envelopLngLats: \"envelopeLngLats\",\n    image_extention: \"imageExtension\",\n    image_extension: \"imageExtension\",\n    imageExtention: \"imageExtension\",\n    map_id: \"mapID\",\n    sourceID: \"mapID\",\n    source_id: \"mapID\",\n    merc_max_zoom: \"mercMaxZoom\",\n    merc_min_zoom: \"mercMinZoom\",\n    zoom_restriction: \"zoomRestriction\",\n    enable_cache: \"enableCache\",\n    default_zoom: \"defaultZoom\",\n    start_from: \"startFrom\",\n    home_position: \"homePosition\",\n    fake_radius: \"fakeRadius\",\n    fake_center: \"fakeCenter\",\n    fake_gps: \"fakeGps\",\n    app_name: \"appName\",\n    setting_file: \"settingFile\",\n    merc_zoom: \"mercZoom\",\n    mapbox_token: \"mapboxToken\",\n    translate_ui: \"translateUI\",\n    restore_session: \"restoreSession\",\n    no_rotate: \"noRotate\",\n    poi_template: \"poiTemplate\",\n    poi_style: \"poiStyle\",\n    icon_template: \"iconTemplate\",\n    default_center: \"defaultCenter\",\n    default_rotation: \"defaultRotation\",\n    selected_icon: \"selectedIcon\",\n    namespace_id: \"namespaceID\",\n    mercator_x_shift: \"mercatorXShift\",\n    mercator_y_shift: \"mercatorYShift\"\n  } as const;\n  return (Object.keys(table) as (keyof typeof table)[]).reduce((opt, key) => {\n    if (opt[key]) {\n      opt[table[key]] = opt[key];\n      delete opt[key];\n    }\n    return opt;\n  }, options);\n}\n","/**\n * @module ol/Geolocation\n */\nimport BaseEvent from './events/Event.js';\nimport BaseObject from './Object.js';\nimport {circular as circularPolygon} from './geom/Polygon.js';\nimport {\n  get as getProjection,\n  getTransformFromProjections,\n  identityTransform,\n} from './proj.js';\nimport {toRadians} from './math.js';\n\n/**\n * @enum {string}\n */\nconst Property = {\n  ACCURACY: 'accuracy',\n  ACCURACY_GEOMETRY: 'accuracyGeometry',\n  ALTITUDE: 'altitude',\n  ALTITUDE_ACCURACY: 'altitudeAccuracy',\n  HEADING: 'heading',\n  POSITION: 'position',\n  PROJECTION: 'projection',\n  SPEED: 'speed',\n  TRACKING: 'tracking',\n  TRACKING_OPTIONS: 'trackingOptions',\n};\n\n/**\n * @enum string\n */\nconst GeolocationErrorType = {\n  /**\n   * Triggered when a `GeolocationPositionError` occurs.\n   * @event module:ol/Geolocation.GeolocationError#error\n   * @api\n   */\n  ERROR: 'error',\n};\n\n/**\n * @classdesc\n * Events emitted on [GeolocationPositionError](https://developer.mozilla.org/en-US/docs/Web/API/GeolocationPositionError).\n */\nexport class GeolocationError extends BaseEvent {\n  /**\n   * @param {GeolocationPositionError} error error object.\n   */\n  constructor(error) {\n    super(GeolocationErrorType.ERROR);\n\n    /**\n     * Code of the underlying `GeolocationPositionError`.\n     * @type {number}\n     * @api\n     */\n    this.code = error.code;\n\n    /**\n     * Message of the underlying `GeolocationPositionError`.\n     * @type {string}\n     * @api\n     */\n    this.message = error.message;\n  }\n}\n\n/**\n * @typedef {Object} Options\n * @property {boolean} [tracking=false] Start Tracking right after\n * instantiation.\n * @property {PositionOptions} [trackingOptions] Tracking options.\n * See https://www.w3.org/TR/geolocation-API/#position_options_interface.\n * @property {import(\"./proj.js\").ProjectionLike} [projection] The projection the position\n * is reported in.\n */\n\n/**\n * @typedef {import(\"./ObjectEventType\").Types|'change:accuracy'|'change:accuracyGeometry'|'change:altitude'|\n *    'change:altitudeAccuracy'|'change:heading'|'change:position'|'change:projection'|'change:speed'|'change:tracking'|\n *    'change:trackingOptions'} GeolocationObjectEventTypes\n */\n\n/***\n * @template Return\n * @typedef {import(\"./Observable\").OnSignature<GeolocationObjectEventTypes, import(\"./Object\").ObjectEvent, Return> &\n *   import(\"./Observable\").OnSignature<'error', GeolocationError, Return> &\n *   import(\"./Observable\").CombinedOnSignature<import(\"./Observable\").EventTypes|GeolocationObjectEventTypes, Return> &\n *   import(\"./Observable\").OnSignature<import(\"./Observable\").EventTypes, import(\"./events/Event.js\").default, Return>} GeolocationOnSignature\n */\n\n/**\n * @classdesc\n * Helper class for providing HTML5 Geolocation capabilities.\n * The [Geolocation API](https://www.w3.org/TR/geolocation-API/)\n * is used to locate a user's position.\n *\n * To get notified of position changes and errors, register listeners for the generic\n * `change` event and the `error` event on your instance of {@link module:ol/Geolocation~Geolocation}.\n *\n * Example:\n *\n *     const geolocation = new Geolocation({\n *       // take the projection to use from the map's view\n *       projection: view.getProjection()\n *     });\n *     // listen to changes in position\n *     geolocation.on('change', function(evt) {\n *       console.log(geolocation.getPosition());\n *     });\n *     // listen to error\n *     geolocation.on('error', function(evt) {\n *       window.console.log(evt.message);\n *     });\n *\n * @fires GeolocationError\n * @api\n */\nclass Geolocation extends BaseObject {\n  /**\n   * @param {Options} [options] Options.\n   */\n  constructor(options) {\n    super();\n\n    /***\n     * @type {GeolocationOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.on;\n\n    /***\n     * @type {GeolocationOnSignature<import(\"./events\").EventsKey>}\n     */\n    this.once;\n\n    /***\n     * @type {GeolocationOnSignature<void>}\n     */\n    this.un;\n\n    options = options || {};\n\n    /**\n     * The unprojected (EPSG:4326) device position.\n     * @private\n     * @type {?import(\"./coordinate.js\").Coordinate}\n     */\n    this.position_ = null;\n\n    /**\n     * @private\n     * @type {import(\"./proj.js\").TransformFunction}\n     */\n    this.transform_ = identityTransform;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.watchId_ = undefined;\n\n    this.addChangeListener(Property.PROJECTION, this.handleProjectionChanged_);\n    this.addChangeListener(Property.TRACKING, this.handleTrackingChanged_);\n\n    if (options.projection !== undefined) {\n      this.setProjection(options.projection);\n    }\n    if (options.trackingOptions !== undefined) {\n      this.setTrackingOptions(options.trackingOptions);\n    }\n\n    this.setTracking(options.tracking !== undefined ? options.tracking : false);\n  }\n\n  /**\n   * Clean up.\n   */\n  disposeInternal() {\n    this.setTracking(false);\n    super.disposeInternal();\n  }\n\n  /**\n   * @private\n   */\n  handleProjectionChanged_() {\n    const projection = this.getProjection();\n    if (projection) {\n      this.transform_ = getTransformFromProjections(\n        getProjection('EPSG:4326'),\n        projection\n      );\n      if (this.position_) {\n        this.set(Property.POSITION, this.transform_(this.position_));\n      }\n    }\n  }\n\n  /**\n   * @private\n   */\n  handleTrackingChanged_() {\n    if ('geolocation' in navigator) {\n      const tracking = this.getTracking();\n      if (tracking && this.watchId_ === undefined) {\n        this.watchId_ = navigator.geolocation.watchPosition(\n          this.positionChange_.bind(this),\n          this.positionError_.bind(this),\n          this.getTrackingOptions()\n        );\n      } else if (!tracking && this.watchId_ !== undefined) {\n        navigator.geolocation.clearWatch(this.watchId_);\n        this.watchId_ = undefined;\n      }\n    }\n  }\n\n  /**\n   * @private\n   * @param {GeolocationPosition} position position event.\n   */\n  positionChange_(position) {\n    const coords = position.coords;\n    this.set(Property.ACCURACY, coords.accuracy);\n    this.set(\n      Property.ALTITUDE,\n      coords.altitude === null ? undefined : coords.altitude\n    );\n    this.set(\n      Property.ALTITUDE_ACCURACY,\n      coords.altitudeAccuracy === null ? undefined : coords.altitudeAccuracy\n    );\n    this.set(\n      Property.HEADING,\n      coords.heading === null ? undefined : toRadians(coords.heading)\n    );\n    if (!this.position_) {\n      this.position_ = [coords.longitude, coords.latitude];\n    } else {\n      this.position_[0] = coords.longitude;\n      this.position_[1] = coords.latitude;\n    }\n    const projectedPosition = this.transform_(this.position_);\n    this.set(Property.POSITION, projectedPosition.slice());\n    this.set(Property.SPEED, coords.speed === null ? undefined : coords.speed);\n    const geometry = circularPolygon(this.position_, coords.accuracy);\n    geometry.applyTransform(this.transform_);\n    this.set(Property.ACCURACY_GEOMETRY, geometry);\n    this.changed();\n  }\n\n  /**\n   * @private\n   * @param {GeolocationPositionError} error error object.\n   */\n  positionError_(error) {\n    this.dispatchEvent(new GeolocationError(error));\n  }\n\n  /**\n   * Get the accuracy of the position in meters.\n   * @return {number|undefined} The accuracy of the position measurement in\n   *     meters.\n   * @observable\n   * @api\n   */\n  getAccuracy() {\n    return /** @type {number|undefined} */ (this.get(Property.ACCURACY));\n  }\n\n  /**\n   * Get a geometry of the position accuracy.\n   * @return {?import(\"./geom/Polygon.js\").default} A geometry of the position accuracy.\n   * @observable\n   * @api\n   */\n  getAccuracyGeometry() {\n    return /** @type {?import(\"./geom/Polygon.js\").default} */ (\n      this.get(Property.ACCURACY_GEOMETRY) || null\n    );\n  }\n\n  /**\n   * Get the altitude associated with the position.\n   * @return {number|undefined} The altitude of the position in meters above mean\n   *     sea level.\n   * @observable\n   * @api\n   */\n  getAltitude() {\n    return /** @type {number|undefined} */ (this.get(Property.ALTITUDE));\n  }\n\n  /**\n   * Get the altitude accuracy of the position.\n   * @return {number|undefined} The accuracy of the altitude measurement in\n   *     meters.\n   * @observable\n   * @api\n   */\n  getAltitudeAccuracy() {\n    return /** @type {number|undefined} */ (\n      this.get(Property.ALTITUDE_ACCURACY)\n    );\n  }\n\n  /**\n   * Get the heading as radians clockwise from North.\n   * Note: depending on the browser, the heading is only defined if the `enableHighAccuracy`\n   * is set to `true` in the tracking options.\n   * @return {number|undefined} The heading of the device in radians from north.\n   * @observable\n   * @api\n   */\n  getHeading() {\n    return /** @type {number|undefined} */ (this.get(Property.HEADING));\n  }\n\n  /**\n   * Get the position of the device.\n   * @return {import(\"./coordinate.js\").Coordinate|undefined} The current position of the device reported\n   *     in the current projection.\n   * @observable\n   * @api\n   */\n  getPosition() {\n    return /** @type {import(\"./coordinate.js\").Coordinate|undefined} */ (\n      this.get(Property.POSITION)\n    );\n  }\n\n  /**\n   * Get the projection associated with the position.\n   * @return {import(\"./proj/Projection.js\").default|undefined} The projection the position is\n   *     reported in.\n   * @observable\n   * @api\n   */\n  getProjection() {\n    return /** @type {import(\"./proj/Projection.js\").default|undefined} */ (\n      this.get(Property.PROJECTION)\n    );\n  }\n\n  /**\n   * Get the speed in meters per second.\n   * @return {number|undefined} The instantaneous speed of the device in meters\n   *     per second.\n   * @observable\n   * @api\n   */\n  getSpeed() {\n    return /** @type {number|undefined} */ (this.get(Property.SPEED));\n  }\n\n  /**\n   * Determine if the device location is being tracked.\n   * @return {boolean} The device location is being tracked.\n   * @observable\n   * @api\n   */\n  getTracking() {\n    return /** @type {boolean} */ (this.get(Property.TRACKING));\n  }\n\n  /**\n   * Get the tracking options.\n   * See https://www.w3.org/TR/geolocation-API/#position-options.\n   * @return {PositionOptions|undefined} PositionOptions as defined by\n   *     the [HTML5 Geolocation spec\n   *     ](https://www.w3.org/TR/geolocation-API/#position_options_interface).\n   * @observable\n   * @api\n   */\n  getTrackingOptions() {\n    return /** @type {PositionOptions|undefined} */ (\n      this.get(Property.TRACKING_OPTIONS)\n    );\n  }\n\n  /**\n   * Set the projection to use for transforming the coordinates.\n   * @param {import(\"./proj.js\").ProjectionLike} projection The projection the position is\n   *     reported in.\n   * @observable\n   * @api\n   */\n  setProjection(projection) {\n    this.set(Property.PROJECTION, getProjection(projection));\n  }\n\n  /**\n   * Enable or disable tracking.\n   * @param {boolean} tracking Enable tracking.\n   * @observable\n   * @api\n   */\n  setTracking(tracking) {\n    this.set(Property.TRACKING, tracking);\n  }\n\n  /**\n   * Set the tracking options.\n   * See http://www.w3.org/TR/geolocation-API/#position-options.\n   * @param {PositionOptions} options PositionOptions as defined by the\n   *     [HTML5 Geolocation spec\n   *     ](http://www.w3.org/TR/geolocation-API/#position_options_interface).\n   * @observable\n   * @api\n   */\n  setTrackingOptions(options) {\n    this.set(Property.TRACKING_OPTIONS, options);\n  }\n}\n\nexport default Geolocation;\n","import { View } from \"ol\";\n\nView.prototype.getDecimalZoom = function (this: View): number {\n  const resolution = this.getResolution();\n  const offset =\n    // NOTE: `resolution` maybe `undefined`\n    // NOTE: `offset` maybe `NaN`\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    Math.log(this.maxResolution_ / resolution!) / Math.log(2);\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return offset !== undefined ? this.minZoom_ + offset : offset;\n};\n\nexport { View };\n","/**\n * @module ol/renderer/canvas/TileLayer\n */\nimport CanvasLayerRenderer from './Layer.js';\nimport ImageTile from '../../ImageTile.js';\nimport ReprojTile from '../../reproj/Tile.js';\nimport TileRange from '../../TileRange.js';\nimport TileState from '../../TileState.js';\nimport {\n  apply as applyTransform,\n  compose as composeTransform,\n  makeInverse,\n  toString as toTransformString,\n} from '../../transform.js';\nimport {ascending} from '../../array.js';\nimport {\n  containsCoordinate,\n  createEmpty,\n  equals,\n  getHeight,\n  getIntersection,\n  getRotatedViewport,\n  getTopLeft,\n  getWidth,\n  intersects,\n} from '../../extent.js';\nimport {fromUserExtent} from '../../proj.js';\nimport {getUid} from '../../util.js';\nimport {toSize} from '../../size.js';\n\n/**\n * @classdesc\n * Canvas renderer for tile layers.\n * @api\n * @template {import(\"../../layer/Tile.js\").default<import(\"../../source/Tile.js\").default>|import(\"../../layer/VectorTile.js\").default} [LayerType=import(\"../../layer/Tile.js\").default<import(\"../../source/Tile.js\").default>|import(\"../../layer/VectorTile.js\").default]\n * @extends {CanvasLayerRenderer<LayerType>}\n */\nclass CanvasTileLayerRenderer extends CanvasLayerRenderer {\n  /**\n   * @param {LayerType} tileLayer Tile layer.\n   */\n  constructor(tileLayer) {\n    super(tileLayer);\n\n    /**\n     * Rendered extent has changed since the previous `renderFrame()` call\n     * @type {boolean}\n     */\n    this.extentChanged = true;\n\n    /**\n     * @private\n     * @type {?import(\"../../extent.js\").Extent}\n     */\n    this.renderedExtent_ = null;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.renderedPixelRatio;\n\n    /**\n     * @protected\n     * @type {import(\"../../proj/Projection.js\").default}\n     */\n    this.renderedProjection = null;\n\n    /**\n     * @protected\n     * @type {number}\n     */\n    this.renderedRevision;\n\n    /**\n     * @protected\n     * @type {!Array<import(\"../../Tile.js\").default>}\n     */\n    this.renderedTiles = [];\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this.newTiles_ = false;\n\n    /**\n     * @protected\n     * @type {import(\"../../extent.js\").Extent}\n     */\n    this.tmpExtent = createEmpty();\n\n    /**\n     * @private\n     * @type {import(\"../../TileRange.js\").default}\n     */\n    this.tmpTileRange_ = new TileRange(0, 0, 0, 0);\n  }\n\n  /**\n   * @protected\n   * @param {import(\"../../Tile.js\").default} tile Tile.\n   * @return {boolean} Tile is drawable.\n   */\n  isDrawableTile(tile) {\n    const tileLayer = this.getLayer();\n    const tileState = tile.getState();\n    const useInterimTilesOnError = tileLayer.getUseInterimTilesOnError();\n    return (\n      tileState == TileState.LOADED ||\n      tileState == TileState.EMPTY ||\n      (tileState == TileState.ERROR && !useInterimTilesOnError)\n    );\n  }\n\n  /**\n   * @param {number} z Tile coordinate z.\n   * @param {number} x Tile coordinate x.\n   * @param {number} y Tile coordinate y.\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @return {!import(\"../../Tile.js\").default} Tile.\n   */\n  getTile(z, x, y, frameState) {\n    const pixelRatio = frameState.pixelRatio;\n    const projection = frameState.viewState.projection;\n    const tileLayer = this.getLayer();\n    const tileSource = tileLayer.getSource();\n    let tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n    if (tile.getState() == TileState.ERROR) {\n      if (tileLayer.getUseInterimTilesOnError() && tileLayer.getPreload() > 0) {\n        // Preloaded tiles for lower resolutions might have finished loading.\n        this.newTiles_ = true;\n      }\n    }\n    if (!this.isDrawableTile(tile)) {\n      tile = tile.getInterimTile();\n    }\n    return tile;\n  }\n\n  /**\n   * @param {import(\"../../pixel.js\").Pixel} pixel Pixel.\n   * @return {Uint8ClampedArray} Data at the pixel location.\n   */\n  getData(pixel) {\n    const frameState = this.frameState;\n    if (!frameState) {\n      return null;\n    }\n\n    const layer = this.getLayer();\n    const coordinate = applyTransform(\n      frameState.pixelToCoordinateTransform,\n      pixel.slice()\n    );\n\n    const layerExtent = layer.getExtent();\n    if (layerExtent) {\n      if (!containsCoordinate(layerExtent, coordinate)) {\n        return null;\n      }\n    }\n\n    const pixelRatio = frameState.pixelRatio;\n    const projection = frameState.viewState.projection;\n    const viewState = frameState.viewState;\n    const source = layer.getRenderSource();\n    const tileGrid = source.getTileGridForProjection(viewState.projection);\n    const tilePixelRatio = source.getTilePixelRatio(frameState.pixelRatio);\n\n    for (\n      let z = tileGrid.getZForResolution(viewState.resolution);\n      z >= tileGrid.getMinZoom();\n      --z\n    ) {\n      const tileCoord = tileGrid.getTileCoordForCoordAndZ(coordinate, z);\n      const tile = source.getTile(\n        z,\n        tileCoord[1],\n        tileCoord[2],\n        pixelRatio,\n        projection\n      );\n      if (\n        !(tile instanceof ImageTile || tile instanceof ReprojTile) ||\n        (tile instanceof ReprojTile && tile.getState() === TileState.EMPTY)\n      ) {\n        return null;\n      }\n\n      if (tile.getState() !== TileState.LOADED) {\n        continue;\n      }\n\n      const tileOrigin = tileGrid.getOrigin(z);\n      const tileSize = toSize(tileGrid.getTileSize(z));\n      const tileResolution = tileGrid.getResolution(z);\n\n      const col = Math.floor(\n        tilePixelRatio *\n          ((coordinate[0] - tileOrigin[0]) / tileResolution -\n            tileCoord[1] * tileSize[0])\n      );\n\n      const row = Math.floor(\n        tilePixelRatio *\n          ((tileOrigin[1] - coordinate[1]) / tileResolution -\n            tileCoord[2] * tileSize[1])\n      );\n\n      const gutter = Math.round(\n        tilePixelRatio * source.getGutterForProjection(viewState.projection)\n      );\n\n      return this.getImageData(tile.getImage(), col + gutter, row + gutter);\n    }\n\n    return null;\n  }\n\n  /**\n   * @param {Object<number, Object<string, import(\"../../Tile.js\").default>>} tiles Lookup of loaded tiles by zoom level.\n   * @param {number} zoom Zoom level.\n   * @param {import(\"../../Tile.js\").default} tile Tile.\n   * @return {boolean|void} If `false`, the tile will not be considered loaded.\n   */\n  loadedTileCallback(tiles, zoom, tile) {\n    if (this.isDrawableTile(tile)) {\n      return super.loadedTileCallback(tiles, zoom, tile);\n    }\n    return false;\n  }\n\n  /**\n   * Determine whether render should be called.\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @return {boolean} Layer is ready to be rendered.\n   */\n  prepareFrame(frameState) {\n    return !!this.getLayer().getSource();\n  }\n\n  /**\n   * Render the layer.\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @param {HTMLElement} target Target that may be used to render content to.\n   * @return {HTMLElement} The rendered element.\n   */\n  renderFrame(frameState, target) {\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n    const viewState = frameState.viewState;\n    const projection = viewState.projection;\n    const viewResolution = viewState.resolution;\n    const viewCenter = viewState.center;\n    const rotation = viewState.rotation;\n    const pixelRatio = frameState.pixelRatio;\n\n    const tileLayer = this.getLayer();\n    const tileSource = tileLayer.getSource();\n    const sourceRevision = tileSource.getRevision();\n    const tileGrid = tileSource.getTileGridForProjection(projection);\n    const z = tileGrid.getZForResolution(viewResolution, tileSource.zDirection);\n    const tileResolution = tileGrid.getResolution(z);\n\n    let extent = frameState.extent;\n    const resolution = frameState.viewState.resolution;\n    const tilePixelRatio = tileSource.getTilePixelRatio(pixelRatio);\n    // desired dimensions of the canvas in pixels\n    const width = Math.round((getWidth(extent) / resolution) * pixelRatio);\n    const height = Math.round((getHeight(extent) / resolution) * pixelRatio);\n\n    const layerExtent =\n      layerState.extent && fromUserExtent(layerState.extent, projection);\n    if (layerExtent) {\n      extent = getIntersection(\n        extent,\n        fromUserExtent(layerState.extent, projection)\n      );\n    }\n\n    const dx = (tileResolution * width) / 2 / tilePixelRatio;\n    const dy = (tileResolution * height) / 2 / tilePixelRatio;\n    const canvasExtent = [\n      viewCenter[0] - dx,\n      viewCenter[1] - dy,\n      viewCenter[0] + dx,\n      viewCenter[1] + dy,\n    ];\n\n    const tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z);\n\n    /**\n     * @type {Object<number, Object<string, import(\"../../Tile.js\").default>>}\n     */\n    const tilesToDrawByZ = {};\n    tilesToDrawByZ[z] = {};\n\n    const findLoadedTiles = this.createLoadedTileFinder(\n      tileSource,\n      projection,\n      tilesToDrawByZ\n    );\n\n    const tmpExtent = this.tmpExtent;\n    const tmpTileRange = this.tmpTileRange_;\n    this.newTiles_ = false;\n    const viewport = rotation\n      ? getRotatedViewport(\n          viewState.center,\n          resolution,\n          rotation,\n          frameState.size\n        )\n      : undefined;\n    for (let x = tileRange.minX; x <= tileRange.maxX; ++x) {\n      for (let y = tileRange.minY; y <= tileRange.maxY; ++y) {\n        if (\n          rotation &&\n          !tileGrid.tileCoordIntersectsViewport([z, x, y], viewport)\n        ) {\n          continue;\n        }\n        const tile = this.getTile(z, x, y, frameState);\n        if (this.isDrawableTile(tile)) {\n          const uid = getUid(this);\n          if (tile.getState() == TileState.LOADED) {\n            tilesToDrawByZ[z][tile.tileCoord.toString()] = tile;\n            let inTransition = tile.inTransition(uid);\n            if (inTransition && layerState.opacity !== 1) {\n              // Skipping transition when layer is not fully opaque avoids visual artifacts.\n              tile.endTransition(uid);\n              inTransition = false;\n            }\n            if (\n              !this.newTiles_ &&\n              (inTransition || !this.renderedTiles.includes(tile))\n            ) {\n              this.newTiles_ = true;\n            }\n          }\n          if (tile.getAlpha(uid, frameState.time) === 1) {\n            // don't look for alt tiles if alpha is 1\n            continue;\n          }\n        }\n\n        const childTileRange = tileGrid.getTileCoordChildTileRange(\n          tile.tileCoord,\n          tmpTileRange,\n          tmpExtent\n        );\n\n        let covered = false;\n        if (childTileRange) {\n          covered = findLoadedTiles(z + 1, childTileRange);\n        }\n        if (!covered) {\n          tileGrid.forEachTileCoordParentTileRange(\n            tile.tileCoord,\n            findLoadedTiles,\n            tmpTileRange,\n            tmpExtent\n          );\n        }\n      }\n    }\n\n    const canvasScale =\n      ((tileResolution / viewResolution) * pixelRatio) / tilePixelRatio;\n\n    // set forward and inverse pixel transforms\n    composeTransform(\n      this.pixelTransform,\n      frameState.size[0] / 2,\n      frameState.size[1] / 2,\n      1 / pixelRatio,\n      1 / pixelRatio,\n      rotation,\n      -width / 2,\n      -height / 2\n    );\n\n    const canvasTransform = toTransformString(this.pixelTransform);\n\n    this.useContainer(target, canvasTransform, this.getBackground(frameState));\n    const context = this.context;\n    const canvas = context.canvas;\n\n    makeInverse(this.inversePixelTransform, this.pixelTransform);\n\n    // set scale transform for calculating tile positions on the canvas\n    composeTransform(\n      this.tempTransform,\n      width / 2,\n      height / 2,\n      canvasScale,\n      canvasScale,\n      0,\n      -width / 2,\n      -height / 2\n    );\n\n    if (canvas.width != width || canvas.height != height) {\n      canvas.width = width;\n      canvas.height = height;\n    } else if (!this.containerReused) {\n      context.clearRect(0, 0, width, height);\n    }\n\n    if (layerExtent) {\n      this.clipUnrotated(context, frameState, layerExtent);\n    }\n\n    if (!tileSource.getInterpolate()) {\n      context.imageSmoothingEnabled = false;\n    }\n\n    this.preRender(context, frameState);\n\n    this.renderedTiles.length = 0;\n    /** @type {Array<number>} */\n    let zs = Object.keys(tilesToDrawByZ).map(Number);\n    zs.sort(ascending);\n\n    let clips, clipZs, currentClip;\n    if (\n      layerState.opacity === 1 &&\n      (!this.containerReused ||\n        tileSource.getOpaque(frameState.viewState.projection))\n    ) {\n      zs = zs.reverse();\n    } else {\n      clips = [];\n      clipZs = [];\n    }\n    for (let i = zs.length - 1; i >= 0; --i) {\n      const currentZ = zs[i];\n      const currentTilePixelSize = tileSource.getTilePixelSize(\n        currentZ,\n        pixelRatio,\n        projection\n      );\n      const currentResolution = tileGrid.getResolution(currentZ);\n      const currentScale = currentResolution / tileResolution;\n      const dx = currentTilePixelSize[0] * currentScale * canvasScale;\n      const dy = currentTilePixelSize[1] * currentScale * canvasScale;\n      const originTileCoord = tileGrid.getTileCoordForCoordAndZ(\n        getTopLeft(canvasExtent),\n        currentZ\n      );\n      const originTileExtent = tileGrid.getTileCoordExtent(originTileCoord);\n      const origin = applyTransform(this.tempTransform, [\n        (tilePixelRatio * (originTileExtent[0] - canvasExtent[0])) /\n          tileResolution,\n        (tilePixelRatio * (canvasExtent[3] - originTileExtent[3])) /\n          tileResolution,\n      ]);\n      const tileGutter =\n        tilePixelRatio * tileSource.getGutterForProjection(projection);\n      const tilesToDraw = tilesToDrawByZ[currentZ];\n      for (const tileCoordKey in tilesToDraw) {\n        const tile = /** @type {import(\"../../ImageTile.js\").default} */ (\n          tilesToDraw[tileCoordKey]\n        );\n        const tileCoord = tile.tileCoord;\n\n        // Calculate integer positions and sizes so that tiles align\n        const xIndex = originTileCoord[1] - tileCoord[1];\n        const nextX = Math.round(origin[0] - (xIndex - 1) * dx);\n        const yIndex = originTileCoord[2] - tileCoord[2];\n        const nextY = Math.round(origin[1] - (yIndex - 1) * dy);\n        const x = Math.round(origin[0] - xIndex * dx);\n        const y = Math.round(origin[1] - yIndex * dy);\n        const w = nextX - x;\n        const h = nextY - y;\n        const transition = z === currentZ;\n\n        const inTransition =\n          transition && tile.getAlpha(getUid(this), frameState.time) !== 1;\n        let contextSaved = false;\n        if (!inTransition) {\n          if (clips) {\n            // Clip mask for regions in this tile that already filled by a higher z tile\n            currentClip = [x, y, x + w, y, x + w, y + h, x, y + h];\n            for (let i = 0, ii = clips.length; i < ii; ++i) {\n              if (z !== currentZ && currentZ < clipZs[i]) {\n                const clip = clips[i];\n                if (\n                  intersects(\n                    [x, y, x + w, y + h],\n                    [clip[0], clip[3], clip[4], clip[7]]\n                  )\n                ) {\n                  if (!contextSaved) {\n                    context.save();\n                    contextSaved = true;\n                  }\n                  context.beginPath();\n                  // counter-clockwise (outer ring) for current tile\n                  context.moveTo(currentClip[0], currentClip[1]);\n                  context.lineTo(currentClip[2], currentClip[3]);\n                  context.lineTo(currentClip[4], currentClip[5]);\n                  context.lineTo(currentClip[6], currentClip[7]);\n                  // clockwise (inner ring) for higher z tile\n                  context.moveTo(clip[6], clip[7]);\n                  context.lineTo(clip[4], clip[5]);\n                  context.lineTo(clip[2], clip[3]);\n                  context.lineTo(clip[0], clip[1]);\n                  context.clip();\n                }\n              }\n            }\n            clips.push(currentClip);\n            clipZs.push(currentZ);\n          } else {\n            context.clearRect(x, y, w, h);\n          }\n        }\n        this.drawTileImage(\n          tile,\n          frameState,\n          x,\n          y,\n          w,\n          h,\n          tileGutter,\n          transition\n        );\n        if (clips && !inTransition) {\n          if (contextSaved) {\n            context.restore();\n          }\n          this.renderedTiles.unshift(tile);\n        } else {\n          this.renderedTiles.push(tile);\n        }\n        this.updateUsedTiles(frameState.usedTiles, tileSource, tile);\n      }\n    }\n\n    this.renderedRevision = sourceRevision;\n    this.renderedResolution = tileResolution;\n    this.extentChanged =\n      !this.renderedExtent_ || !equals(this.renderedExtent_, canvasExtent);\n    this.renderedExtent_ = canvasExtent;\n    this.renderedPixelRatio = pixelRatio;\n    this.renderedProjection = projection;\n\n    this.manageTilePyramid(\n      frameState,\n      tileSource,\n      tileGrid,\n      pixelRatio,\n      projection,\n      extent,\n      z,\n      tileLayer.getPreload()\n    );\n    this.scheduleExpireCache(frameState, tileSource);\n\n    this.postRender(context, frameState);\n\n    if (layerState.extent) {\n      context.restore();\n    }\n    context.imageSmoothingEnabled = true;\n\n    if (canvasTransform !== canvas.style.transform) {\n      canvas.style.transform = canvasTransform;\n    }\n\n    return this.container;\n  }\n\n  /**\n   * @param {import(\"../../ImageTile.js\").default} tile Tile.\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @param {number} x Left of the tile.\n   * @param {number} y Top of the tile.\n   * @param {number} w Width of the tile.\n   * @param {number} h Height of the tile.\n   * @param {number} gutter Tile gutter.\n   * @param {boolean} transition Apply an alpha transition.\n   */\n  drawTileImage(tile, frameState, x, y, w, h, gutter, transition) {\n    const image = this.getTileImage(tile);\n    if (!image) {\n      return;\n    }\n    const uid = getUid(this);\n    const layerState = frameState.layerStatesArray[frameState.layerIndex];\n    const alpha =\n      layerState.opacity *\n      (transition ? tile.getAlpha(uid, frameState.time) : 1);\n    const alphaChanged = alpha !== this.context.globalAlpha;\n    if (alphaChanged) {\n      this.context.save();\n      this.context.globalAlpha = alpha;\n    }\n    this.context.drawImage(\n      image,\n      gutter,\n      gutter,\n      image.width - 2 * gutter,\n      image.height - 2 * gutter,\n      x,\n      y,\n      w,\n      h\n    );\n\n    if (alphaChanged) {\n      this.context.restore();\n    }\n    if (alpha !== layerState.opacity) {\n      frameState.animate = true;\n    } else if (transition) {\n      tile.endTransition(uid);\n    }\n  }\n\n  /**\n   * @return {HTMLCanvasElement} Image\n   */\n  getImage() {\n    const context = this.context;\n    return context ? context.canvas : null;\n  }\n\n  /**\n   * Get the image from a tile.\n   * @param {import(\"../../ImageTile.js\").default} tile Tile.\n   * @return {HTMLCanvasElement|HTMLImageElement|HTMLVideoElement} Image.\n   * @protected\n   */\n  getTileImage(tile) {\n    return tile.getImage();\n  }\n\n  /**\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n   * @protected\n   */\n  scheduleExpireCache(frameState, tileSource) {\n    if (tileSource.canExpireCache()) {\n      /**\n       * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n       * @param {import(\"../../Map.js\").default} map Map.\n       * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n       */\n      const postRenderFunction = function (tileSource, map, frameState) {\n        const tileSourceKey = getUid(tileSource);\n        if (tileSourceKey in frameState.usedTiles) {\n          tileSource.expireCache(\n            frameState.viewState.projection,\n            frameState.usedTiles[tileSourceKey]\n          );\n        }\n      }.bind(null, tileSource);\n\n      frameState.postRenderFunctions.push(\n        /** @type {import(\"../../Map.js\").PostRenderFunction} */ (\n          postRenderFunction\n        )\n      );\n    }\n  }\n\n  /**\n   * @param {!Object<string, !Object<string, boolean>>} usedTiles Used tiles.\n   * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n   * @param {import('../../Tile.js').default} tile Tile.\n   * @protected\n   */\n  updateUsedTiles(usedTiles, tileSource, tile) {\n    // FIXME should we use tilesToDrawByZ instead?\n    const tileSourceKey = getUid(tileSource);\n    if (!(tileSourceKey in usedTiles)) {\n      usedTiles[tileSourceKey] = {};\n    }\n    usedTiles[tileSourceKey][tile.getKey()] = true;\n  }\n\n  /**\n   * Manage tile pyramid.\n   * This function performs a number of functions related to the tiles at the\n   * current zoom and lower zoom levels:\n   * - registers idle tiles in frameState.wantedTiles so that they are not\n   *   discarded by the tile queue\n   * - enqueues missing tiles\n   * @param {import(\"../../Map.js\").FrameState} frameState Frame state.\n   * @param {import(\"../../source/Tile.js\").default} tileSource Tile source.\n   * @param {import(\"../../tilegrid/TileGrid.js\").default} tileGrid Tile grid.\n   * @param {number} pixelRatio Pixel ratio.\n   * @param {import(\"../../proj/Projection.js\").default} projection Projection.\n   * @param {import(\"../../extent.js\").Extent} extent Extent.\n   * @param {number} currentZ Current Z.\n   * @param {number} preload Load low resolution tiles up to `preload` levels.\n   * @param {function(import(\"../../Tile.js\").default):void} [tileCallback] Tile callback.\n   * @protected\n   */\n  manageTilePyramid(\n    frameState,\n    tileSource,\n    tileGrid,\n    pixelRatio,\n    projection,\n    extent,\n    currentZ,\n    preload,\n    tileCallback\n  ) {\n    const tileSourceKey = getUid(tileSource);\n    if (!(tileSourceKey in frameState.wantedTiles)) {\n      frameState.wantedTiles[tileSourceKey] = {};\n    }\n    const wantedTiles = frameState.wantedTiles[tileSourceKey];\n    const tileQueue = frameState.tileQueue;\n    const minZoom = tileGrid.getMinZoom();\n    const rotation = frameState.viewState.rotation;\n    const viewport = rotation\n      ? getRotatedViewport(\n          frameState.viewState.center,\n          frameState.viewState.resolution,\n          rotation,\n          frameState.size\n        )\n      : undefined;\n    let tileCount = 0;\n    let tile, tileRange, tileResolution, x, y, z;\n    for (z = minZoom; z <= currentZ; ++z) {\n      tileRange = tileGrid.getTileRangeForExtentAndZ(extent, z, tileRange);\n      tileResolution = tileGrid.getResolution(z);\n      for (x = tileRange.minX; x <= tileRange.maxX; ++x) {\n        for (y = tileRange.minY; y <= tileRange.maxY; ++y) {\n          if (\n            rotation &&\n            !tileGrid.tileCoordIntersectsViewport([z, x, y], viewport)\n          ) {\n            continue;\n          }\n          if (currentZ - z <= preload) {\n            ++tileCount;\n            tile = tileSource.getTile(z, x, y, pixelRatio, projection);\n            if (tile.getState() == TileState.IDLE) {\n              wantedTiles[tile.getKey()] = true;\n              if (!tileQueue.isKeyQueued(tile.getKey())) {\n                tileQueue.enqueue([\n                  tile,\n                  tileSourceKey,\n                  tileGrid.getTileCoordCenter(tile.tileCoord),\n                  tileResolution,\n                ]);\n              }\n            }\n            if (tileCallback !== undefined) {\n              tileCallback(tile);\n            }\n          } else {\n            tileSource.useTile(z, x, y, projection);\n          }\n        }\n      }\n    }\n    tileSource.updateCacheSize(tileCount, projection);\n  }\n}\n\nexport default CanvasTileLayerRenderer;\n","/**\n * @module ol/layer/Tile\n */\nimport BaseTileLayer from './BaseTile.js';\nimport CanvasTileLayerRenderer from '../renderer/canvas/TileLayer.js';\n\n/**\n * @classdesc\n * For layer sources that provide pre-rendered, tiled images in grids that are\n * organized by zoom levels for specific resolutions.\n * Note that any property set in the options is set as a {@link module:ol/Object~BaseObject}\n * property on the layer object; for example, setting `title: 'My Title'` in the\n * options means that `title` is observable, and has get/set accessors.\n *\n * @template {import(\"../source/Tile.js\").default} TileSourceType\n * @extends BaseTileLayer<TileSourceType, CanvasTileLayerRenderer>\n * @api\n */\nclass TileLayer extends BaseTileLayer {\n  /**\n   * @param {import(\"./BaseTile.js\").Options<TileSourceType>} [options] Tile layer options.\n   */\n  constructor(options) {\n    super(options);\n  }\n\n  createRenderer() {\n    return new CanvasTileLayerRenderer(this);\n  }\n}\n\nexport default TileLayer;\n","/**\n * @module ol/geom/Circle\n */\nimport SimpleGeometry from './SimpleGeometry.js';\nimport {createOrUpdate, forEachCorner, intersects} from '../extent.js';\nimport {deflateCoordinate} from './flat/deflate.js';\nimport {rotate} from './flat/transform.js';\n\n/**\n * @classdesc\n * Circle geometry.\n *\n * @api\n */\nclass Circle extends SimpleGeometry {\n  /**\n   * @param {!import(\"../coordinate.js\").Coordinate} center Center.\n   *     For internal use, flat coordinates in combination with `layout` and no\n   *     `radius` are also accepted.\n   * @param {number} [radius] Radius in units of the projection.\n   * @param {import(\"./Geometry.js\").GeometryLayout} [layout] Layout.\n   */\n  constructor(center, radius, layout) {\n    super();\n    if (layout !== undefined && radius === undefined) {\n      this.setFlatCoordinates(layout, center);\n    } else {\n      radius = radius ? radius : 0;\n      this.setCenterAndRadius(center, radius, layout);\n    }\n  }\n\n  /**\n   * Make a complete copy of the geometry.\n   * @return {!Circle} Clone.\n   * @api\n   */\n  clone() {\n    const circle = new Circle(\n      this.flatCoordinates.slice(),\n      undefined,\n      this.layout\n    );\n    circle.applyProperties(this);\n    return circle;\n  }\n\n  /**\n   * @param {number} x X.\n   * @param {number} y Y.\n   * @param {import(\"../coordinate.js\").Coordinate} closestPoint Closest point.\n   * @param {number} minSquaredDistance Minimum squared distance.\n   * @return {number} Minimum squared distance.\n   */\n  closestPointXY(x, y, closestPoint, minSquaredDistance) {\n    const flatCoordinates = this.flatCoordinates;\n    const dx = x - flatCoordinates[0];\n    const dy = y - flatCoordinates[1];\n    const squaredDistance = dx * dx + dy * dy;\n    if (squaredDistance < minSquaredDistance) {\n      if (squaredDistance === 0) {\n        for (let i = 0; i < this.stride; ++i) {\n          closestPoint[i] = flatCoordinates[i];\n        }\n      } else {\n        const delta = this.getRadius() / Math.sqrt(squaredDistance);\n        closestPoint[0] = flatCoordinates[0] + delta * dx;\n        closestPoint[1] = flatCoordinates[1] + delta * dy;\n        for (let i = 2; i < this.stride; ++i) {\n          closestPoint[i] = flatCoordinates[i];\n        }\n      }\n      closestPoint.length = this.stride;\n      return squaredDistance;\n    }\n    return minSquaredDistance;\n  }\n\n  /**\n   * @param {number} x X.\n   * @param {number} y Y.\n   * @return {boolean} Contains (x, y).\n   */\n  containsXY(x, y) {\n    const flatCoordinates = this.flatCoordinates;\n    const dx = x - flatCoordinates[0];\n    const dy = y - flatCoordinates[1];\n    return dx * dx + dy * dy <= this.getRadiusSquared_();\n  }\n\n  /**\n   * Return the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n   * @return {import(\"../coordinate.js\").Coordinate} Center.\n   * @api\n   */\n  getCenter() {\n    return this.flatCoordinates.slice(0, this.stride);\n  }\n\n  /**\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @protected\n   * @return {import(\"../extent.js\").Extent} extent Extent.\n   */\n  computeExtent(extent) {\n    const flatCoordinates = this.flatCoordinates;\n    const radius = flatCoordinates[this.stride] - flatCoordinates[0];\n    return createOrUpdate(\n      flatCoordinates[0] - radius,\n      flatCoordinates[1] - radius,\n      flatCoordinates[0] + radius,\n      flatCoordinates[1] + radius,\n      extent\n    );\n  }\n\n  /**\n   * Return the radius of the circle.\n   * @return {number} Radius.\n   * @api\n   */\n  getRadius() {\n    return Math.sqrt(this.getRadiusSquared_());\n  }\n\n  /**\n   * @private\n   * @return {number} Radius squared.\n   */\n  getRadiusSquared_() {\n    const dx = this.flatCoordinates[this.stride] - this.flatCoordinates[0];\n    const dy = this.flatCoordinates[this.stride + 1] - this.flatCoordinates[1];\n    return dx * dx + dy * dy;\n  }\n\n  /**\n   * Get the type of this geometry.\n   * @return {import(\"./Geometry.js\").Type} Geometry type.\n   * @api\n   */\n  getType() {\n    return 'Circle';\n  }\n\n  /**\n   * Test if the geometry and the passed extent intersect.\n   * @param {import(\"../extent.js\").Extent} extent Extent.\n   * @return {boolean} `true` if the geometry and the extent intersect.\n   * @api\n   */\n  intersectsExtent(extent) {\n    const circleExtent = this.getExtent();\n    if (intersects(extent, circleExtent)) {\n      const center = this.getCenter();\n\n      if (extent[0] <= center[0] && extent[2] >= center[0]) {\n        return true;\n      }\n      if (extent[1] <= center[1] && extent[3] >= center[1]) {\n        return true;\n      }\n\n      return forEachCorner(extent, this.intersectsCoordinate.bind(this));\n    }\n    return false;\n  }\n\n  /**\n   * Set the center of the circle as {@link module:ol/coordinate~Coordinate coordinate}.\n   * @param {import(\"../coordinate.js\").Coordinate} center Center.\n   * @api\n   */\n  setCenter(center) {\n    const stride = this.stride;\n    const radius = this.flatCoordinates[stride] - this.flatCoordinates[0];\n    const flatCoordinates = center.slice();\n    flatCoordinates[stride] = flatCoordinates[0] + radius;\n    for (let i = 1; i < stride; ++i) {\n      flatCoordinates[stride + i] = center[i];\n    }\n    this.setFlatCoordinates(this.layout, flatCoordinates);\n    this.changed();\n  }\n\n  /**\n   * Set the center (as {@link module:ol/coordinate~Coordinate coordinate}) and the radius (as\n   * number) of the circle.\n   * @param {!import(\"../coordinate.js\").Coordinate} center Center.\n   * @param {number} radius Radius.\n   * @param {import(\"./Geometry.js\").GeometryLayout} [layout] Layout.\n   * @api\n   */\n  setCenterAndRadius(center, radius, layout) {\n    this.setLayout(layout, center, 0);\n    if (!this.flatCoordinates) {\n      this.flatCoordinates = [];\n    }\n    /** @type {Array<number>} */\n    const flatCoordinates = this.flatCoordinates;\n    let offset = deflateCoordinate(flatCoordinates, 0, center, this.stride);\n    flatCoordinates[offset++] = flatCoordinates[0] + radius;\n    for (let i = 1, ii = this.stride; i < ii; ++i) {\n      flatCoordinates[offset++] = flatCoordinates[i];\n    }\n    flatCoordinates.length = offset;\n    this.changed();\n  }\n\n  getCoordinates() {\n    return null;\n  }\n\n  setCoordinates(coordinates, layout) {}\n\n  /**\n   * Set the radius of the circle. The radius is in the units of the projection.\n   * @param {number} radius Radius.\n   * @api\n   */\n  setRadius(radius) {\n    this.flatCoordinates[this.stride] = this.flatCoordinates[0] + radius;\n    this.changed();\n  }\n\n  /**\n   * Rotate the geometry around a given coordinate. This modifies the geometry\n   * coordinates in place.\n   * @param {number} angle Rotation angle in counter-clockwise radians.\n   * @param {import(\"../coordinate.js\").Coordinate} anchor The rotation center.\n   * @api\n   */\n  rotate(angle, anchor) {\n    const center = this.getCenter();\n    const stride = this.getStride();\n    this.setCenter(\n      rotate(center, 0, center.length, stride, angle, anchor, center)\n    );\n    this.changed();\n  }\n}\n\n/**\n * Transform each coordinate of the circle from one coordinate reference system\n * to another. The geometry is modified in place.\n * If you do not want the geometry modified in place, first clone() it and\n * then use this function on the clone.\n *\n * Internally a circle is currently represented by two points: the center of\n * the circle `[cx, cy]`, and the point to the right of the circle\n * `[cx + r, cy]`. This `transform` function just transforms these two points.\n * So the resulting geometry is also a circle, and that circle does not\n * correspond to the shape that would be obtained by transforming every point\n * of the original circle.\n *\n * @param {import(\"../proj.js\").ProjectionLike} source The current projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @param {import(\"../proj.js\").ProjectionLike} destination The desired projection.  Can be a\n *     string identifier or a {@link module:ol/proj/Projection~Projection} object.\n * @return {Circle} This geometry.  Note that original geometry is\n *     modified in place.\n * @function\n * @api\n */\nCircle.prototype.transform;\nexport default Circle;\n","/**\n * @module ol/source/OSM\n */\n\nimport XYZ from './XYZ.js';\n\n/**\n * The attribution containing a link to the OpenStreetMap Copyright and License\n * page.\n * @const\n * @type {string}\n * @api\n */\nexport const ATTRIBUTION =\n  '&#169; ' +\n  '<a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> ' +\n  'contributors.';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"./Source.js\").AttributionLike} [attributions] Attributions.\n * @property {number} [cacheSize] Initial tile cache size. Will auto-grow to hold at least the number of tiles in the viewport.\n * @property {null|string} [crossOrigin='anonymous'] The `crossOrigin` attribute for loaded images.  Note that\n * you must provide a `crossOrigin` value if you want to access pixel data with the Canvas renderer.\n * See https://developer.mozilla.org/en-US/docs/Web/HTML/CORS_enabled_image for more detail.\n * @property {boolean} [interpolate=true] Use interpolated values when resampling.  By default,\n * linear interpolation is used when resampling.  Set to false to use the nearest neighbor instead.\n * @property {number} [maxZoom=19] Max zoom.\n * @property {boolean} [opaque=true] Whether the layer is opaque.\n * @property {number} [reprojectionErrorThreshold=0.5] Maximum allowed reprojection error (in pixels).\n * Higher values can increase reprojection performance, but decrease precision.\n * @property {import(\"../Tile.js\").LoadFunction} [tileLoadFunction] Optional function to load a tile given a URL. The default is\n * ```js\n * function(imageTile, src) {\n *   imageTile.getImage().src = src;\n * };\n * ```\n * @property {number} [transition=250] Duration of the opacity transition for rendering.\n * To disable the opacity transition, pass `transition: 0`.\n * @property {string} [url='https://tile.openstreetmap.org/{z}/{x}/{y}.png'] URL template.\n * Must include `{x}`, `{y}` or `{-y}`, and `{z}` placeholders.\n * @property {boolean} [wrapX=true] Whether to wrap the world horizontally.\n * @property {number|import(\"../array.js\").NearestDirectionFunction} [zDirection=0]\n * Choose whether to use tiles with a higher or lower zoom level when between integer\n * zoom levels. See {@link module:ol/tilegrid/TileGrid~TileGrid#getZForResolution}.\n */\n\n/**\n * @classdesc\n * Layer source for the OpenStreetMap tile server.\n * @api\n */\nclass OSM extends XYZ {\n  /**\n   * @param {Options} [options] Open Street Map options.\n   */\n  constructor(options) {\n    options = options || {};\n\n    let attributions;\n    if (options.attributions !== undefined) {\n      attributions = options.attributions;\n    } else {\n      attributions = [ATTRIBUTION];\n    }\n\n    const crossOrigin =\n      options.crossOrigin !== undefined ? options.crossOrigin : 'anonymous';\n\n    const url =\n      options.url !== undefined\n        ? options.url\n        : 'https://tile.openstreetmap.org/{z}/{x}/{y}.png';\n\n    super({\n      attributions: attributions,\n      attributionsCollapsible: false,\n      cacheSize: options.cacheSize,\n      crossOrigin: crossOrigin,\n      interpolate: options.interpolate,\n      maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,\n      opaque: options.opaque !== undefined ? options.opaque : true,\n      reprojectionErrorThreshold: options.reprojectionErrorThreshold,\n      tileLoadFunction: options.tileLoadFunction,\n      transition: options.transition,\n      url: url,\n      wrapX: options.wrapX,\n      zDirection: options.zDirection,\n    });\n  }\n}\n\nexport default OSM;\n","import { getCoord, getGeom } from \"@turf/invariant\";\n// http://en.wikipedia.org/wiki/Even%E2%80%93odd_rule\n// modified from: https://github.com/substack/point-in-polygon/blob/master/index.js\n// which was modified from http://www.ecse.rpi.edu/Homepages/wrf/Research/Short_Notes/pnpoly.html\n/**\n * Takes a {@link Point} and a {@link Polygon} or {@link MultiPolygon} and determines if the point\n * resides inside the polygon. The polygon can be convex or concave. The function accounts for holes.\n *\n * @name booleanPointInPolygon\n * @param {Coord} point input point\n * @param {Feature<Polygon|MultiPolygon>} polygon input polygon or multipolygon\n * @param {Object} [options={}] Optional parameters\n * @param {boolean} [options.ignoreBoundary=false] True if polygon boundary should be ignored when determining if\n * the point is inside the polygon otherwise false.\n * @returns {boolean} `true` if the Point is inside the Polygon; `false` if the Point is not inside the Polygon\n * @example\n * var pt = turf.point([-77, 44]);\n * var poly = turf.polygon([[\n *   [-81, 41],\n *   [-81, 47],\n *   [-72, 47],\n *   [-72, 41],\n *   [-81, 41]\n * ]]);\n *\n * turf.booleanPointInPolygon(pt, poly);\n * //= true\n */\nexport default function booleanPointInPolygon(point, polygon, options) {\n    if (options === void 0) { options = {}; }\n    // validation\n    if (!point) {\n        throw new Error(\"point is required\");\n    }\n    if (!polygon) {\n        throw new Error(\"polygon is required\");\n    }\n    var pt = getCoord(point);\n    var geom = getGeom(polygon);\n    var type = geom.type;\n    var bbox = polygon.bbox;\n    var polys = geom.coordinates;\n    // Quick elimination if point is not inside bbox\n    if (bbox && inBBox(pt, bbox) === false) {\n        return false;\n    }\n    // normalize to multipolygon\n    if (type === \"Polygon\") {\n        polys = [polys];\n    }\n    var insidePoly = false;\n    for (var i = 0; i < polys.length && !insidePoly; i++) {\n        // check if it is in the outer ring first\n        if (inRing(pt, polys[i][0], options.ignoreBoundary)) {\n            var inHole = false;\n            var k = 1;\n            // check for the point in any of the holes\n            while (k < polys[i].length && !inHole) {\n                if (inRing(pt, polys[i][k], !options.ignoreBoundary)) {\n                    inHole = true;\n                }\n                k++;\n            }\n            if (!inHole) {\n                insidePoly = true;\n            }\n        }\n    }\n    return insidePoly;\n}\n/**\n * inRing\n *\n * @private\n * @param {Array<number>} pt [x,y]\n * @param {Array<Array<number>>} ring [[x,y], [x,y],..]\n * @param {boolean} ignoreBoundary ignoreBoundary\n * @returns {boolean} inRing\n */\nfunction inRing(pt, ring, ignoreBoundary) {\n    var isInside = false;\n    if (ring[0][0] === ring[ring.length - 1][0] &&\n        ring[0][1] === ring[ring.length - 1][1]) {\n        ring = ring.slice(0, ring.length - 1);\n    }\n    for (var i = 0, j = ring.length - 1; i < ring.length; j = i++) {\n        var xi = ring[i][0];\n        var yi = ring[i][1];\n        var xj = ring[j][0];\n        var yj = ring[j][1];\n        var onBoundary = pt[1] * (xi - xj) + yi * (xj - pt[0]) + yj * (pt[0] - xi) === 0 &&\n            (xi - pt[0]) * (xj - pt[0]) <= 0 &&\n            (yi - pt[1]) * (yj - pt[1]) <= 0;\n        if (onBoundary) {\n            return !ignoreBoundary;\n        }\n        var intersect = yi > pt[1] !== yj > pt[1] &&\n            pt[0] < ((xj - xi) * (pt[1] - yi)) / (yj - yi) + xi;\n        if (intersect) {\n            isInside = !isInside;\n        }\n    }\n    return isInside;\n}\n/**\n * inBBox\n *\n * @private\n * @param {Position} pt point [x,y]\n * @param {BBox} bbox BBox [west, south, east, north]\n * @returns {boolean} true/false if point is inside BBox\n */\nfunction inBBox(pt, bbox) {\n    return (bbox[0] <= pt[0] && bbox[1] <= pt[1] && bbox[2] >= pt[0] && bbox[3] >= pt[1]);\n}\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { OSM } from \"ol/source\";\nimport { normalizeArg } from \"../functions\";\nimport { lineString } from \"@turf/helpers\";\nimport booleanPointInPolygon from \"@turf/boolean-point-in-polygon\";\nimport lineIntersect from \"@turf/line-intersect\";\nimport {\n  CrossCoordinatesArray,\n  setCustomFunction,\n  setCustomInitialize,\n  setupTileLoadFunction,\n  ViewpointArray\n} from \"./mixin\";\nimport { Coordinate } from \"ol/coordinate\";\nimport { Size } from \"ol/size\";\n\nexport class NowMap extends setCustomFunction(OSM) {\n  constructor(options: any = {}) {\n    super(\n      (options = (() => {\n        options = normalizeArg(options);\n        if (!options.imageExtension) options.imageExtension = \"jpg\";\n        if (options.mapID && !options.url && !options.urls) {\n          options.url = options.tms\n            ? `tiles/${options.mapID}/{z}/{x}/{-y}.${options.imageExtension}`\n            : `tiles/${options.mapID}/{z}/{x}/{y}.${options.imageExtension}`;\n        }\n        return options;\n      })() as any)\n    );\n\n    if (options.mapID) {\n      this.mapID = options.mapID;\n    }\n    setCustomInitialize(this, options);\n    setupTileLoadFunction(this);\n  }\n\n  static async createAsync(options: any) {\n    return new NowMap(options);\n  }\n\n  insideCheckXy(xy: Coordinate) {\n    if (!this.envelope) return true;\n    return booleanPointInPolygon(xy, this.envelope);\n  }\n\n  insideCheckSysCoord(histCoords: Coordinate) {\n    return this.insideCheckXy(histCoords);\n  }\n\n  modulateXyInside(xy: any) {\n    if (!this.centroid) return xy;\n    const expandLine = lineString([xy, this.centroid]);\n    const intersect = lineIntersect(this.envelope as any, expandLine as any);\n    if (intersect.features.length > 0 && intersect.features[0].geometry) {\n      return intersect.features[0].geometry.coordinates;\n    } else {\n      return xy;\n    }\n  }\n\n  modulateSysCoordInside(histCoords: any) {\n    return this.modulateXyInside(histCoords);\n  }\n\n  // unifyTerm\n  // https://github.com/code4history/MaplatCore/issues/19\n\n  merc2XyAsync(merc: Coordinate): Promise<Coordinate> {\n    return Promise.resolve(merc);\n  }\n\n  merc2XyAsync_ignoreBackground(merc: Coordinate): Promise<Coordinate | void> {\n    return this.merc2XyAsync(merc);\n  }\n\n  xy2MercAsync(xy: Coordinate): Promise<Coordinate> {\n    return Promise.resolve(xy);\n  }\n\n  xy2SysCoord(xy: Coordinate): Coordinate {\n    return xy;\n  }\n\n  sysCoord2Xy(sysCoord: Coordinate): Coordinate {\n    return sysCoord;\n  }\n\n  viewpoint2MercsAsync(viewpoint?: ViewpointArray, size?: Size) {\n    const sysCoords = this.viewpoint2SysCoords(viewpoint, size);\n    const xys = this.sysCoords2Xys(sysCoords);\n    return this.xys2MercsAsync(xys);\n  }\n\n  mercs2ViewpointAsync(mercs: CrossCoordinatesArray): Promise<ViewpointArray> {\n    return this.mercs2XysAsync(mercs).then(xys => {\n      const sysCoords = this.xys2SysCoords(xys);\n      return this.sysCoords2Viewpoint(sysCoords);\n    });\n  }\n\n  mercs2SysCoordsAsync_multiLayer(\n    mercs: CrossCoordinatesArray\n  ): Promise<(CrossCoordinatesArray | undefined)[]> {\n    return Promise.all(\n      mercs[0].map(merc => this.merc2SysCoordAsync(merc))\n    ).then(xys => [[xys, mercs[1]]]);\n  }\n\n  defZoom(): number {\n    return this.mercZoom!;\n  }\n}\n","import { NowMap } from \"./nowmap\";\n\nexport class MapboxMap extends NowMap {\n  style = \"\";\n  accessToken = \"\";\n  mapboxMap: any;\n\n  constructor(options: any = {}) {\n    super(options);\n    this.style = options.style;\n    this.mapboxMap = options.mapboxMap;\n  }\n\n  static async createAsync(options: any) {\n    return new MapboxMap(options);\n  }\n}\n","export function randomFromCenter(center: number, pow: number): number {\n  return center + (Math.random() - 0.5) * pow;\n}\n\n// TODO: recursive `val` type\nexport function recursiveRound(val: any, decimal: number): any {\n  // TODO: replace from `instanceof Array` to `Array.isArray`\n  // ref: https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray#instanceof_vs_isArray\n  if (val instanceof Array)\n    return val.map(item => recursiveRound(item, decimal));\n  const decVal = Math.pow(10, decimal);\n  return Math.round(val * decVal) / decVal;\n}\n\nfunction radians(deg: number): number {\n  return (deg * Math.PI) / 180;\n}\n\nexport function getDistance(\n  lnglat1: [number, number],\n  lnglat2: [number, number]\n): number {\n  return (\n    6378.14 *\n    Math.acos(\n      Math.cos(radians(lnglat1[1])) *\n        Math.cos(radians(lnglat2[1])) *\n        Math.cos(radians(lnglat2[0]) - radians(lnglat1[0])) +\n        Math.sin(radians(lnglat1[1])) * Math.sin(radians(lnglat2[1]))\n    )\n  );\n}\n","import Layer from \"ol/layer/Layer\";\nimport { toLonLat } from \"ol/proj\";\n\nexport class MapboxLayer extends Layer {\n  constructor(options: any) {\n    const render = function (frameState: any) {\n      // @ts-expect-error ts-migrate(2683) FIXME: 'this' implicitly has type 'any' because it does n... Remove this comment to see the full error message\n      const source = this.getSource();\n      const mbMap = source.mapboxMap;\n      mbMap.setStyle(source.style);\n      const canvas = mbMap.getCanvas();\n      const viewState = frameState.viewState;\n\n      // @ts-expect-error ts-migrate(2683) FIXME: 'this' implicitly has type 'any' because it does n... Remove this comment to see the full error message\n      const visible = this.getVisible();\n      canvas.style.display = visible ? \"block\" : \"none\";\n\n      // @ts-expect-error ts-migrate(2683) FIXME: 'this' implicitly has type 'any' because it does n... Remove this comment to see the full error message\n      const opacity = this.getOpacity();\n      canvas.style.opacity = opacity;\n\n      // adjust view parameters in mapbox\n      const newBearing = (viewState.rotation * -180) / Math.PI;\n      const newLonLat = toLonLat(viewState.center);\n      const newZoom = viewState.zoom - 1;\n\n      const nowBearing = mbMap.getBearing();\n      const nowLonLat = mbMap.getCenter().toArray();\n      const nowZoom = mbMap.getZoom();\n\n      if (\n        newBearing == nowBearing &&\n        newLonLat[0] == nowLonLat[0] &&\n        newLonLat[1] == nowLonLat[1] &&\n        newZoom == nowZoom\n      ) {\n        return canvas;\n      }\n\n      if (newBearing != nowBearing) {\n        mbMap.rotateTo(newBearing, {\n          animate: false\n        });\n      }\n      if (\n        newLonLat[0] != nowLonLat[0] ||\n        newLonLat[1] != nowLonLat[1] ||\n        newZoom != nowZoom\n      ) {\n        mbMap.jumpTo({\n          center: newLonLat,\n          zoom: newZoom,\n          animate: false\n        });\n      }\n\n      // cancel the scheduled update & trigger synchronous redraw\n      // see https://github.com/mapbox/mapbox-gl-js/issues/7893#issue-408992184\n      // NOTE: THIS MIGHT BREAK WHEN UPDATING MAPBOX\n      if (mbMap._frame) {\n        mbMap._frame.cancel();\n        mbMap._frame = null;\n      }\n\n      mbMap._render();\n\n      return canvas;\n    };\n    super({\n      render,\n      source: options.source\n    });\n  }\n}\n","export default \"assets/images/6e1f2f2f6fed3c5cddeb925e7ae75aba.png\";","export default \"assets/images/9ac6d81f417d6a5626b7c8d5a087c32b.png\";","/* eslint-disable @typescript-eslint/ban-ts-comment */\r\nimport { Feature, Geolocation, Map, MapEvent } from \"ol\";\r\nimport { View } from \"./view_ex\";\r\nimport { Group, Tile, Vector as layerVector } from \"ol/layer\";\r\nimport { Vector as sourceVector } from \"ol/source\";\r\nimport { Circle, LineString, Point, Polygon } from \"ol/geom\";\r\nimport { Fill, Icon, Stroke, Style } from \"ol/style\";\r\nimport { MapboxMap } from \"./source/mapboxmap\";\r\nimport { NowMap } from \"./source/nowmap\";\r\nimport { getDistance, randomFromCenter } from \"./math_ex\";\r\nimport { MapboxLayer } from \"./layer_mapbox\";\r\nimport { normalizeArg } from \"./functions\";\r\n\r\n// @ts-ignore\r\nimport bluedot from \"../parts/bluedot.png\";                         // @ts-ignore\r\nimport bluedot_transparent from \"../parts/bluedot_transparent.png\"; // @ts-ignore\r\nimport bluedot_small from \"../parts/bluedot_small.png\";             // @ts-ignore\r\nimport defaultpin from \"../parts/defaultpin.png\";\r\nimport {  } from \"ol/style/Icon\";\r\nimport { HistMap } from \"./source/histmap\";\r\n\r\nconst gpsStyle = new Style({\r\n  image: new Icon({\r\n    anchor: [0.5, 0.5],\r\n    anchorXUnits: 'fraction',\r\n    anchorYUnits: 'fraction',\r\n    src: bluedot\r\n  })\r\n});\r\nconst gpsHideStyle = new Style({\r\n  image: new Icon({\r\n    anchor: [0.5, 0.5],\r\n    anchorXUnits: 'fraction',\r\n    anchorYUnits: 'fraction',\r\n    src: bluedot_transparent\r\n  })\r\n});\r\nconst gpsSubStyle = new Style({\r\n  image: new Icon({\r\n    anchor: [0.5, 0.5],\r\n    anchorXUnits: 'fraction',\r\n    anchorYUnits: 'fraction',\r\n    src: bluedot_small\r\n  })\r\n});\r\nconst accCircleStyle = new Style({\r\n  fill: new Fill({\r\n    color: [128, 128, 256, 0.2]\r\n  }),\r\n  stroke: new Stroke({\r\n    color: [128, 128, 256, 1.0],\r\n    width: 3\r\n  })\r\n});\r\nconst markerDefaultStyle = new Style({\r\n  image: new Icon({\r\n    anchor: [0.5, 1.0],\r\n    anchorXUnits: 'fraction',\r\n    anchorYUnits: 'fraction',\r\n    src: defaultpin\r\n  })\r\n});\r\nexport class MaplatMap extends Map {\r\n  _first_gps_request: any;\r\n  _overlay_group: any;\r\n  fakeGps: any;\r\n  fakeRadius: any;\r\n  geolocation: any;\r\n  homePosition: any;\r\n  __AvoidFirstMoveStart: boolean;\r\n  northUp: boolean;\r\n  tapDuration: number;\r\n  homeMarginPixels: number;\r\n  tapUIVanish: boolean;\r\n  constructor(optOptions: any) {\r\n    optOptions = normalizeArg(optOptions || {});\r\n    const vectorLayer = new layerVector({\r\n      source: new sourceVector({\r\n        wrapX: false\r\n      })\r\n    });\r\n    vectorLayer.set(\"name\", \"gps\");\r\n    const markerLayer = new layerVector({\r\n      source: new sourceVector({\r\n        wrapX: false\r\n      })\r\n    });\r\n    markerLayer.set(\"name\", \"marker\");\r\n    const featureLayer = new layerVector({\r\n      source: new sourceVector({\r\n        wrapX: false\r\n      })\r\n    });\r\n    featureLayer.set(\"name\", \"feature\");\r\n    const envelopeLayer = new layerVector({\r\n      source: new sourceVector({\r\n        wrapX: false\r\n      })\r\n    });\r\n    envelopeLayer.set(\"name\", \"envelope\");\r\n    const baseLayer = MaplatMap.spawnLayer(\r\n      null,\r\n      optOptions.source,\r\n      optOptions.target\r\n    );\r\n    const overlayLayer = new Group();\r\n    overlayLayer.set(\"name\", \"overlay\");\r\n    const controls = optOptions.controls ? optOptions.controls : [];\r\n    const options = {\r\n      controls,\r\n      layers: [\r\n        baseLayer,\r\n        overlayLayer,\r\n        envelopeLayer,\r\n        featureLayer,\r\n        vectorLayer,\r\n        markerLayer\r\n      ],\r\n      target: optOptions.div,\r\n      view: new View({\r\n        center: optOptions.defaultCenter || [0, 0],\r\n        zoom: optOptions.defaultZoom || 2,\r\n        rotation: optOptions.defaultRotation || 0,\r\n        multiWorld: true\r\n      })\r\n    };\r\n    if (optOptions.interactions) {\r\n      (options as any).interactions = optOptions.interactions;\r\n    }\r\n    super(options);\r\n    this._overlay_group = overlayLayer;\r\n    this.fakeGps = optOptions.fakeGps;\r\n    this.fakeRadius = optOptions.fakeRadius;\r\n    this.homePosition = optOptions.homePosition;\r\n    this.northUp = optOptions.northUp;\r\n    this.tapDuration = optOptions.tapDuration;\r\n    this.homeMarginPixels = optOptions.homeMarginPixels;\r\n    this.tapUIVanish = optOptions.tapUIVanish;\r\n    const view = this.getView();\r\n    this.__AvoidFirstMoveStart = true;\r\n    const movestart = () => {\r\n      if (!this.__AvoidFirstMoveStart) this.dispatchEvent(\"movestart\");\r\n      this.__AvoidFirstMoveStart = false;\r\n      view.un(\"propertychange\", movestart);\r\n    };\r\n    view.on(\"propertychange\", movestart);\r\n    this.on(\"moveend\", () => {\r\n      view.on(\"propertychange\", movestart);\r\n    });\r\n  }\r\n  static spawnLayer(layer: any, source: any, container: any) {\r\n    if (source instanceof MapboxMap || !(layer instanceof Tile)) {\r\n      if (source instanceof MapboxMap) {\r\n        layer = new MapboxLayer({\r\n          style: source.style,\r\n          accessToken: source.accessToken,\r\n          container,\r\n          source\r\n        });\r\n      } else {\r\n        layer = new Tile({\r\n          source\r\n        });\r\n      }\r\n      layer.set(\"name\", \"base\");\r\n    } else {\r\n      layer.setSource(source);\r\n    }\r\n    return layer;\r\n  }\r\n  getLayer(name = \"base\") {\r\n    const recur = (layers: any) => {\r\n      const filtered = layers\r\n        .getArray()\r\n        .map((layer: any) => {\r\n          if (layer.get(\"name\") == name) return layer;\r\n          if (layer.getLayers) return recur(layer.getLayers());\r\n          return;\r\n        })\r\n        .filter((layer: any) => layer);\r\n      if (filtered.length == 0) return;\r\n      return filtered[0];\r\n    };\r\n    return recur(this.getLayers());\r\n  }\r\n  getSource(name = \"base\") {\r\n    const layer = this.getLayer(name);\r\n    if (!layer) return;\r\n    return layer.getSource();\r\n  }\r\n  setFeature(data: any, style: any, layer: any) {\r\n    const src = this.getSource(layer);\r\n    const feature = new Feature(data);\r\n    if (style) {\r\n      feature.setStyle(style);\r\n    }\r\n    src.addFeature(feature);\r\n    return feature;\r\n  }\r\n  removeFeature(feature: any, layer: any) {\r\n    const src = this.getSource(layer);\r\n    src.removeFeature(feature);\r\n  }\r\n  resetFeature(layer: any) {\r\n    const src = this.getSource(layer);\r\n    src.clear();\r\n  }\r\n  setGPSPosition(pos: any, type: any = undefined) {\r\n    const style =\r\n      type == \"sub\" ? gpsSubStyle : type == \"hide\" ? gpsHideStyle : gpsStyle;\r\n    if (type != \"sub\") {\r\n      this.resetFeature(\"gps\");\r\n    }\r\n    if (pos) {\r\n      this.setFeature(\r\n        {\r\n          geometry: new Point(pos.xy)\r\n        },\r\n        style,\r\n        \"gps\"\r\n      );\r\n      if (!type) {\r\n        this.setFeature(\r\n          {\r\n            geometry: new Circle(pos.xy, pos.rad)\r\n          },\r\n          accCircleStyle,\r\n          \"gps\"\r\n        );\r\n      }\r\n    }\r\n  }\r\n  setMarker(xy: any, data: any, markerStyle: any, layer: any) {\r\n    if (!layer) layer = \"marker\";\r\n    data[\"geometry\"] = new Point(xy);\r\n    if (!markerStyle) markerStyle = markerDefaultStyle;\r\n    else if (typeof markerStyle == \"string\") {\r\n      markerStyle = new Style({\r\n        image: new Icon({\r\n          anchor: [0.5, 1.0],\r\n          anchorXUnits: 'fraction',\r\n          anchorYUnits: 'fraction',\r\n          src: markerStyle\r\n        })\r\n      });\r\n    } else if (!(markerStyle instanceof Style)) {\r\n      markerStyle = new Style({\r\n        image: new Icon(markerStyle)\r\n      });\r\n    }\r\n    return this.setFeature(data, markerStyle, layer);\r\n  }\r\n  resetMarker(layer: any) {\r\n    if (!layer) layer = \"marker\";\r\n    this.resetFeature(layer);\r\n  }\r\n  setLine(xys: any, stroke: any, layer: any) {\r\n    // Ready for Polygon\r\n    return this.setVector(xys, \"Line\", stroke ? { stroke } : null, layer);\r\n  }\r\n  setVector(coords: any, type = \"Line\", style: any, layer: any) {\r\n    // Ready for Polygon\r\n    if (!layer) layer = \"feature\";\r\n    const option = {};\r\n    if (style.stroke != null) (option as any).stroke = new Stroke(style.stroke);\r\n    if (style.fill != null) (option as any).fill = new Fill(style.fill);\r\n    const styleObj = new Style(option);\r\n    const geometry =\r\n      type === \"Line\" ? new LineString(coords) : new Polygon(coords);\r\n    return this.setFeature(\r\n      {\r\n        geometry,\r\n        name: type\r\n      },\r\n      styleObj,\r\n      layer\r\n    );\r\n  }\r\n  resetLine(layer: any) {\r\n    // Ready for Polygon\r\n    this.resetVector(layer);\r\n  }\r\n  resetVector(layer: any) {\r\n    // Ready for Polygon\r\n    if (!layer) layer = \"feature\";\r\n    this.resetFeature(layer);\r\n  }\r\n  setEnvelope(xys: any, stroke: any, layer: any) {\r\n    if (!layer) layer = \"envelope\";\r\n    return this.setLine(xys, stroke, layer);\r\n  }\r\n  removeEnvelope(feature: any, layer: any) {\r\n    if (!layer) layer = \"envelope\";\r\n    this.removeFeature(feature, layer);\r\n  }\r\n  resetEnvelope(layer: any) {\r\n    if (!layer) layer = \"envelope\";\r\n    this.resetFeature(layer);\r\n  }\r\n  setFillEnvelope(xys: any, stroke: any, fill: any, layer: any) {\r\n    if (!layer) layer = \"envelope\";\r\n    let style: (Style | undefined);\r\n    if (stroke != null || fill != null) {\r\n      const option = {};\r\n      if (stroke != null) (option as any).stroke = new Stroke(stroke);\r\n      if (fill != null) (option as any).fill = new Fill(fill);\r\n      style = new Style(option);\r\n    }\r\n    return this.setFeature(\r\n      {\r\n        geometry: new Polygon([xys])\r\n      },\r\n      style,\r\n      layer\r\n    );\r\n  }\r\n  exchangeSource(source: any = undefined) {\r\n    const layers = this.getLayers();\r\n    const prevLayer = layers.item(0);\r\n    const layer = MaplatMap.spawnLayer(prevLayer, source, this.getTarget());\r\n    if (layer != prevLayer) layers.setAt(0, layer);\r\n    if (source) {\r\n      source.setMap(this);\r\n    }\r\n  }\r\n  setLayer(source: any = undefined) {\r\n    const layers = this.getLayer(\"overlay\").getLayers();\r\n    layers.clear();\r\n    if (source) {\r\n      const layer = new Tile({\r\n        source\r\n      });\r\n      layers.push(layer);\r\n    }\r\n  }\r\n  setTransparency(percentage: any) {\r\n    const opacity = (100 - percentage) / 100;\r\n    const source = this.getSource();\r\n    if (source instanceof NowMap) {\r\n      this.getLayers().item(0).setOpacity(1);\r\n      this.getLayers().item(1).setOpacity(opacity);\r\n    } else {\r\n      this.getLayers().item(0).setOpacity(opacity);\r\n    }\r\n  }\r\n  setGPSMarker(position: any, ignoreMove: any) {\r\n    // alert(\"ol.MaplatMap.prototype.setGPSMarker\");\r\n    const source = (this.getLayers().item(0) as any).getSource();\r\n    source.setGPSMarker(position, ignoreMove);\r\n  }\r\n  handleGPS(launch: any, avoidEventForOff: any) {\r\n    //const map = this;\r\n    if (launch) {\r\n      this.dispatchEvent(\"gps_request\");\r\n      this._first_gps_request = true;\r\n      if (!this.geolocation) {\r\n        const geolocation = (this.geolocation = new Geolocation({\r\n          tracking: true\r\n        }));\r\n        // listen to changes in position\r\n        geolocation.on(\"change\", _evt => {\r\n          const overlayLayer = this.getLayer(\"overlay\").getLayers().item(0);\r\n          const source = overlayLayer\r\n            ? overlayLayer.getSource()\r\n            : (this.getLayers().item(0) as any).getSource();\r\n          let lnglat = geolocation.getPosition();\r\n          let acc = geolocation.getAccuracy();\r\n          if (\r\n            this.fakeGps &&\r\n            getDistance(this.homePosition, lnglat as [number, number]) >\r\n              this.fakeGps\r\n          ) {\r\n            lnglat = [\r\n              randomFromCenter(this.homePosition[0], 0.001),\r\n              randomFromCenter(this.homePosition[1], 0.001)\r\n            ];\r\n            acc = randomFromCenter(15.0, 10);\r\n          }\r\n          let gpsVal: any = { lnglat, acc };\r\n          source\r\n            .setGPSMarkerAsync(gpsVal, !this._first_gps_request)\r\n            .then((result: any) => {\r\n              if (!result) {\r\n                gpsVal = { error: \"gps_out\" };\r\n              }\r\n              this._first_gps_request = false;\r\n              this.dispatchEvent(new MapEvent(\"gps_result\", this, gpsVal));\r\n            });\r\n        });\r\n        geolocation.on(\"error\", _evt => {\r\n          const source = (this.getLayers().item(0) as any).getSource();\r\n          let gpsVal: any = null;\r\n          if (this.fakeGps) {\r\n            const lnglat = [\r\n              randomFromCenter(this.homePosition[0], 0.001),\r\n              randomFromCenter(this.homePosition[1], 0.001)\r\n            ];\r\n            const acc = randomFromCenter(15.0, 10);\r\n            gpsVal = { lnglat, acc };\r\n          }\r\n          (source as NowMap | HistMap)\r\n            .setGPSMarkerAsync(gpsVal, !this._first_gps_request)\r\n            .then((result: any) => {\r\n              if (!result) {\r\n                gpsVal = { error: \"gps_out\" };\r\n              }\r\n              this._first_gps_request = false;\r\n              this.dispatchEvent(new MapEvent(\"gps_result\", this, gpsVal));\r\n            });\r\n        });\r\n      } else {\r\n        this.geolocation.setTracking(true);\r\n      }\r\n    } else {\r\n      if (this.geolocation) this.geolocation.setTracking(false);\r\n      const source = (this.getLayers().item(0) as any).getSource();\r\n      source.setGPSMarker();\r\n      if (!avoidEventForOff)\r\n        this.dispatchEvent(\r\n          new MapEvent(\"gps_result\", this, { error: \"gps_off\" } as any)\r\n        );\r\n    }\r\n  }\r\n}\r\n","export default \"assets/images/6c5dba7f7d76e74c3a8c7c5b1c3fc544.png\";","export default \"assets/images/0beac2cb41dfab43ddfd9df80b32b85d.png\";","/**\n * @module ol/interaction/DragRotateAndZoom\n */\nimport PointerInteraction from './Pointer.js';\nimport {mouseOnly, shiftKeyOnly} from '../events/condition.js';\n\n/**\n * @typedef {Object} Options\n * @property {import(\"../events/condition.js\").Condition} [condition] A function that\n * takes an {@link module:ol/MapBrowserEvent~MapBrowserEvent} and returns a\n * boolean to indicate whether that event should be handled.\n * Default is {@link module:ol/events/condition.shiftKeyOnly}.\n * @property {number} [duration=400] Animation duration in milliseconds.\n */\n\n/**\n * @classdesc\n * Allows the user to zoom and rotate the map by clicking and dragging\n * on the map.  By default, this interaction is limited to when the shift\n * key is held down.\n *\n * This interaction is only supported for mouse devices.\n *\n * And this interaction is not included in the default interactions.\n * @api\n */\nclass DragRotateAndZoom extends PointerInteraction {\n  /**\n   * @param {Options} [options] Options.\n   */\n  constructor(options) {\n    options = options ? options : {};\n\n    super(/** @type {import(\"./Pointer.js\").Options} */ (options));\n\n    /**\n     * @private\n     * @type {import(\"../events/condition.js\").Condition}\n     */\n    this.condition_ = options.condition ? options.condition : shiftKeyOnly;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lastAngle_ = undefined;\n\n    /**\n     * @private\n     * @type {number|undefined}\n     */\n    this.lastMagnitude_ = undefined;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.lastScaleDelta_ = 0;\n\n    /**\n     * @private\n     * @type {number}\n     */\n    this.duration_ = options.duration !== undefined ? options.duration : 400;\n  }\n\n  /**\n   * Handle pointer drag events.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Event.\n   */\n  handleDragEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return;\n    }\n\n    const map = mapBrowserEvent.map;\n    const size = map.getSize();\n    const offset = mapBrowserEvent.pixel;\n    const deltaX = offset[0] - size[0] / 2;\n    const deltaY = size[1] / 2 - offset[1];\n    const theta = Math.atan2(deltaY, deltaX);\n    const magnitude = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\n    const view = map.getView();\n    if (this.lastAngle_ !== undefined) {\n      const angleDelta = this.lastAngle_ - theta;\n      view.adjustRotationInternal(angleDelta);\n    }\n    this.lastAngle_ = theta;\n    if (this.lastMagnitude_ !== undefined) {\n      view.adjustResolutionInternal(this.lastMagnitude_ / magnitude);\n    }\n    if (this.lastMagnitude_ !== undefined) {\n      this.lastScaleDelta_ = this.lastMagnitude_ / magnitude;\n    }\n    this.lastMagnitude_ = magnitude;\n  }\n\n  /**\n   * Handle pointer up events.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Event.\n   * @return {boolean} If the event was consumed.\n   */\n  handleUpEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return true;\n    }\n\n    const map = mapBrowserEvent.map;\n    const view = map.getView();\n    const direction = this.lastScaleDelta_ > 1 ? 1 : -1;\n    view.endInteraction(this.duration_, direction);\n    this.lastScaleDelta_ = 0;\n    return false;\n  }\n\n  /**\n   * Handle pointer down events.\n   * @param {import(\"../MapBrowserEvent.js\").default} mapBrowserEvent Event.\n   * @return {boolean} If the event was consumed.\n   */\n  handleDownEvent(mapBrowserEvent) {\n    if (!mouseOnly(mapBrowserEvent)) {\n      return false;\n    }\n\n    if (this.condition_(mapBrowserEvent)) {\n      mapBrowserEvent.map.getView().beginInteraction();\n      this.lastAngle_ = undefined;\n      this.lastMagnitude_ = undefined;\n      return true;\n    }\n    return false;\n  }\n}\n\nexport default DragRotateAndZoom;\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { addCoordinateTransforms, addProjection, Projection } from \"ol/proj\";\nimport { MERC_MAX, tileSize, transPng } from \"../const_ex\";\nimport {\n  setCustomFunction,\n  setCustomInitialize,\n  setupTileLoadFunction\n} from \"./mixin\";\nimport { XYZ } from \"ol/source\";\nimport { normalizeArg } from \"../functions\";\nimport { createFromTemplates, expandUrl } from \"ol/tileurlfunction\";\nimport { Coordinate } from \"ol/coordinate\";\nimport { Size } from \"ol/size\";\n\nfor (let z = 0; z < 9; z++) {\n  const key = `ZOOM:${z}`;\n  const maxxy = 256 * Math.pow(2, z);\n\n  (function (key, maxxy) {\n    const projection = new Projection({\n      code: key,\n      // The extent is used to determine zoom level 0. Recommended values for a\n      // projection's validity extent can be found at https://epsg.io/.\n      extent: [0.0, 0.0, maxxy, maxxy],\n      units: \"m\"\n    });\n    addProjection(projection);\n\n    // We also declare EPSG:21781/EPSG:4326 transform functions. These functions\n    // are necessary for the ScaleLine control and when calling ol.proj.transform\n    // for setting the view's initial center (see below).\n\n    addCoordinateTransforms(\n      \"EPSG:3857\",\n      projection,\n      coordinate => {\n        const x = ((coordinate[0] + MERC_MAX) * maxxy) / (2 * MERC_MAX);\n        const y = ((-coordinate[1] + MERC_MAX) * maxxy) / (2 * MERC_MAX);\n        return [x, y];\n      },\n      coordinate => {\n        const x = (coordinate[0] * (2 * MERC_MAX)) / maxxy - MERC_MAX;\n        const y = -1 * ((coordinate[1] * (2 * MERC_MAX)) / maxxy - MERC_MAX);\n        return [x, y];\n      }\n    );\n  })(key, maxxy);\n}\n\n// eslint-disable-next-line @typescript-eslint/ban-types\n/*type Constructor<T = {}> = new (...args: any[]) => T;\n\nexport function setCustomFunctionForHistmap<TBase extends Constructor>(Base: TBase) {\n  abstract class HistMapMixin extends setCustomFunction(Base) {\n\n  }\n  return HistMapMixin;\n}\n\nexport function setCustomInitializeForHistmap(self: any, options: any) {\n\n  setCustomInitialize(this, options);\n  setupTileLoadFunction(this);\n}*/\n\nexport abstract class HistMap extends setCustomFunction(XYZ) {\n  width: number;\n  height: number;\n  _maxxy: number;\n\n  constructor(options: any = {}) {\n    super(\n      (options = (() => {\n        options = normalizeArg(options);\n\n        options.wrapX = false;\n        if (!options.imageExtension) options.imageExtension = \"jpg\";\n        if (options.mapID && !options.url && !options.urls) {\n          options.url = `tiles/${options.mapID}/{z}/{x}/{y}.${options.imageExtension}`;\n        }\n\n        const zW = Math.log2(options.width / tileSize);\n        const zH = Math.log2(options.height / tileSize);\n        options.maxZoom = Math.ceil(Math.max(zW, zH));\n\n        options.tileUrlFunction =\n          options.tileUrlFunction ||\n          function (this: HistMap, coord: any) {\n            const z = coord[0];\n            const x = coord[1];\n            const y = coord[2];\n            if (\n              // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n              // @ts-ignore\n              x * tileSize * Math.pow(2, this.maxZoom - z) >= this.width ||\n              // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n              // @ts-ignore\n              y * tileSize * Math.pow(2, this.maxZoom - z) >= this.height ||\n              x < 0 ||\n              y < 0\n            ) {\n              return transPng;\n            }\n            // @ts-expect-error ts-migrate(2683)\n            return this._tileUrlFunction(coord);\n          };\n        return options;\n      })() as any)\n    );\n\n    if (options.mapID) {\n      this.mapID = options.mapID;\n    }\n    if (options.urls) {\n      // @ts-expect-error ts-migrate(2554)\n      this._tileUrlFunction = createFromTemplates(options.urls);\n    } else if (options.url) {\n      // @ts-expect-error ts-migrate(2554)\n      this._tileUrlFunction = createFromTemplates(expandUrl(options.url));\n    }\n\n    this.width = options.width;\n    this.height = options.height;\n    this.maxZoom = options.maxZoom;\n    this._maxxy = Math.pow(2, this.maxZoom as number) * tileSize;\n\n    setCustomInitialize(this, options);\n    setupTileLoadFunction(this);\n  }\n\n  insideCheckXy(xy: Coordinate) {\n    return !(\n      xy[0] < 0 ||\n      xy[0] > this.width ||\n      xy[1] < 0 ||\n      xy[1] > this.height\n    );\n  }\n\n  insideCheckSysCoord(sysCoord: Coordinate) {\n    return this.insideCheckXy(this.sysCoord2Xy(sysCoord));\n  }\n\n  modulateXyInside(xy: any) {\n    const dx = xy[0] / (this.width / 2) - 1;\n    const dy = xy[1] / (this.height / 2) - 1;\n    const da = Math.max(Math.abs(dx), Math.abs(dy));\n    return [\n      ((dx / da + 1) * this.width) / 2,\n      ((dy / da + 1) * this.height) / 2\n    ];\n  }\n\n  modulateSysCoordInside(histCoords: any) {\n    const xy = this.sysCoord2Xy(histCoords);\n    const ret = this.modulateXyInside(xy);\n    return this.xy2SysCoord(ret);\n  }\n\n  // unifyTerm\n  // https://github.com/code4history/MaplatCore/issues/19\n\n  xy2SysCoord(xy: Coordinate): Coordinate {\n    const sysCoordX = (xy[0] * (2 * MERC_MAX)) / this._maxxy - MERC_MAX;\n    const sysCoordY = -1 * ((xy[1] * (2 * MERC_MAX)) / this._maxxy - MERC_MAX);\n    return [sysCoordX, sysCoordY];\n  }\n\n  sysCoord2Xy(sysCoord: Coordinate): Coordinate {\n    const x = ((sysCoord[0] + MERC_MAX) * this._maxxy) / (2 * MERC_MAX);\n    const y = ((-sysCoord[1] + MERC_MAX) * this._maxxy) / (2 * MERC_MAX);\n    return [x, y];\n  }\n\n  defZoom(screenSize?: Size): number {\n    const screenWidth = screenSize![0];\n    const screenHeight = screenSize![1];\n    const delZoomOfWidth = Math.log2((screenWidth - 10) / this.width);\n    const delZoomOfHeight = Math.log2((screenHeight - 10) / this.height);\n    const maxZoom = this.maxZoom!;\n    let delZoom;\n    if (delZoomOfHeight > delZoomOfWidth) {\n      delZoom = delZoomOfHeight;\n    } else {\n      delZoom = delZoomOfWidth;\n    }\n    return maxZoom + delZoom;\n  }\n}\n","import { NowMap } from \"./nowmap\";\n\nexport class TmsMap extends NowMap {\n  constructor(options: any = {}) {\n    super(Object.assign(options, { opaque: false }));\n  }\n\n  static async createAsync(options: any) {\n    return new TmsMap(options);\n  }\n}\n","\"use strict\";\r\n\r\nconst BASEURL = 'https://weiwudi.example.com/api/';\r\nlet swChecking;\r\nlet swChecked;\r\n\r\n(function () {\r\n    if (typeof window.CustomEvent === 'function') return false;\r\n\r\n    function CustomEvent(event, params) {\r\n        params = params || { bubbles: false, cancelable: false, detail: undefined };\r\n        var evt = document.createEvent('CustomEvent');\r\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n        return evt;\r\n    }\r\n\r\n    CustomEvent.prototype = window.Event.prototype;\r\n\r\n    window.CustomEvent = CustomEvent;\r\n})();\r\n\r\nclass EventTarget {\r\n    constructor() {\r\n        this.listeners = {};\r\n    }\r\n\r\n    addEventListener(type, callback) {\r\n        if (!(type in this.listeners)) {\r\n            this.listeners[type] = [];\r\n        }\r\n        this.listeners[type].push(callback);\r\n    }\r\n\r\n    removeEventListener(type, callback) {\r\n        if (!(type in this.listeners)) {\r\n            return;\r\n        }\r\n        const stack = this.listeners[type];\r\n        for (let i = 0, l = stack.length; i < l; i++) {\r\n            if (stack[i] === callback){\r\n                stack.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    dispatchEvent(event) {\r\n        if (!(event.type in this.listeners)) {\r\n            return true;\r\n        }\r\n        const stack = this.listeners[event.type].slice();\r\n\r\n        for (let i = 0, l = stack.length; i < l; i++) {\r\n            stack[i].call(this, event);\r\n        }\r\n        return !event.defaultPrevented;\r\n    }\r\n}\r\n\r\nexport default class Weiwudi extends EventTarget {\r\n    static async registerSW(sw, swOptions) {\r\n        if ('serviceWorker' in navigator) {\r\n            try {\r\n                const reg = await navigator.serviceWorker.register(sw, swOptions);\r\n                //console.log('Service Worker Registered');\r\n\r\n                // A wild service worker has appeared in reg.installing and maybe in waiting!\r\n                const newWorker = reg.installing;\r\n                const waitingWoker = reg.waiting;\r\n\r\n                if (newWorker) {\r\n                    if (newWorker.state === 'activated' && !waitingWoker) {\r\n                        // reload to avoid skipWaiting and clients.claim()\r\n                        window.location.reload();\r\n                    }\r\n                    newWorker.addEventListener('statechange', (e) => {\r\n                        // newWorker.state has changed\r\n                        if (newWorker.state === 'activated' && !waitingWoker) {\r\n                            // reload to avoid skipWaiting and clients.claim()\r\n                            window.location.reload();\r\n                        }\r\n                    });\r\n                }\r\n                reg.onupdatefound = () => {\r\n                    //console.log('Found Service Worker update');\r\n                    reg.update();\r\n                };\r\n\r\n                await Weiwudi.swCheck();\r\n\r\n                return reg;\r\n            } catch(e) {\r\n                throw(`Error: Service worker registration failed with ${e}`);\r\n            }\r\n        } else {\r\n            throw('Error: Service worker is not supported');\r\n        }\r\n    }\r\n\r\n    static async swCheck() {\r\n        if (swChecked !== undefined) return swChecked;\r\n        if (swChecking === undefined) swChecking = new Promise(async (res, rej) => {\r\n            try {\r\n                swChecked = await fetch(`${BASEURL}ping`);\r\n                swChecked = !!swChecked;\r\n            } catch(e) {\r\n                swChecked = false;\r\n            }\r\n            res(swChecked);\r\n        });\r\n        return swChecking;\r\n    }\r\n\r\n    static async registerMap(mapID, options) {\r\n        const swCheck = await Weiwudi.swCheck();\r\n        if (!swCheck) throw('Weiwudi service worker is not implemented.');\r\n        let text;\r\n        try {\r\n            const p = ['type', 'url', 'width', 'height', 'tileSize', 'minZoom', 'maxZoom', 'maxLng', 'maxLat', 'minLng', 'minLat'].reduce((p, key) => {\r\n                if (typeof options[key] !== 'undefined') {\r\n                    if (options[key] instanceof Array) {\r\n                        options[key].map((val) => {\r\n                            p.append(key, val);\r\n                        });\r\n                    } else {\r\n                        p.append(key, options[key]);\r\n                    }\r\n                }\r\n                return p;\r\n            }, new URLSearchParams());\r\n            p.append('mapID', mapID);\r\n            const url = new URL(`${BASEURL}add`);\r\n            url.search = p;\r\n            const res = await fetch(url.href);\r\n            text = await res.text();\r\n        } catch(e) {\r\n            throw(e);\r\n        }\r\n        if (text.match(/^Error: /)) {\r\n            throw(text);\r\n        }\r\n        return new Weiwudi(mapID, JSON.parse(text));\r\n    }\r\n\r\n    static async retrieveMap(mapID) {\r\n        const swCheck = await Weiwudi.swCheck();\r\n        if (!swCheck) throw('Weiwudi service worker is not implemented.');\r\n        let text;\r\n        try {\r\n            const res = await fetch(`${BASEURL}info?mapID=${mapID}`);\r\n            text = await res.text();\r\n        } catch(e) {\r\n            throw(e);\r\n        }\r\n        if (text.match(/^Error: /)) {\r\n            throw(text);\r\n        }\r\n        console.log(text);\r\n        return new Weiwudi(mapID, JSON.parse(text));\r\n    }\r\n\r\n    static async removeMap(mapID) {\r\n        const swCheck = await Weiwudi.swCheck();\r\n        if (!swCheck) throw('Weiwudi service worker is not implemented.');\r\n        let text;\r\n        try {\r\n            const res = await fetch(`${BASEURL}delete?mapID=${mapID}`);\r\n            text = await res.text();\r\n        } catch(e) {\r\n            throw(e);\r\n        }\r\n        if (text.match(/^Error: /)) {\r\n            throw(text);\r\n        }\r\n    }\r\n\r\n    constructor(mapID, attrs) {\r\n        super();\r\n        if (!mapID) throw('MapID is necessary.');\r\n        this.mapID = mapID;\r\n        if (attrs) Object.assign(this, attrs);\r\n        this.url = `${BASEURL}cache/${mapID}/{z}/{x}/{y}`;\r\n        this.listener = (e) => {\r\n            const eventMapID = e.data.mapID;\r\n            if (eventMapID !== mapID) return;\r\n            this.dispatchEvent(new CustomEvent(e.data.type, {detail: e.data}));\r\n        };\r\n        navigator.serviceWorker.addEventListener('message', this.listener);\r\n    }\r\n\r\n    release() {\r\n        navigator.serviceWorker.removeEventListener('message', this.listener);\r\n        delete this.mapID;\r\n    }\r\n\r\n    checkAspect() {\r\n        if (!this.mapID) throw('This instance is already released.');\r\n    }\r\n\r\n    async stats() {\r\n        let text;\r\n        this.checkAspect();\r\n        try {\r\n            const res = await fetch(`${BASEURL}stats?mapID=${this.mapID}`);\r\n            text = await res.text();\r\n        } catch(e) {\r\n            throw(e);\r\n        }\r\n        if (typeof text === 'string' && text.match(/^Error: /)) {\r\n            throw(text);\r\n        }\r\n        return JSON.parse(text);\r\n    }\r\n\r\n    async clean() {\r\n        let text;\r\n        this.checkAspect();\r\n        try {\r\n            const res = await fetch(`${BASEURL}clean?mapID=${this.mapID}`);\r\n            text = await res.text();\r\n        } catch(e) {\r\n            throw(e);\r\n        }\r\n        if (text.match(/^Error: /)) {\r\n            throw(text);\r\n        }\r\n    }\r\n\r\n    async fetchAll() {\r\n        let text;\r\n        this.checkAspect();\r\n        try {\r\n            const res = await fetch(`${BASEURL}fetchAll?mapID=${this.mapID}`);\r\n            text = await res.text();\r\n        } catch(e) {\r\n            throw(e);\r\n        }\r\n        if (text.match(/^Error: /)) {\r\n            throw(text);\r\n        }\r\n    }\r\n\r\n    async remove() {\r\n        this.checkAspect();\r\n        await Weiwudi.removeMap(this.mapID);\r\n        this.release();\r\n    }\r\n\r\n    async cancel() {\r\n        let text;\r\n        this.checkAspect();\r\n        try {\r\n            const res = await fetch(`${BASEURL}cancel?mapID=${this.mapID}`);\r\n            text = await res.text();\r\n        } catch(e) {\r\n            throw(e);\r\n        }\r\n        if (text.match(/^Error: /)) {\r\n            throw(text);\r\n        }\r\n    }\r\n}","import {\n  getTransform,\n  identityTransform,\n  transform,\n  addCoordinateTransforms,\n  ProjectionLike\n} from \"ol/proj\";\nimport { Coordinate } from \"ol/coordinate\";\n\n// Direct transformation between 2 projection\nexport function transformDirect(\n  src: ProjectionLike,\n  dist: ProjectionLike,\n  xy?: Coordinate\n): Coordinate | undefined {\n  const srcCode = typeof src === \"string\" ? src : src!.getCode();\n  const distCode = typeof dist === \"string\" ? dist : dist!.getCode();\n  let func = getTransform(src, dist);\n  if (func == identityTransform && srcCode != distCode) {\n    const srcFunc = getTransform(src, \"EPSG:3857\");\n    const distFunc = getTransform(\"EPSG:3857\", dist);\n    if (srcFunc == identityTransform && srcCode != \"EPSG:3857\")\n      throw \"Transform of Source projection is not defined.\";\n    if (distFunc == identityTransform && distCode != \"EPSG:3857\")\n      throw \"Transform of Distination projection is not defined.\";\n    func = function (xy: Coordinate): Coordinate {\n      return transform(transform(xy, src, \"EPSG:3857\"), \"EPSG:3857\", dist);\n    };\n    const invFunc = function (xy: Coordinate): Coordinate {\n      return transform(transform(xy, dist, \"EPSG:3857\"), \"EPSG:3857\", src);\n    };\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    addCoordinateTransforms(src, dist, func, invFunc);\n  }\n\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  if (xy) {\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    return func(xy);\n  }\n}\n","\"use strict\";\n\nimport Tin, {\n  Options,\n  Compiled,\n  PointSet,\n  Edge,\n  StrictMode,\n  VertexMode,\n  YaxisMode\n} from \"@maplat/tin\";\nimport { Position } from \"@turf/turf\";\ntype LangResource = string | Record<string, string>;\ntype TinLike = string | Tin | Compiled;\n\ninterface HistMapStore {\n  title: LangResource;\n  attr: LangResource;\n  officialTitle: LangResource;\n  dataAttr: LangResource;\n  strictMode?: StrictMode;\n  vertexMode?: VertexMode;\n  yaxisMode?: YaxisMode;\n  author: LangResource;\n  createdAt: LangResource;\n  era: LangResource;\n  license: string;\n  dataLicense: string;\n  contributor: LangResource;\n  mapper: LangResource;\n  reference: string;\n  description: LangResource;\n  url: LangResource;\n  lang: string;\n  imageExtension: string;\n  width?: number;\n  height?: number;\n  gcps?: PointSet[];\n  edges?: Edge[];\n  compiled?: Compiled;\n  sub_maps: SubMap[];\n  homePosition: Position;\n  mercZoom: number;\n}\n\ninterface SubMap {\n  gcps?: PointSet[];\n  edges?: Edge[];\n  compiled?: Compiled;\n  priority: number;\n  importance: number;\n  bounds?: number[][];\n}\n\nconst keys: (keyof HistMapStore)[] = [\n  \"title\",\n  \"attr\",\n  \"officialTitle\",\n  \"dataAttr\",\n  \"author\",\n  \"createdAt\",\n  \"era\",\n  \"license\",\n  \"dataLicense\",\n  \"contributor\",\n  \"mapper\",\n  \"reference\",\n  \"description\",\n  \"url\",\n  \"lang\",\n  \"imageExtension\",\n  \"homePosition\",\n  \"mercZoom\"\n];\n\nexport async function store2HistMap(\n  store: HistMapStore,\n  byCompiled = false\n): Promise<[HistMapStore, TinLike[]]> {\n  return store2HistMap_internal(store, byCompiled, false);\n}\n\nexport async function store2HistMap4Core(\n  store: HistMapStore\n): Promise<[HistMapStore, TinLike[]]> {\n  return store2HistMap_internal(store, false, true);\n}\n\nasync function store2HistMap_internal(\n  store: HistMapStore,\n  byCompiled: boolean,\n  coreLogic: boolean\n): Promise<[HistMapStore, TinLike[]]> {\n  const ret: any = coreLogic ? store : {};\n  const tins: TinLike[] = [];\n  keys.forEach(key => {\n    ret[key] = store[key];\n  });\n  if ((store as any)[\"imageExtention\"])\n    ret[\"imageExtension\"] = (store as any)[\"imageExtention\"];\n  if (store.compiled) {\n    const opt: Partial<Options> = {} as Options;\n    if (!store.compiled.wh) opt.wh = [store.width!, store.height!];\n    if (!store.compiled.strictMode) opt.strictMode = store.strictMode;\n    if (!store.compiled.vertexMode) opt.vertexMode = store.vertexMode;\n    if (!store.compiled.yaxisMode) opt.yaxisMode = store.yaxisMode;\n    let tin: TinLike = new Tin(opt);\n    tin.setCompiled(store.compiled);\n    if (byCompiled) {\n      tin = tin.getCompiled();\n    }\n    ret.strictMode = tin.strictMode;\n    ret.vertexMode = tin.vertexMode;\n    ret.yaxisMode = tin.yaxisMode;\n    ret.width = tin.wh![0];\n    ret.height = tin.wh![1];\n    ret.gcps = tin.points;\n    ret.edges = tin.edges;\n    tins.push(tin);\n  } else {\n    ret.strictMode = store.strictMode;\n    ret.vertexMode = store.vertexMode;\n    ret.yaxisMode = store.yaxisMode;\n    ret.width = store.width;\n    ret.height = store.height;\n    ret.gcps = store.gcps;\n    ret.edges = store.edges;\n    let tin = await createTinFromGcpsAsync(\n      store.strictMode!,\n      store.vertexMode!,\n      store.yaxisMode,\n      store.gcps,\n      store.edges,\n      [store.width!, store.height!]\n    );\n    if (byCompiled && typeof tin !== \"string\") tin = (tin as Tin).getCompiled();\n    tins.push(tin);\n  }\n\n  if (store.sub_maps) {\n    const sub_maps = [] as SubMap[];\n    for (let i = 0; i < store.sub_maps.length; i++) {\n      const sub_map = store.sub_maps[i];\n      const sub: any = {};\n      sub.importance = sub_map.importance;\n      sub.priority = sub_map.priority;\n      if (sub_map.compiled) {\n        const opt: Partial<Options> = {} as Options;\n        if (!sub_map.compiled.strictMode) opt.strictMode = store.strictMode;\n        if (!sub_map.compiled.vertexMode) opt.vertexMode = store.vertexMode;\n        if (!sub_map.compiled.yaxisMode) opt.yaxisMode = store.yaxisMode;\n        let tin: TinLike = new Tin(opt);\n        tin.setCompiled(sub_map.compiled);\n        if (byCompiled) {\n          tin = tin.getCompiled();\n        }\n        sub.bounds = tin.bounds;\n        sub.gcps = tin.points;\n        sub.edges = tin.edges;\n        tins.push(tin);\n      } else {\n        sub.bounds = sub_map.bounds;\n        sub.gcps = sub_map.gcps;\n        sub.edges = sub_map.edges;\n        let tin = await createTinFromGcpsAsync(\n          store.strictMode!,\n          store.vertexMode!,\n          store.yaxisMode,\n          sub_map.gcps,\n          sub_map.edges,\n          undefined,\n          sub_map.bounds\n        );\n        if (byCompiled && typeof tin !== \"string\")\n          tin = (tin as Tin).getCompiled();\n        tins.push(tin);\n      }\n      sub_maps.push(sub as SubMap);\n    }\n    ret.sub_maps = sub_maps;\n  }\n  return [ret as HistMapStore, tins];\n}\n\nexport async function histMap2Store(\n  histmap: HistMapStore,\n  tins: TinLike[]\n): Promise<HistMapStore> {\n  const ret: any = {};\n  keys.forEach(key => {\n    ret[key] = histmap[key];\n  });\n  if ((histmap as any)[\"imageExtention\"])\n    ret[\"imageExtension\"] = (histmap as any)[\"imageExtention\"];\n  const tin = tins.shift();\n  if (typeof tin === \"string\") {\n    ret.width = histmap.width;\n    ret.height = histmap.height;\n    ret.gcps = histmap.gcps;\n    ret.edges = histmap.edges;\n    ret.strictMode = histmap.strictMode;\n    ret.vertexMode = histmap.vertexMode;\n    ret.yaxisMode = histmap.yaxisMode;\n  } else {\n    ret.compiled = (tin as any).getCompiled ? (tin as Tin).getCompiled() : tin;\n  }\n\n  ret.sub_maps =\n    tins.length > 0\n      ? tins.map((tin, index) => {\n          const sub_map = histmap.sub_maps[index];\n          const sub: any = {\n            priority: sub_map.priority,\n            importance: sub_map.importance\n          };\n          if (typeof tin === \"string\") {\n            sub.gcps = sub_map.gcps;\n            sub.edges = sub_map.edges;\n            sub.bounds = sub_map.bounds;\n          } else {\n            sub.compiled = (tin as any).getCompiled\n              ? (tin as Tin).getCompiled()\n              : tin;\n          }\n          return sub as SubMap;\n        })\n      : [];\n\n  return ret as HistMapStore;\n}\n\nasync function createTinFromGcpsAsync(\n  strict: StrictMode,\n  vertex: VertexMode,\n  yaxis?: YaxisMode,\n  gcps: PointSet[] = [],\n  edges: Edge[] = [],\n  wh?: number[],\n  bounds?: number[][]\n): Promise<TinLike> {\n  if (gcps.length < 3) return \"tooLessGcps\";\n  //return new Promise((resolve, reject) => {\n  const tin = new Tin({\n    yaxisMode: yaxis\n  });\n  if (wh) {\n    tin.setWh(wh);\n  } else if (bounds) {\n    tin.setBounds(bounds);\n  } else {\n    throw \"Both wh and bounds are missing\";\n  }\n  tin.setStrictMode(strict);\n  tin.setVertexMode(vertex);\n  tin.setPoints(gcps);\n  tin.setEdges(edges);\n  try {\n    await tin.updateTinAsync();\n    return tin;\n  } catch (err: any) {\n    console.log(err); // eslint-disable-line no-console,no-undef\n    if (err == \"SOME POINTS OUTSIDE\") {\n      return \"pointsOutside\";\n    } else if (err.indexOf(\"TOO LINEAR\") == 0) {\n      return \"tooLinear\";\n    } else if (\n      err.indexOf(\"Vertex indices of edge\") > -1 ||\n      err.indexOf(\"is degenerate!\") > -1 ||\n      err.indexOf(\"already exists or intersects with an existing edge!\") > -1\n    ) {\n      return \"edgeError\";\n    } else {\n      throw err;\n    }\n  }\n}\n","import { HistMap } from \"./histmap\";\nimport Tin from \"@maplat/tin\";\nimport { addCoordinateTransforms, addProjection, toLonLat } from \"ol/proj\";\nimport Projection from \"ol/proj/Projection\";\nimport { transformDirect } from \"../proj_ex\";\nimport { polygon } from \"@turf/helpers\";\nimport booleanPointInPolygon from \"@turf/boolean-point-in-polygon\";\nimport { MERC_MAX } from \"../const_ex\";\nimport { Coordinate } from \"ol/coordinate\";\nimport { Feature, Polygon } from \"@turf/turf\";\nimport { store2HistMap4Core } from \"./store_handler\";\nimport { Size } from \"ol/size\";\nimport { CrossCoordinatesArray, ViewpointArray } from \"./mixin\";\n\nexport class HistMap_tin extends HistMap {\n  tins: Tin[];\n\n  constructor(options: any = {}) {\n    super(options);\n    this.tins = [];\n  }\n\n  static async createAsync(options: any) {\n    const histmaps = await store2HistMap4Core(options);\n    options = histmaps[0];\n    const obj = new HistMap_tin(options);\n    obj.tins = histmaps[1] as Tin[];\n    const proj = new Projection({\n      code: `Illst:${obj.mapID}`,\n      extent: [0.0, 0.0, obj.width, obj.height],\n      units: \"m\"\n    });\n    addProjection(proj);\n    addCoordinateTransforms(\n      proj,\n      \"EPSG:3857\",\n      xy => obj.tins[0].transform(xy, false) as Coordinate,\n      merc => obj.tins[0].transform(merc, true) as Coordinate\n    );\n    transformDirect(\"EPSG:4326\", proj);\n\n    if (options.sub_maps) {\n      options.sub_maps.map((sub_map: any, i: any) => {\n        const index = i + 1;\n        const projKey = `Illst:${obj.mapID}#${index}`;\n        const tin = obj.tins[index];\n        const proj = new Projection({\n          code: projKey,\n          extent: [tin.xy![0], tin.xy![1], tin.wh![0], tin.wh![1]],\n          units: \"m\"\n        });\n        addProjection(proj);\n        addCoordinateTransforms(\n          proj,\n          \"EPSG:3857\",\n          xy => tin.transform(xy, false, true) as Coordinate,\n          merc => tin.transform(merc, true, true) as Coordinate\n        );\n        transformDirect(\"EPSG:4326\", proj);\n\n        const xyBounds = Object.assign([], sub_map.bounds);\n        xyBounds.push(sub_map.bounds[0]);\n        const mercBounds = xyBounds.map((xy: any) => tin.transform(xy, false));\n        const xyBoundsPolygon = polygon([xyBounds]);\n        const mercBoundsPolygon = polygon([mercBounds]);\n        /* eslint-disable @typescript-eslint/ban-ts-comment */\n        // @ts-ignore\n        tin.xyBounds = xyBoundsPolygon;\n        /* eslint-disable @typescript-eslint/ban-ts-comment */\n        // @ts-ignore\n        tin.mercBounds = mercBoundsPolygon;\n      });\n    }\n    return obj;\n  }\n\n  xy2MercAsync_specifyLayer(xy: Coordinate, layerId: number) {\n    const layerKey = `Illst:${this.mapID}${layerId ? `#${layerId}` : \"\"}`;\n    return new Promise((resolve, _reject) => {\n      resolve(transformDirect(layerKey, \"EPSG:3857\", xy)!);\n    }) as Promise<Coordinate>;\n  }\n\n  merc2XyAsync_specifyLayer(merc: Coordinate, layerId: number) {\n    const layerKey = `Illst:${this.mapID}${layerId ? `#${layerId}` : \"\"}`;\n    return new Promise((resolve, _reject) => {\n      resolve(transformDirect(\"EPSG:3857\", layerKey, merc)!);\n    }) as Promise<Coordinate>;\n  }\n\n  xy2MercAsync_returnLayer(xy: Coordinate) {\n    return new Promise((resolve, reject) => {\n      const tinSorted = this.tins\n        .map((tin, index) => [index, tin] as [number, Tin])\n        .sort((a, b) => (a[1].priority < b[1].priority ? 1 : -1));\n\n      for (let i = 0; i < tinSorted.length; i++) {\n        const index = tinSorted[i][0];\n        const tin = tinSorted[i][1];\n        if (index == 0 || booleanPointInPolygon(xy, tin.xyBounds)) {\n          this.xy2MercAsync_specifyLayer(xy, index)\n            .then(merc => {\n              resolve([index, merc] as [number, Coordinate]);\n            })\n            .catch(err => {\n              reject(err);\n            });\n          break;\n        }\n      }\n    }) as Promise<[number, Coordinate]>;\n  }\n\n  merc2XyAsync_returnLayer(\n    merc: Coordinate\n  ): Promise<([number, Coordinate] | undefined)[]> {\n    return Promise.all(\n      this.tins.map(\n        (tin, index) =>\n          new Promise((resolve, reject) => {\n            this.merc2XyAsync_specifyLayer(merc, index)\n              .then(xy => {\n                if (index === 0 || booleanPointInPolygon(xy, tin.xyBounds)) {\n                  resolve([tin, index, xy] as [Tin, number, Coordinate?]);\n                } else {\n                  resolve([tin, index] as [Tin, number, Coordinate?]);\n                }\n              })\n              .catch(err => {\n                reject(err);\n              });\n          }) as Promise<[Tin, number, Coordinate?]>\n      )\n    ).then(results =>\n      results\n        .sort((a, b) => (a[0].priority < b[0].priority ? 1 : -1))\n        .reduce(\n          (\n            ret: (undefined | [number, Coordinate, Tin])[],\n            result,\n            priIndex: number,\n            arry\n          ) => {\n            const tin = result[0];\n            const index = result[1];\n            const xy = result[2];\n            if (!xy) return ret;\n            for (let i = 0; i < priIndex; i++) {\n              const targetTin = arry[i][0];\n              const targetIndex = arry[i][1];\n              if (\n                targetIndex === 0 ||\n                booleanPointInPolygon(xy, targetTin.xyBounds)\n              ) {\n                if (ret.length) {\n                  const hide = !ret[0];\n                  const storedTin = hide ? ret[1]![2] : ret[0]![2];\n                  if (!hide || tin.importance < storedTin.importance) {\n                    return ret;\n                  } else {\n                    return [undefined, [index, xy, tin]] as (\n                      | undefined\n                      | [number, Coordinate, Tin]\n                    )[];\n                  }\n                } else {\n                  return [undefined, [index, xy, tin]] as (\n                    | undefined\n                    | [number, Coordinate, Tin]\n                  )[];\n                }\n              }\n            }\n            if (!ret.length || !ret[0]) {\n              return [[index, xy, tin]] as (\n                | undefined\n                | [number, Coordinate, Tin]\n              )[];\n            } else {\n              ret.push([index, xy, tin]);\n              return ret\n                .sort((a, b) => (a![2].importance < b![2].importance ? 1 : -1))\n                .filter((_row, i) => i < 2);\n            }\n          },\n          []\n        )\n        .map(row => {\n          if (!row) return;\n          return [row[0], row[1]] as [number, Coordinate];\n        })\n    );\n  }\n\n  setupMapParameter(callback: any) {\n    const xy = [this.width / 2, this.height / 2];\n    this.xy2MercAsync_returnLayer(xy)\n      .then((results: any) => {\n        const index = results[0];\n        const mercCenter = results[1];\n        const dir4 = [\n          [xy[0] - 150, xy[1]],\n          [xy[0] + 150, xy[1]],\n          [xy[0], xy[1] - 150],\n          [xy[0], xy[1] + 150]\n        ];\n        const envelope = [\n          [0, 0],\n          [this.width, 0],\n          [this.width, this.height],\n          [0, this.height]\n        ];\n        const proms = [];\n        for (let i = 0; i < 9; i++) {\n          const prom =\n            i < 4\n              ? this.xy2MercAsync_specifyLayer(dir4[i], index)\n              : i == 4\n              ? Promise.resolve(mercCenter)\n              : this.xy2MercAsync_specifyLayer(envelope[i - 5], 0);\n          proms.push(prom);\n        }\n        Promise.all(proms)\n          .then((mercs: any) => {\n            const delta1 = Math.sqrt(\n              Math.pow(mercs[0][0] - mercs[1][0], 2) +\n                Math.pow(mercs[0][1] - mercs[1][1], 2)\n            );\n            const delta2 = Math.sqrt(\n              Math.pow(mercs[2][0] - mercs[3][0], 2) +\n                Math.pow(mercs[2][1] - mercs[3][1], 2)\n            );\n            const delta = (delta1 + delta2) / 2;\n            if (!this.mercZoom)\n              this.mercZoom =\n                Math.log((300 * (2 * MERC_MAX)) / 256 / delta) / Math.log(2) -\n                3;\n            if (!this.homePosition) this.homePosition = toLonLat(mercs[4]);\n            this.envelope = polygon([\n              [mercs[5], mercs[6], mercs[7], mercs[8], mercs[5]]\n            ]) as Feature<Polygon>;\n            callback(this);\n          })\n          .catch(err => {\n            throw err;\n          });\n      })\n      .catch(err => {\n        throw err;\n      });\n  }\n\n  mercs2SysCoordsAsync_multiLayer(\n    mercs: CrossCoordinatesArray\n  ): Promise<(CrossCoordinatesArray | undefined)[]> {\n    const promises = this.merc2XyAsync_returnLayer(mercs[0][0]).then(\n      results => {\n        let hide = false;\n        return Promise.all(\n          results.map((result, i) => {\n            if (!result) {\n              hide = true;\n              return;\n            }\n            const index = result[0];\n            const centerXy = result[1];\n            if (i !== 0 && !hide) return Promise.resolve([centerXy]);\n            return Promise.all(\n              mercs[0].map((merc, j) => {\n                if (j === 0) return Promise.resolve(centerXy);\n                return this.merc2XyAsync_specifyLayer(merc, index);\n              })\n            );\n          })\n        );\n      }\n    );\n    return promises.then(results =>\n      results.map(result => {\n        if (!result) {\n          return;\n        }\n        return [result.map(xy => this.xy2SysCoord(xy)), mercs[1]];\n      })\n    );\n  }\n\n  // unifyTerm\n  // https://github.com/code4history/MaplatCore/issues/19\n\n  // ignoreBackside === true()\n  // ignoreBackside === false\n  merc2XyAsync_base(\n    merc: Coordinate,\n    ignoreBackground: boolean\n  ): Promise<Coordinate | void> {\n    return this.merc2XyAsync_returnLayer(merc).then(ret => {\n      if (ignoreBackground && !ret[0]) return;\n      return !ret[0] ? ret[1]![1] : ret[0][1];\n    });\n  }\n\n  merc2XyAsync_ignoreBackground(merc: Coordinate): Promise<Coordinate | void> {\n    return this.merc2XyAsync_base(merc, true);\n  }\n\n  merc2XyAsync(merc: Coordinate): Promise<Coordinate> {\n    return this.merc2XyAsync_base(merc, false) as Promise<Coordinate>;\n  }\n\n  xy2MercAsync(xy: Coordinate): Promise<Coordinate> {\n    return this.xy2MercAsync_returnLayer(xy).then(ret => ret[1]);\n  }\n\n  // 5zoom, rotate\n  viewpoint2MercsAsync(\n    viewpoint?: ViewpointArray,\n    size?: Size\n  ): Promise<CrossCoordinatesArray> {\n    const sysCoords = this.viewpoint2SysCoords(viewpoint, size);\n    const cross = this.sysCoords2Xys(sysCoords);\n\n    const promise = this.xy2MercAsync_returnLayer(cross[0][0]);\n    return promise.then(results => {\n      const index = results[0];\n      const centerMerc = results[1];\n      const promises = cross[0].map((val, i) => {\n        if (i === 0) return Promise.resolve(centerMerc);\n        return this.xy2MercAsync_specifyLayer(val, index);\n      });\n      return Promise.all(promises).then(mercs => [mercs, size]);\n    });\n  }\n\n  mercs2ViewpointAsync(mercs: CrossCoordinatesArray): Promise<ViewpointArray> {\n    const promises = this.merc2XyAsync_returnLayer(mercs[0][0]).then(\n      results => {\n        const result = results[0] || results[1];\n        const index = result![0];\n        const centerXy = result![1];\n        return Promise.all(\n          mercs[0].map((merc, i) => {\n            if (i === 0) return centerXy;\n            return this.merc2XyAsync_specifyLayer(merc, index);\n          })\n        );\n      }\n    );\n    return promises.then(xys => {\n      const sysCoords = this.xys2SysCoords([xys, mercs[1]]);\n      return this.sysCoords2Viewpoint(sysCoords);\n    });\n  }\n}\n","var global =\n  (typeof globalThis !== 'undefined' && globalThis) ||\n  (typeof self !== 'undefined' && self) ||\n  (typeof global !== 'undefined' && global)\n\nvar support = {\n  searchParams: 'URLSearchParams' in global,\n  iterable: 'Symbol' in global && 'iterator' in Symbol,\n  blob:\n    'FileReader' in global &&\n    'Blob' in global &&\n    (function() {\n      try {\n        new Blob()\n        return true\n      } catch (e) {\n        return false\n      }\n    })(),\n  formData: 'FormData' in global,\n  arrayBuffer: 'ArrayBuffer' in global\n}\n\nfunction isDataView(obj) {\n  return obj && DataView.prototype.isPrototypeOf(obj)\n}\n\nif (support.arrayBuffer) {\n  var viewClasses = [\n    '[object Int8Array]',\n    '[object Uint8Array]',\n    '[object Uint8ClampedArray]',\n    '[object Int16Array]',\n    '[object Uint16Array]',\n    '[object Int32Array]',\n    '[object Uint32Array]',\n    '[object Float32Array]',\n    '[object Float64Array]'\n  ]\n\n  var isArrayBufferView =\n    ArrayBuffer.isView ||\n    function(obj) {\n      return obj && viewClasses.indexOf(Object.prototype.toString.call(obj)) > -1\n    }\n}\n\nfunction normalizeName(name) {\n  if (typeof name !== 'string') {\n    name = String(name)\n  }\n  if (/[^a-z0-9\\-#$%&'*+.^_`|~!]/i.test(name) || name === '') {\n    throw new TypeError('Invalid character in header field name: \"' + name + '\"')\n  }\n  return name.toLowerCase()\n}\n\nfunction normalizeValue(value) {\n  if (typeof value !== 'string') {\n    value = String(value)\n  }\n  return value\n}\n\n// Build a destructive iterator for the value list\nfunction iteratorFor(items) {\n  var iterator = {\n    next: function() {\n      var value = items.shift()\n      return {done: value === undefined, value: value}\n    }\n  }\n\n  if (support.iterable) {\n    iterator[Symbol.iterator] = function() {\n      return iterator\n    }\n  }\n\n  return iterator\n}\n\nexport function Headers(headers) {\n  this.map = {}\n\n  if (headers instanceof Headers) {\n    headers.forEach(function(value, name) {\n      this.append(name, value)\n    }, this)\n  } else if (Array.isArray(headers)) {\n    headers.forEach(function(header) {\n      this.append(header[0], header[1])\n    }, this)\n  } else if (headers) {\n    Object.getOwnPropertyNames(headers).forEach(function(name) {\n      this.append(name, headers[name])\n    }, this)\n  }\n}\n\nHeaders.prototype.append = function(name, value) {\n  name = normalizeName(name)\n  value = normalizeValue(value)\n  var oldValue = this.map[name]\n  this.map[name] = oldValue ? oldValue + ', ' + value : value\n}\n\nHeaders.prototype['delete'] = function(name) {\n  delete this.map[normalizeName(name)]\n}\n\nHeaders.prototype.get = function(name) {\n  name = normalizeName(name)\n  return this.has(name) ? this.map[name] : null\n}\n\nHeaders.prototype.has = function(name) {\n  return this.map.hasOwnProperty(normalizeName(name))\n}\n\nHeaders.prototype.set = function(name, value) {\n  this.map[normalizeName(name)] = normalizeValue(value)\n}\n\nHeaders.prototype.forEach = function(callback, thisArg) {\n  for (var name in this.map) {\n    if (this.map.hasOwnProperty(name)) {\n      callback.call(thisArg, this.map[name], name, this)\n    }\n  }\n}\n\nHeaders.prototype.keys = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push(name)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.values = function() {\n  var items = []\n  this.forEach(function(value) {\n    items.push(value)\n  })\n  return iteratorFor(items)\n}\n\nHeaders.prototype.entries = function() {\n  var items = []\n  this.forEach(function(value, name) {\n    items.push([name, value])\n  })\n  return iteratorFor(items)\n}\n\nif (support.iterable) {\n  Headers.prototype[Symbol.iterator] = Headers.prototype.entries\n}\n\nfunction consumed(body) {\n  if (body.bodyUsed) {\n    return Promise.reject(new TypeError('Already read'))\n  }\n  body.bodyUsed = true\n}\n\nfunction fileReaderReady(reader) {\n  return new Promise(function(resolve, reject) {\n    reader.onload = function() {\n      resolve(reader.result)\n    }\n    reader.onerror = function() {\n      reject(reader.error)\n    }\n  })\n}\n\nfunction readBlobAsArrayBuffer(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsArrayBuffer(blob)\n  return promise\n}\n\nfunction readBlobAsText(blob) {\n  var reader = new FileReader()\n  var promise = fileReaderReady(reader)\n  reader.readAsText(blob)\n  return promise\n}\n\nfunction readArrayBufferAsText(buf) {\n  var view = new Uint8Array(buf)\n  var chars = new Array(view.length)\n\n  for (var i = 0; i < view.length; i++) {\n    chars[i] = String.fromCharCode(view[i])\n  }\n  return chars.join('')\n}\n\nfunction bufferClone(buf) {\n  if (buf.slice) {\n    return buf.slice(0)\n  } else {\n    var view = new Uint8Array(buf.byteLength)\n    view.set(new Uint8Array(buf))\n    return view.buffer\n  }\n}\n\nfunction Body() {\n  this.bodyUsed = false\n\n  this._initBody = function(body) {\n    /*\n      fetch-mock wraps the Response object in an ES6 Proxy to\n      provide useful test harness features such as flush. However, on\n      ES5 browsers without fetch or Proxy support pollyfills must be used;\n      the proxy-pollyfill is unable to proxy an attribute unless it exists\n      on the object before the Proxy is created. This change ensures\n      Response.bodyUsed exists on the instance, while maintaining the\n      semantic of setting Request.bodyUsed in the constructor before\n      _initBody is called.\n    */\n    this.bodyUsed = this.bodyUsed\n    this._bodyInit = body\n    if (!body) {\n      this._bodyText = ''\n    } else if (typeof body === 'string') {\n      this._bodyText = body\n    } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {\n      this._bodyBlob = body\n    } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {\n      this._bodyFormData = body\n    } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n      this._bodyText = body.toString()\n    } else if (support.arrayBuffer && support.blob && isDataView(body)) {\n      this._bodyArrayBuffer = bufferClone(body.buffer)\n      // IE 10-11 can't handle a DataView body.\n      this._bodyInit = new Blob([this._bodyArrayBuffer])\n    } else if (support.arrayBuffer && (ArrayBuffer.prototype.isPrototypeOf(body) || isArrayBufferView(body))) {\n      this._bodyArrayBuffer = bufferClone(body)\n    } else {\n      this._bodyText = body = Object.prototype.toString.call(body)\n    }\n\n    if (!this.headers.get('content-type')) {\n      if (typeof body === 'string') {\n        this.headers.set('content-type', 'text/plain;charset=UTF-8')\n      } else if (this._bodyBlob && this._bodyBlob.type) {\n        this.headers.set('content-type', this._bodyBlob.type)\n      } else if (support.searchParams && URLSearchParams.prototype.isPrototypeOf(body)) {\n        this.headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8')\n      }\n    }\n  }\n\n  if (support.blob) {\n    this.blob = function() {\n      var rejected = consumed(this)\n      if (rejected) {\n        return rejected\n      }\n\n      if (this._bodyBlob) {\n        return Promise.resolve(this._bodyBlob)\n      } else if (this._bodyArrayBuffer) {\n        return Promise.resolve(new Blob([this._bodyArrayBuffer]))\n      } else if (this._bodyFormData) {\n        throw new Error('could not read FormData body as blob')\n      } else {\n        return Promise.resolve(new Blob([this._bodyText]))\n      }\n    }\n\n    this.arrayBuffer = function() {\n      if (this._bodyArrayBuffer) {\n        var isConsumed = consumed(this)\n        if (isConsumed) {\n          return isConsumed\n        }\n        if (ArrayBuffer.isView(this._bodyArrayBuffer)) {\n          return Promise.resolve(\n            this._bodyArrayBuffer.buffer.slice(\n              this._bodyArrayBuffer.byteOffset,\n              this._bodyArrayBuffer.byteOffset + this._bodyArrayBuffer.byteLength\n            )\n          )\n        } else {\n          return Promise.resolve(this._bodyArrayBuffer)\n        }\n      } else {\n        return this.blob().then(readBlobAsArrayBuffer)\n      }\n    }\n  }\n\n  this.text = function() {\n    var rejected = consumed(this)\n    if (rejected) {\n      return rejected\n    }\n\n    if (this._bodyBlob) {\n      return readBlobAsText(this._bodyBlob)\n    } else if (this._bodyArrayBuffer) {\n      return Promise.resolve(readArrayBufferAsText(this._bodyArrayBuffer))\n    } else if (this._bodyFormData) {\n      throw new Error('could not read FormData body as text')\n    } else {\n      return Promise.resolve(this._bodyText)\n    }\n  }\n\n  if (support.formData) {\n    this.formData = function() {\n      return this.text().then(decode)\n    }\n  }\n\n  this.json = function() {\n    return this.text().then(JSON.parse)\n  }\n\n  return this\n}\n\n// HTTP methods whose capitalization should be normalized\nvar methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']\n\nfunction normalizeMethod(method) {\n  var upcased = method.toUpperCase()\n  return methods.indexOf(upcased) > -1 ? upcased : method\n}\n\nexport function Request(input, options) {\n  if (!(this instanceof Request)) {\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\n  }\n\n  options = options || {}\n  var body = options.body\n\n  if (input instanceof Request) {\n    if (input.bodyUsed) {\n      throw new TypeError('Already read')\n    }\n    this.url = input.url\n    this.credentials = input.credentials\n    if (!options.headers) {\n      this.headers = new Headers(input.headers)\n    }\n    this.method = input.method\n    this.mode = input.mode\n    this.signal = input.signal\n    if (!body && input._bodyInit != null) {\n      body = input._bodyInit\n      input.bodyUsed = true\n    }\n  } else {\n    this.url = String(input)\n  }\n\n  this.credentials = options.credentials || this.credentials || 'same-origin'\n  if (options.headers || !this.headers) {\n    this.headers = new Headers(options.headers)\n  }\n  this.method = normalizeMethod(options.method || this.method || 'GET')\n  this.mode = options.mode || this.mode || null\n  this.signal = options.signal || this.signal\n  this.referrer = null\n\n  if ((this.method === 'GET' || this.method === 'HEAD') && body) {\n    throw new TypeError('Body not allowed for GET or HEAD requests')\n  }\n  this._initBody(body)\n\n  if (this.method === 'GET' || this.method === 'HEAD') {\n    if (options.cache === 'no-store' || options.cache === 'no-cache') {\n      // Search for a '_' parameter in the query string\n      var reParamSearch = /([?&])_=[^&]*/\n      if (reParamSearch.test(this.url)) {\n        // If it already exists then set the value with the current time\n        this.url = this.url.replace(reParamSearch, '$1_=' + new Date().getTime())\n      } else {\n        // Otherwise add a new '_' parameter to the end with the current time\n        var reQueryString = /\\?/\n        this.url += (reQueryString.test(this.url) ? '&' : '?') + '_=' + new Date().getTime()\n      }\n    }\n  }\n}\n\nRequest.prototype.clone = function() {\n  return new Request(this, {body: this._bodyInit})\n}\n\nfunction decode(body) {\n  var form = new FormData()\n  body\n    .trim()\n    .split('&')\n    .forEach(function(bytes) {\n      if (bytes) {\n        var split = bytes.split('=')\n        var name = split.shift().replace(/\\+/g, ' ')\n        var value = split.join('=').replace(/\\+/g, ' ')\n        form.append(decodeURIComponent(name), decodeURIComponent(value))\n      }\n    })\n  return form\n}\n\nfunction parseHeaders(rawHeaders) {\n  var headers = new Headers()\n  // Replace instances of \\r\\n and \\n followed by at least one space or horizontal tab with a space\n  // https://tools.ietf.org/html/rfc7230#section-3.2\n  var preProcessedHeaders = rawHeaders.replace(/\\r?\\n[\\t ]+/g, ' ')\n  // Avoiding split via regex to work around a common IE11 bug with the core-js 3.6.0 regex polyfill\n  // https://github.com/github/fetch/issues/748\n  // https://github.com/zloirock/core-js/issues/751\n  preProcessedHeaders\n    .split('\\r')\n    .map(function(header) {\n      return header.indexOf('\\n') === 0 ? header.substr(1, header.length) : header\n    })\n    .forEach(function(line) {\n      var parts = line.split(':')\n      var key = parts.shift().trim()\n      if (key) {\n        var value = parts.join(':').trim()\n        headers.append(key, value)\n      }\n    })\n  return headers\n}\n\nBody.call(Request.prototype)\n\nexport function Response(bodyInit, options) {\n  if (!(this instanceof Response)) {\n    throw new TypeError('Please use the \"new\" operator, this DOM object constructor cannot be called as a function.')\n  }\n  if (!options) {\n    options = {}\n  }\n\n  this.type = 'default'\n  this.status = options.status === undefined ? 200 : options.status\n  this.ok = this.status >= 200 && this.status < 300\n  this.statusText = options.statusText === undefined ? '' : '' + options.statusText\n  this.headers = new Headers(options.headers)\n  this.url = options.url || ''\n  this._initBody(bodyInit)\n}\n\nBody.call(Response.prototype)\n\nResponse.prototype.clone = function() {\n  return new Response(this._bodyInit, {\n    status: this.status,\n    statusText: this.statusText,\n    headers: new Headers(this.headers),\n    url: this.url\n  })\n}\n\nResponse.error = function() {\n  var response = new Response(null, {status: 0, statusText: ''})\n  response.type = 'error'\n  return response\n}\n\nvar redirectStatuses = [301, 302, 303, 307, 308]\n\nResponse.redirect = function(url, status) {\n  if (redirectStatuses.indexOf(status) === -1) {\n    throw new RangeError('Invalid status code')\n  }\n\n  return new Response(null, {status: status, headers: {location: url}})\n}\n\nexport var DOMException = global.DOMException\ntry {\n  new DOMException()\n} catch (err) {\n  DOMException = function(message, name) {\n    this.message = message\n    this.name = name\n    var error = Error(message)\n    this.stack = error.stack\n  }\n  DOMException.prototype = Object.create(Error.prototype)\n  DOMException.prototype.constructor = DOMException\n}\n\nexport function fetch(input, init) {\n  return new Promise(function(resolve, reject) {\n    var request = new Request(input, init)\n\n    if (request.signal && request.signal.aborted) {\n      return reject(new DOMException('Aborted', 'AbortError'))\n    }\n\n    var xhr = new XMLHttpRequest()\n\n    function abortXhr() {\n      xhr.abort()\n    }\n\n    xhr.onload = function() {\n      var options = {\n        status: xhr.status,\n        statusText: xhr.statusText,\n        headers: parseHeaders(xhr.getAllResponseHeaders() || '')\n      }\n      options.url = 'responseURL' in xhr ? xhr.responseURL : options.headers.get('X-Request-URL')\n      var body = 'response' in xhr ? xhr.response : xhr.responseText\n      setTimeout(function() {\n        resolve(new Response(body, options))\n      }, 0)\n    }\n\n    xhr.onerror = function() {\n      setTimeout(function() {\n        reject(new TypeError('Network request failed'))\n      }, 0)\n    }\n\n    xhr.ontimeout = function() {\n      setTimeout(function() {\n        reject(new TypeError('Network request failed'))\n      }, 0)\n    }\n\n    xhr.onabort = function() {\n      setTimeout(function() {\n        reject(new DOMException('Aborted', 'AbortError'))\n      }, 0)\n    }\n\n    function fixUrl(url) {\n      try {\n        return url === '' && global.location.href ? global.location.href : url\n      } catch (e) {\n        return url\n      }\n    }\n\n    xhr.open(request.method, fixUrl(request.url), true)\n\n    if (request.credentials === 'include') {\n      xhr.withCredentials = true\n    } else if (request.credentials === 'omit') {\n      xhr.withCredentials = false\n    }\n\n    if ('responseType' in xhr) {\n      if (support.blob) {\n        xhr.responseType = 'blob'\n      } else if (\n        support.arrayBuffer &&\n        request.headers.get('Content-Type') &&\n        request.headers.get('Content-Type').indexOf('application/octet-stream') !== -1\n      ) {\n        xhr.responseType = 'arraybuffer'\n      }\n    }\n\n    if (init && typeof init.headers === 'object' && !(init.headers instanceof Headers)) {\n      Object.getOwnPropertyNames(init.headers).forEach(function(name) {\n        xhr.setRequestHeader(name, normalizeValue(init.headers[name]))\n      })\n    } else {\n      request.headers.forEach(function(value, name) {\n        xhr.setRequestHeader(name, value)\n      })\n    }\n\n    if (request.signal) {\n      request.signal.addEventListener('abort', abortXhr)\n\n      xhr.onreadystatechange = function() {\n        // DONE (success or failure)\n        if (xhr.readyState === 4) {\n          request.signal.removeEventListener('abort', abortXhr)\n        }\n      }\n    }\n\n    xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)\n  })\n}\n\nfetch.polyfill = true\n\nif (!global.fetch) {\n  global.fetch = fetch\n  global.Headers = Headers\n  global.Request = Request\n  global.Response = Response\n}\n","import { normalizeArg } from \"./functions\";\nimport Weiwudi from \"weiwudi\";\nimport { NowMap } from \"./source/nowmap\";\nimport { TmsMap } from \"./source/tmsmap\";\nimport { MapboxMap } from \"./source/mapboxmap\";\nimport { HistMap_tin } from \"./source/histmap_tin\";\nimport \"whatwg-fetch\";\n\nimport osm from \"../parts/osm.jpg\";\nimport gsi from \"../parts/gsi.jpg\";\nimport gsi_ortho from \"../parts/gsi_ortho.jpg\";\n\nconst baseDict = {\n  osm: {\n    mapID: \"osm\",\n    title: {\n      ja: \"\",\n      en: \"OpenStreetMap\"\n    },\n    label: {\n      ja: \"OSM()\",\n      en: \"OSM(Now)\"\n    },\n    attr: \" OpenStreetMap contributors\",\n    maptype: \"base\",\n    thumbnail: osm,\n    urls: [\n      \"https://a.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n      \"https://b.tile.openstreetmap.org/{z}/{x}/{y}.png\",\n      \"https://c.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n    ]\n  },\n  gsi: {\n    mapID: \"gsi\",\n    title: {\n      ja: \"\",\n      en: \"Geospatial Information Authority of Japan Map\"\n    },\n    label: {\n      ja: \"\",\n      en: \"GSI Map\"\n    },\n    attr: {\n      ja: \"\",\n      en: \"The Geospatial Information Authority of Japan\"\n    },\n    maptype: \"base\",\n    url: \"https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png\",\n    maxZoom: 18,\n    thumbnail: gsi\n  },\n  gsi_ortho: {\n    mapID: \"gsi_ortho\",\n    title: {\n      ja: \"\",\n      en: \"Geospatial Information Authority of Japan Ortho aerial photo\"\n    },\n    label: {\n      ja: \"\",\n      en: \"GSI Ortho\"\n    },\n    attr: {\n      ja: \"\",\n      en: \"The Geospatial Information Authority of Japan\"\n    },\n    maptype: \"base\",\n    url: \"https://cyberjapandata.gsi.go.jp/xyz/ort/{z}/{x}/{y}.jpg\",\n    maxZoom: 18,\n    thumbnail: gsi_ortho\n  }\n};\n\nexport async function mapSourceFactory(options: any, commonOptions: any) {\n  if (typeof options === \"string\") {\n    options = (baseDict as any)[options];\n  }\n\n  options = normalizeArg(Object.assign(options, commonOptions));\n  options.label = options.label || options.year;\n  if (\n    options.maptype === \"base\" ||\n    options.maptype === \"overlay\" ||\n    options.maptype === \"mapbox\"\n  ) {\n    const targetSrc =\n      options.maptype === \"base\"\n        ? NowMap\n        : options.maptype === \"overlay\"\n        ? TmsMap\n        : MapboxMap;\n    if (targetSrc instanceof TmsMap) {\n      if (!options.homePosition) options.homePosition = options.homePos;\n      if (!options.mercZoom) options.mercZoom = options.defZoom;\n    } else {\n      options.homePosition = options.homePos;\n      options.mercZoom = options.defZoom;\n    }\n    delete options.homePos;\n    delete options.defZoom;\n    if (options.zoomRestriction) {\n      options.maxZoom = options.maxZoom || options.mercMaxZoom;\n      options.minZoom = options.minZoom || options.mercMinZoom;\n    }\n    options.zoomRestriction =\n      options.mercMaxZoom =\n      options.mercMinZoom =\n        undefined;\n    if (options.translator) {\n      options.url = options.translator(options.url);\n    }\n    if (!options.imageExtension) options.imageExtension = \"jpg\";\n    if (options.mapID && !options.url && !options.urls) {\n      options.url = options.tms\n        ? `tiles/${options.mapID}/{z}/{x}/{-y}.${options.imageExtension}`\n        : `tiles/${options.mapID}/{z}/{x}/{y}.${options.imageExtension}`;\n    }\n    options.weiwudi = await registerMapToSW(options);\n    if (options.weiwudi) {\n      options.url = options.weiwudi.url;\n      delete options.urls;\n    }\n    const obj = await targetSrc.createAsync(options);\n    await obj.initialWait;\n    return obj;\n  } else if (options.noload) {\n    options.mercMaxZoom = options.mercMinZoom = undefined;\n    return new HistMap_tin(options);\n  }\n\n  return new Promise((resolve, reject) => {\n    const url = options.settingFile || `maps/${options.mapID}.json`;\n    const xhr = new XMLHttpRequest(); // eslint-disable-line no-undef\n    xhr.open(\"GET\", url, true);\n    xhr.responseType = \"json\";\n\n    xhr.onload = async function (_e) {\n      if (this.status === 200 || this.status === 0) {\n        // 0 for UIWebView\n        try {\n          let resp = this.response;\n          if (typeof resp != \"object\") resp = JSON.parse(resp);\n          options = normalizeArg(Object.assign(resp, options));\n          options.label = options.label || resp.year;\n          if (options.translator) {\n            options.url = options.translator(options.url);\n          }\n          if (!options.maptype) options.maptype = \"maplat\";\n\n          if (\n            options.maptype === \"base\" ||\n            options.maptype === \"overlay\" ||\n            options.maptype === \"mapbox\"\n          ) {\n            const targetSrc =\n              options.maptype === \"base\"\n                ? NowMap\n                : options.maptype === \"overlay\"\n                ? TmsMap\n                : MapboxMap;\n            if (targetSrc instanceof TmsMap) {\n              if (!options.homePosition) options.homePosition = options.homePos;\n              if (!options.mercZoom) options.mercZoom = options.defZoom;\n            } else {\n              options.homePosition = options.homePos;\n              options.mercZoom = options.defZoom;\n            }\n            delete options.homePos;\n            delete options.defZoom;\n            if (options.zoomRestriction) {\n              options.maxZoom = options.maxZoom || options.mercMaxZoom;\n              options.minZoom = options.minZoom || options.mercMinZoom;\n            }\n            options.zoomRestriction =\n              options.mercMaxZoom =\n              options.mercMinZoom =\n                undefined;\n            try {\n              if (!options.imageExtension) options.imageExtension = \"jpg\";\n              if (options.mapID && !options.url && !options.urls) {\n                options.url = options.tms\n                  ? `tiles/${options.mapID}/{z}/{x}/{-y}.${options.imageExtension}`\n                  : `tiles/${options.mapID}/{z}/{x}/{y}.${options.imageExtension}`;\n              }\n              options.weiwudi = await registerMapToSW(options);\n              if (options.weiwudi) {\n                options.url = options.weiwudi.url;\n                delete options.urls;\n              }\n              const obj = await targetSrc.createAsync(options);\n              try {\n                await obj.initialWait;\n                resolve(obj);\n              } catch (e) {\n                resolve(obj);\n              }\n            } catch (e) {\n              reject(e);\n            }\n            return;\n          }\n\n          try {\n            delete options.homePos;\n            delete options.defZoom;\n            if (!options.imageExtension) options.imageExtension = \"jpg\";\n            if (options.mapID && !options.url && !options.urls) {\n              options.url = `tiles/${options.mapID}/{z}/{x}/{y}.${options.imageExtension}`;\n            }\n            options.width = options.width || options.compiled.wh[0];\n            options.height = options.height || options.compiled.wh[1];\n            options.weiwudi = await registerMapToSW(options);\n            if (options.weiwudi) {\n              options.url = options.weiwudi.url;\n              delete options.urls;\n            }\n            const obj = await HistMap_tin.createAsync(options);\n            try {\n              await obj.initialWait;\n              obj.setupMapParameter(resolve);\n            } catch (e) {\n              obj.setupMapParameter(resolve);\n            }\n          } catch (e) {\n            reject(e);\n          }\n        } catch (err) {\n          reject(err);\n        }\n      } else {\n        reject(\"Fail to load map json\");\n        // self.postMessage({'event':'cannotLoad'});\n      }\n    };\n    xhr.send();\n  });\n}\n\nexport async function registerMapToSW(options: any) {\n  const setting: any = {};\n  if (options.maptype === \"mapbox\" || !options.enableCache) return;\n  else if (options.maptype === \"base\" || options.maptype === \"overlay\")\n    setting.type = \"wmts\";\n  else setting.type = \"xyz\";\n  setting.url = options.urls ? options.urls : options.url;\n  setting.width = options.width;\n  setting.height = options.height;\n  setting.maxZoom = options.maxZoom;\n  setting.minZoom = options.minZoom;\n  const lngLats = options.envelopeLngLats;\n  if (lngLats) {\n    const minMax = lngLats.reduce(\n      (prev: number[], curr: number[]) => {\n        prev[0] = prev[0] > curr[0] ? curr[0] : prev[0];\n        prev[1] = prev[1] < curr[0] ? curr[0] : prev[1];\n        prev[2] = prev[2] > curr[1] ? curr[1] : prev[2];\n        prev[3] = prev[3] < curr[1] ? curr[1] : prev[3];\n        return prev;\n      },\n      [Infinity, -Infinity, Infinity, -Infinity]\n    );\n    [\"minLng\", \"maxLng\", \"minLat\", \"maxLat\"].map((key, index) => {\n      setting[key] = minMax[index];\n    });\n  }\n  let ret;\n  try {\n    ret = await Weiwudi.registerMap(options.mapID, setting);\n  } catch (e) {\n    // eslint-disable-line no-empty\n  }\n  return ret;\n}\n","export default \"assets/images/6345ee67d554fbfbf484ba4035ad19d9.jpg\";","export default \"assets/images/b9ae27f0a01228380dff76a33b605707.jpg\";","export default \"assets/images/41b2cf0fa604d3f196ca52337d238219.jpg\";","export default {};\n","import template from \"lodash.template\";\nimport { normalizeArg } from \"./functions\";\n\nexport function createIconSet(data: any, ...ancestors: any[]) {\n  const dataCopy = normalizeArg(Object.assign({}, data));\n  if (dataCopy.icon) return dataCopy;\n  const fromAncestor = ancestors.reduce((prev, curr) => {\n    if (prev) return prev;\n    const iconTemplate = curr.iconTemplate || curr.iconTemplate;\n    if (iconTemplate) {\n      return JSON.parse(template(iconTemplate)(dataCopy));\n    } else if (curr.icon) {\n      return {\n        icon: curr.icon,\n        selectedIcon: curr.selectedIcon || curr.selectedIcon\n      };\n    }\n  }, undefined);\n  if (fromAncestor) {\n    dataCopy.icon = fromAncestor.icon;\n    dataCopy.selectedIcon = fromAncestor.selectedIcon;\n  }\n  return dataCopy;\n}\n\nexport function createHtmlFromTemplate(data: any, ...ancestors: any[]) {\n  data = normalizeArg(data);\n  if (data.html) return data;\n  return (\n    ancestors.reduce((prev, curr) => {\n      if (prev) return prev;\n      const poiTemplate = curr.poiTemplate;\n      if (poiTemplate) {\n        data.html = template(poiTemplate)(data);\n        data.poiStyle = data.poiStyle || curr.poiStyle;\n        return data;\n      }\n    }, undefined) || data\n  );\n}\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\r\nimport i18n from \"i18next\";\r\nimport i18nxhr from \"i18next-xhr-backend\";\r\nimport CustomEvent from \"./customevent\";\r\nimport browserLanguage from \"./browserlanguage\";\r\nimport { Logger, LOGGER_LEVEL } from \"./logger\";\r\nimport {\r\n  createElement,\r\n  normalizeDegree,\r\n  createMapInfo,\r\n  normalizeArg\r\n} from \"./functions\";\r\nimport EventTarget from \"ol/events/Target\";\r\nimport { transform } from \"ol/proj\";\r\nimport { MaplatMap } from \"./map_ex\";\r\nimport { defaults, DragRotateAndZoom } from \"ol/interaction\";\r\nimport { altKeyOnly } from \"ol/events/condition\";\r\nimport { HistMap } from \"./source/histmap\";\r\nimport { NowMap } from \"./source/nowmap\";\r\nimport { TmsMap } from \"./source/tmsmap\";\r\nimport { MapboxMap } from \"./source/mapboxmap\";\r\nimport { mapSourceFactory } from \"./source_ex\";\r\nimport { META_KEYS, ViewpointArray } from \"./source/mixin\";\r\nimport { recursiveRound } from \"./math_ex\";\r\nimport locales from \"./freeze_locales\";\r\nimport {\r\n  normalizeLayers,\r\n  addIdToPoi,\r\n  normalizeLayer,\r\n  normalizePoi\r\n} from \"./normalize_pois\";\r\nimport { createIconSet, createHtmlFromTemplate } from \"./template_works\";\r\n\r\n// @ts-ignore\r\nimport redcircle from \"../parts/redcircle.png\";                     // @ts-ignore  \r\nimport defaultpin_selected from \"../parts/defaultpin_selected.png\"; // @ts-ignore\r\nimport defaultpin from \"../parts/defaultpin.png\";\r\nimport { Coordinate } from \"ol/coordinate\";\r\n\r\ninterface AppData {\r\n  sources: string[];\r\n  lang?: string;\r\n  pois?: any;\r\n  homePosition?: Coordinate;\r\n  defaultZoom?: number;\r\n  zoomRestriction?: boolean;\r\n  minZoom?: number;\r\n  maxZoom?: number;\r\n  appName?: string;\r\n  fakeGps?: Coordinate;\r\n  fakeRadius?: number;\r\n  noRotate?: boolean;\r\n  poiTemplate?: string;\r\n  poiStyle?: string;\r\n  iconTemplate?: string;\r\n  startFrom?: string;\r\n  controls?: any[];\r\n  northUp?: boolean;\r\n  tapDuration?: number;\r\n  homeMarginPixels: number;\r\n  tapUIVanish: boolean;\r\n}\r\n\r\ntype PositionSet = { x: number; y: number; zoom: number; rotation: number };\r\ninterface Restore {\r\n  mapID?: string;\r\n  backgroundID?: string;\r\n  position?: PositionSet;\r\n  transparency?: number;\r\n  hideMarker?: number;\r\n  hideLayer?: string;\r\n}\r\n\r\nexport class MaplatApp extends EventTarget {\r\n  appid: string;\r\n  translateUI = false;\r\n  noRotate = false;\r\n  initialRestore: Restore = {};\r\n  mapboxgl: any;\r\n  mapDiv = \"map_div\";\r\n  restoreSession = false;\r\n  enableCache: false;\r\n  stateBuffer: Restore = {};\r\n  mobileMapMoveBuffer?: ViewpointArray;\r\n  overlay = true;\r\n  waitReady: Promise<void>;\r\n  changeMapSeq?: Promise<void>;\r\n  i18n?: any;\r\n  t?: any;\r\n  lang: string;\r\n  appData?: AppData;\r\n  appLang = \"ja\";\r\n  backMap?: MaplatMap;\r\n  mercSrc?: NowMap;\r\n  mercBuffer: any;\r\n  timer: any = undefined;\r\n  appName: any;\r\n  cacheHash: any;\r\n  currentPosition: any;\r\n  startFrom? = \"\";\r\n  from?: NowMap | HistMap;\r\n  vectors: any = [];\r\n  mapDivDocument: HTMLElement | null;\r\n  mapObject: any;\r\n  mapboxMap: any;\r\n  pois: any;\r\n  poiTemplate?: string;\r\n  poiStyle?: string;\r\n  iconTemplate?: string;\r\n  logger: Logger;\r\n  icon?: string;\r\n  selectedIcon?: string;\r\n  __backMapMoving = false;\r\n  __selectedMarker: any;\r\n  __init = true;\r\n  __redrawMarkerBlock = false;\r\n  __redrawMarkerThrottle: (NowMap | HistMap)[] = [];\r\n  __transparency: any;\r\n  lastClickEvent: any;\r\n  // Maplat App Class\r\n  constructor(appOption: any) {\r\n    super();\r\n    appOption = normalizeArg(appOption);\r\n    this.appid = appOption.appid || \"sample\";\r\n    if (appOption.mapboxgl) {\r\n      this.mapboxgl = appOption.mapboxgl;\r\n      if (appOption.mapboxToken) {\r\n        this.mapboxgl.accessToken = appOption.mapboxToken;\r\n      }\r\n    }\r\n    this.mapDiv = appOption.div || \"map_div\";\r\n    this.mapDivDocument = document.querySelector(`#${this.mapDiv}`);\r\n    this.mapDivDocument!.classList.add(\"maplat\");\r\n    this.logger = new Logger(\r\n      appOption.debug ? LOGGER_LEVEL.ALL : LOGGER_LEVEL.INFO\r\n    );\r\n    this.enableCache = appOption.enableCache || false;\r\n    this.icon = appOption.icon;\r\n    this.selectedIcon = appOption.selectedIcon;\r\n\r\n    this.translateUI = appOption.translateUI;\r\n    const setting = appOption.setting;\r\n    this.lang = appOption.lang;\r\n    if (!this.lang) {\r\n      this.lang = browserLanguage();\r\n    }\r\n    if (\r\n      this.lang.toLowerCase() == \"zh-hk\" ||\r\n      this.lang.toLowerCase() == \"zh-hant\"\r\n    )\r\n      this.lang = \"zh-TW\";\r\n    if (appOption.restore) {\r\n      if (appOption.restoreSession) this.restoreSession = true;\r\n      this.initialRestore = appOption.restore;\r\n    } else if (appOption.restoreSession) {\r\n      this.restoreSession = true;\r\n      const lastEpoch = parseInt(localStorage.getItem(\"epoch\") || \"0\");\r\n      const currentTime = Math.floor(new Date().getTime() / 1000);\r\n      if (lastEpoch && currentTime - lastEpoch < 3600) {\r\n        this.initialRestore.mapID =\r\n          localStorage.getItem(\"mapID\") ||\r\n          localStorage.getItem(\"sourceID\") ||\r\n          undefined;\r\n        this.initialRestore.backgroundID =\r\n          localStorage.getItem(\"backgroundID\") ||\r\n          localStorage.getItem(\"backID\") ||\r\n          undefined;\r\n        this.initialRestore.position = {\r\n          x: parseFloat(localStorage.getItem(\"x\") || \"0\"),\r\n          y: parseFloat(localStorage.getItem(\"y\") || \"0\"),\r\n          zoom: parseFloat(localStorage.getItem(\"zoom\") || \"0\"),\r\n          rotation: parseFloat(localStorage.getItem(\"rotation\") || \"0\")\r\n        };\r\n        this.initialRestore.transparency = parseFloat(\r\n          localStorage.getItem(\"transparency\") || \"0\"\r\n        );\r\n        this.initialRestore.hideMarker = parseInt(\r\n          localStorage.getItem(\"hideMarker\") || \"0\"\r\n        );\r\n        this.initialRestore.hideLayer =\r\n          localStorage.getItem(\"hideLayer\") || undefined;\r\n      }\r\n    }\r\n    // Add UI HTML Element\r\n    const newElems =\r\n      createElement(`<img id=\"center_circle\" class=\"prevent-default\" alt=\"\"\r\n            style=\"position:absolute;top:50%;left:50%;margin-top:-10px;\r\n            margin-left:-10px;\" src=\"${redcircle}\">`);\r\n    for (let i = newElems.length - 1; i >= 0; i--) {\r\n      this.mapDivDocument!.insertBefore(\r\n        newElems[i],\r\n        this.mapDivDocument!.firstChild\r\n      );\r\n    }\r\n    const prevDefs = this.mapDivDocument!.querySelectorAll(\".prevent-default\");\r\n    for (let i = 0; i < prevDefs.length; i++) {\r\n      const target = prevDefs[i];\r\n      target.addEventListener(\"touchstart\", (evt: any) => {\r\n        evt.preventDefault();\r\n      });\r\n    }\r\n    this.overlay = \"overlay\" in appOption ? appOption.overlay : true;\r\n    if (this.overlay) {\r\n      this.mapDivDocument!.classList.add(\"with-opacity\");\r\n    }\r\n    this.waitReady = this.settingLoader(setting).then(x =>\r\n      this.handleSetting(x, appOption)\r\n    );\r\n  }\r\n  // Async initializers 1: Load application setting\r\n  async settingLoader(setting: any) {\r\n    return (\r\n      setting ||\r\n      new Promise((resolve, _reject) => {\r\n        const xhr = new XMLHttpRequest();\r\n        xhr.open(\"GET\", `apps/${this.appid}.json`, true);\r\n        xhr.responseType = \"json\";\r\n        xhr.onload = function (_e) {\r\n          let value = this.response;\r\n          if (typeof value != \"object\") value = JSON.parse(value);\r\n          resolve(value);\r\n        };\r\n        xhr.send();\r\n      })\r\n    );\r\n  }\r\n  // Async initializers 3: Load i18n setting\r\n  async i18nLoader() {\r\n    return new Promise((resolve, _reject) => {\r\n      const localesFlag = Object.keys(locales).length != 0;\r\n      const translib =\r\n        this.translateUI && !localesFlag ? i18n.use(i18nxhr) : i18n;\r\n      translib.init(\r\n        {\r\n          lng: this.lang,\r\n          fallbackLng: [\"en\"],\r\n          backend: {\r\n            loadPath: \"assets/locales/{{lng}}/{{ns}}.json\"\r\n          },\r\n          resources: localesFlag ? locales : undefined\r\n        },\r\n        (_err, t) => {\r\n          resolve([t, i18n]);\r\n        }\r\n      );\r\n    });\r\n  }\r\n  // Async initializer 6: Load pois setting => move to normalize_pois.js\r\n  // Async initializer 8: Load sources setting asynchronous\r\n  async sourcesLoader(mapReturnValue: any) {\r\n    const dataSource = this.appData!.sources;\r\n    const sourcePromise: Promise<any>[] = [];\r\n    const commonOption = {\r\n      //homePosition: mapReturnValue.homePos,\r\n      //mercZoom: mapReturnValue.defZoom,\r\n      homePos: mapReturnValue.homePos,\r\n      defZoom: mapReturnValue.defZoom,\r\n      zoomRestriction: mapReturnValue.zoomRestriction,\r\n      mercMinZoom: mapReturnValue.mercMinZoom,\r\n      mercMaxZoom: mapReturnValue.mercMaxZoom,\r\n      enableCache: this.enableCache,\r\n      translator: (fragment: any) => this.translate(fragment)\r\n    };\r\n    for (let i = 0; i < dataSource.length; i++) {\r\n      const option = dataSource[i];\r\n      sourcePromise.push(mapSourceFactory(option, commonOption));\r\n    }\r\n    return Promise.all(sourcePromise);\r\n  }\r\n  // Async initializers 2: Handle application setting\r\n  handleSetting(setting: any, appOption: any) {\r\n    this.appData = normalizeArg(setting as Record<string, any>) as AppData;\r\n    if (!this.lang && this.appData.lang) {\r\n      this.lang = this.appData.lang;\r\n    }\r\n    return this.i18nLoader().then(x => this.handleI18n(x, appOption));\r\n  }\r\n  // Async initializers 4: Handle i18n setting\r\n  handleI18n(i18nObj: any, appOption: any) {\r\n    this.i18n = i18nObj[1];\r\n    this.t = i18nObj[0];\r\n    const mapReturnValue = this.prepareMap(appOption);\r\n    return normalizeLayers(this.appData!.pois || [], this).then(x =>\r\n      this.handlePois(x, mapReturnValue)\r\n    );\r\n  }\r\n  // Async initializers 5: Prepare map base elements and objects\r\n  prepareMap(appOption: any) {\r\n    appOption = normalizeArg(appOption);\r\n    this.mercBuffer = null;\r\n    const homePos = this.appData!.homePosition;\r\n    const defZoom = this.appData!.defaultZoom;\r\n    const zoomRestriction = this.appData!.zoomRestriction;\r\n    const mercMinZoom = this.appData!.minZoom;\r\n    const mercMaxZoom = this.appData!.maxZoom;\r\n    this.appName = this.appData!.appName;\r\n    const fakeGps = appOption.fake ? this.appData!.fakeGps : false;\r\n    const fakeRadius = appOption.fake ? this.appData!.fakeRadius : false;\r\n    this.appLang = this.appData!.lang || \"ja\";\r\n    this.noRotate = appOption.noRotate || this.appData!.noRotate || false;\r\n    this.poiTemplate =\r\n      appOption.poiTemplate || this.appData!.poiTemplate || false;\r\n    this.poiStyle = appOption.poiStyle || this.appData!.poiStyle || false;\r\n    this.iconTemplate =\r\n      appOption.iconTemplate || this.appData!.iconTemplate || false;\r\n    this.currentPosition = null;\r\n    this.__init = true;\r\n    // @ts-expect-error ts-migrate(2554) FIXME: Expected 2 arguments, but got 1.\r\n    this.dispatchEvent(new CustomEvent(\"uiPrepare\"));\r\n    const frontDiv = `${this.mapDiv}_front`;\r\n    let newElem = createElement(\r\n      `<div id=\"${frontDiv}\" class=\"map\" style=\"top:0; left:0; right:0; bottom:0; ` +\r\n        `position:absolute;\"></div>`\r\n    )[0];\r\n    this.mapDivDocument!.insertBefore(newElem, this.mapDivDocument!.firstChild);\r\n    this.mapObject = new MaplatMap({\r\n      div: frontDiv,\r\n      controls: this.appData!.controls || [],\r\n      interactions: this.noRotate\r\n        ? defaults({ altShiftDragRotate: false, pinchRotate: false })\r\n        : defaults().extend([\r\n            new DragRotateAndZoom({\r\n              condition: altKeyOnly\r\n            })\r\n          ]),\r\n      fakeGps,\r\n      fakeRadius,\r\n      homePosition: homePos,\r\n      northUp: appOption.northUp || this.appData!.northUp || false,\r\n      tapDuration: appOption.tapDuration || this.appData!.tapDuration || 3000,\r\n      homeMarginPixels:\r\n        appOption.homeMarginPixels || this.appData!.homeMarginPixels || 50,\r\n      tapUIVanish: appOption.tapUIVanish || this.appData!.tapUIVanish || false  \r\n    });\r\n    let backDiv: any = null;\r\n    if (this.overlay) {\r\n      backDiv = `${this.mapDiv}_back`;\r\n      newElem = createElement(\r\n        `<div id=\"${backDiv}\" class=\"map\" style=\"top:0; left:0; right:0; bottom:0; ` +\r\n          `position:absolute;\"></div>`\r\n      )[0];\r\n      this.mapDivDocument!.insertBefore(\r\n        newElem,\r\n        this.mapDivDocument!.firstChild\r\n      );\r\n      this.backMap = new MaplatMap({\r\n        off_control: true,\r\n        div: backDiv\r\n      });\r\n    }\r\n    if (this.mapboxgl) {\r\n      const mapboxgl = this.mapboxgl;\r\n      delete this.mapboxgl;\r\n      const mapboxDiv = `${this.mapDiv}_mapbox`;\r\n      newElem = createElement(\r\n        `<div id=\"${mapboxDiv}\" class=\"map\" style=\"top:0; left:0; right:0; bottom:0; ` +\r\n          `position:absolute;visibility:hidden;\"></div>`\r\n      )[0];\r\n      this.mapDivDocument!.insertBefore(\r\n        newElem,\r\n        this.mapDivDocument!.firstChild\r\n      );\r\n      this.mapboxMap = new mapboxgl.Map({\r\n        attributionControl: false,\r\n        boxZoom: false,\r\n        container: mapboxDiv,\r\n        doubleClickZoom: false,\r\n        dragPan: false,\r\n        dragRotate: false,\r\n        interactive: false,\r\n        keyboard: false,\r\n        pitchWithRotate: false,\r\n        scrollZoom: false,\r\n        touchZoomRotate: false\r\n      });\r\n    }\r\n    this.startFrom = this.appData!.startFrom;\r\n    return {\r\n      homePos,\r\n      defZoom,\r\n      zoomRestriction,\r\n      mercMinZoom,\r\n      mercMaxZoom\r\n    };\r\n  }\r\n  // Async initializer 7: Handle pois loading result\r\n  handlePois(pois: any, mapReturnValue: any) {\r\n    this.pois = pois;\r\n    return this.sourcesLoader(mapReturnValue).then(x => this.handleSources(x));\r\n  }\r\n  // Async initializer 9: Handle sources loading result\r\n  handleSources(sources: any) {\r\n    this.mercSrc = sources.reduce((prev: any, curr: any) => {\r\n      if (prev) return prev;\r\n      if (curr instanceof NowMap && !(curr instanceof TmsMap)) return curr;\r\n    }, null);\r\n    const cache: any[] = [];\r\n    this.cacheHash = {};\r\n    for (let i = 0; i < sources.length; i++) {\r\n      const source = sources[i];\r\n      source.setMap(this.mapObject);\r\n      if (source instanceof MapboxMap) {\r\n        if (!this.mapboxMap) {\r\n          throw \"To use mapbox gl based base map, you have to make Maplat object with specifying 'mapboxgl' option.\";\r\n        }\r\n        source.mapboxMap = this.mapboxMap;\r\n      }\r\n      cache.push(source);\r\n      this.cacheHash[source.mapID] = source;\r\n    }\r\n    this.dispatchEvent(new CustomEvent(\"sourceLoaded\", sources));\r\n    this.setInitialMap(cache);\r\n    this.setMapClick();\r\n    this.setPointerEvents();\r\n    this.setMapOnOff();\r\n    this.setMouseCursor();\r\n    this.setBackMapBehavior();\r\n    this.raiseChangeViewpoint();\r\n  }\r\n  // Async initializer 10: Handle initial map\r\n  async setInitialMap(cache: (HistMap | NowMap)[]) {\r\n    const initial: string =\r\n      this.initialRestore.mapID ||\r\n      this.startFrom ||\r\n      cache[cache.length - 1].mapID;\r\n    this.from = cache.reduce(\r\n      (prev: HistMap | NowMap | undefined, curr: HistMap | NowMap) => {\r\n        if (prev) {\r\n          return !(prev instanceof HistMap) && curr.mapID != initial\r\n            ? curr\r\n            : prev;\r\n        }\r\n        if (curr.mapID != initial) return curr;\r\n        return prev;\r\n      },\r\n      undefined\r\n    );\r\n    await this.changeMap(initial, this.initialRestore);\r\n  }\r\n  // Async initializer 11: Handle map click event\r\n  setMapClick() {\r\n    this.mapObject.on(\"click\", (evt: any) => {\r\n      this.logger.debug(evt.pixel);\r\n      this.lastClickEvent = evt;\r\n      const features: any[] = [];\r\n      evt.target.forEachFeatureAtPixel(evt.pixel, (feature: any) => {\r\n        this.logger.debug(evt.pixel);\r\n        if (feature.get(\"datum\")) features.push(feature.get(\"datum\"));\r\n      });\r\n      if (features.length > 0) {\r\n        this.dispatchEvent(new CustomEvent(\"clickMarker\", features[0]));\r\n        this.dispatchEvent(new CustomEvent(\"clickMarkers\", features));\r\n      } else {\r\n        const xy = evt.coordinate;\r\n        this.dispatchEvent(new CustomEvent(\"clickMapXy\", xy));\r\n        (this.from as NowMap | HistMap)\r\n          .sysCoord2MercAsync(xy)\r\n          .then((merc: any) => {\r\n            this.dispatchEvent(new CustomEvent(\"clickMapMerc\", merc));\r\n            const lnglat = transform(merc, \"EPSG:3857\", \"EPSG:4326\");\r\n            this.dispatchEvent(\r\n              new CustomEvent(\"clickMap\", {\r\n                longitude: lnglat[0],\r\n                latitude: lnglat[1]\r\n              })\r\n            );\r\n          });\r\n      }\r\n    });\r\n  }\r\n  // Async initializer 12: Handle pointer event\r\n  setPointerEvents() {\r\n    let xyBuffer: any;\r\n    let waiting = false;\r\n    let dragging = false;\r\n    const pointerCounter: any = {};\r\n    const pointermoveHandler = (xy: any) => {\r\n      this.dispatchEvent(new CustomEvent(\"pointerMoveOnMapXy\", xy));\r\n      (this.from as HistMap | NowMap)\r\n        .sysCoord2MercAsync(xy)\r\n        .then((merc: any) => {\r\n          this.dispatchEvent(new CustomEvent(\"pointerMoveOnMapMerc\", merc));\r\n          if (xyBuffer) {\r\n            const next = xyBuffer;\r\n            xyBuffer = false;\r\n            pointermoveHandler(next);\r\n          } else {\r\n            waiting = false;\r\n          }\r\n        });\r\n    };\r\n    this.mapObject.on(\"pointermove\", (evt: any) => {\r\n      if (dragging) return;\r\n      if (waiting) {\r\n        xyBuffer = evt.coordinate;\r\n      } else {\r\n        waiting = true;\r\n        pointermoveHandler(evt.coordinate);\r\n      }\r\n    });\r\n    this.mapObject.on(\"pointerdown\", (evt: any) => {\r\n      if (evt.originalEvent && evt.originalEvent.pointerId != null) {\r\n        pointerCounter[evt.originalEvent.pointerId] = true;\r\n      }\r\n      dragging = true;\r\n    });\r\n    this.mapObject.on(\"pointerdrag\", (evt: any) => {\r\n      if (evt.originalEvent && evt.originalEvent.pointerId != null) {\r\n        pointerCounter[evt.originalEvent.pointerId] = true;\r\n      }\r\n      dragging = true;\r\n    });\r\n    this.mapObject.on(\"pointerup\", (evt: any) => {\r\n      // Android\r\n      if (evt.originalEvent && evt.originalEvent.pointerId != null) {\r\n        delete pointerCounter[evt.originalEvent.pointerId];\r\n        if (Object.keys(pointerCounter).length == 0) {\r\n          dragging = false;\r\n        }\r\n        // iOS\r\n      } else if (evt.originalEvent && evt.originalEvent.touches) {\r\n        if (evt.originalEvent.touches.length == 0) {\r\n          dragging = false;\r\n        }\r\n      } else {\r\n        dragging = false;\r\n      }\r\n    });\r\n  }\r\n  // Async initializer 13: Handle map UI on/off\r\n  setMapOnOff() {\r\n    // MapUI on off\r\n    let timer: any;\r\n    this.mapObject.on(\"click\", () => {\r\n      if (timer) {\r\n        clearTimeout(timer);\r\n        timer = undefined;\r\n      }\r\n      const ctls = this.mapDivDocument!.querySelectorAll(\".ol-control\");\r\n      if (!this.mapObject.tapUIVanish || (ctls.length && ctls[0].classList.contains(\"fade\"))) {\r\n        for (let i = 0; i < ctls.length; i++) {\r\n          ctls[i].classList.remove(\"fade\");\r\n        }\r\n      } else {\r\n        for (let i = 0; i < ctls.length; i++) {\r\n          ctls[i].classList.add(\"fade\");\r\n        }\r\n        timer = setTimeout(() => {\r\n          timer = undefined;\r\n          const ctls = this.mapDivDocument!.querySelectorAll(\".ol-control\");\r\n          for (let i = 0; i < ctls.length; i++) {\r\n            ctls[i].classList.remove(\"fade\");\r\n          }\r\n        }, this.mapObject.tapDuration);\r\n      }\r\n    });\r\n    this.mapObject.on(\"pointerdrag\", () => {\r\n      if (timer) {\r\n        clearTimeout(timer);\r\n        timer = undefined;\r\n      }\r\n      const ctls = this.mapDivDocument!.querySelectorAll(\".ol-control\");\r\n      for (let i = 0; i < ctls.length; i++) {\r\n        ctls[i].classList.add(\"fade\");\r\n      }\r\n    });\r\n    this.mapObject.on(\"moveend\", () => {\r\n      if (timer) {\r\n        clearTimeout(timer);\r\n        timer = undefined;\r\n      }\r\n      timer = setTimeout(() => {\r\n        timer = undefined;\r\n        const ctls = this.mapDivDocument!.querySelectorAll(\".ol-control\");\r\n        for (let i = 0; i < ctls.length; i++) {\r\n          ctls[i].classList.remove(\"fade\");\r\n        }\r\n      }, this.mapObject.tapDuration);\r\n    });\r\n  }\r\n  // Async initializer 14: Handle mouse cursor\r\n  setMouseCursor() {\r\n    // change mouse cursor when over marker\r\n    const moveHandler = (evt: any) => {\r\n      const pixel = evt.target.getEventPixel(evt.originalEvent);\r\n      const hit = evt.target.hasFeatureAtPixel(pixel);\r\n      const target = evt.target.getTarget();\r\n      if (hit) {\r\n        const feature = evt.target.forEachFeatureAtPixel(\r\n          evt.pixel,\r\n          (feature: any) => {\r\n            if (feature.get(\"datum\")) return feature;\r\n          }\r\n        );\r\n        (\r\n          this.mapDivDocument!.querySelector(`#${target}`)! as HTMLElement\r\n        ).style.cursor = feature ? \"pointer\" : \"\";\r\n        return;\r\n      }\r\n      (\r\n        this.mapDivDocument!.querySelector(`#${target}`)! as HTMLElement\r\n      ).style.cursor = \"\";\r\n    };\r\n    this.mapObject.on(\"pointermove\", moveHandler);\r\n    const mapOutHandler = (evt: any) => {\r\n      let histCoord = evt.frameState.viewState.center;\r\n      const source = this.from;\r\n      if (!(source as HistMap | NowMap).insideCheckSysCoord(histCoord)) {\r\n        histCoord = (source as HistMap | NowMap).modulateSysCoordInside(\r\n          histCoord\r\n        );\r\n        evt.target.getView().setCenter(histCoord);\r\n      }\r\n    };\r\n    this.mapObject.on(\"moveend\", mapOutHandler);\r\n  }\r\n  // Async initializer 15: Handle back map's behavior\r\n  setBackMapBehavior() {\r\n    const backMapMove = (_evt: any) => {\r\n      if (!this.backMap) return;\r\n      if (this.__backMapMoving) {\r\n        this.logger.debug(\"Backmap moving skipped\");\r\n        return;\r\n      }\r\n      const backSrc = (this.backMap as MaplatMap).getSource();\r\n      if (backSrc) {\r\n        this.__backMapMoving = true;\r\n        this.logger.debug(\"Backmap moving started\");\r\n        this.convertParametersFromCurrent(backSrc, (size: any) => {\r\n          const view = (this.backMap as MaplatMap).getView();\r\n          view.setCenter(size[0]);\r\n          view.setZoom(size[1]);\r\n          view.setRotation(this.noRotate ? 0 : size[2]);\r\n          this.logger.debug(\"Backmap moving ended\");\r\n          this.__backMapMoving = false;\r\n        });\r\n      }\r\n    };\r\n    this.mapObject.on(\"postrender\", backMapMove);\r\n  }\r\n  // Async initializer 16: Handle back map's behavior\r\n  raiseChangeViewpoint() {\r\n    this.mapObject.on(\"postrender\", (_evt: any) => {\r\n      const view = this.mapObject.getView();\r\n      const center = view.getCenter();\r\n      const zoom = view.getDecimalZoom();\r\n      const rotation = normalizeDegree((view.getRotation() * 180) / Math.PI);\r\n      (this.from as HistMap | NowMap)\r\n        .viewpoint2MercsAsync()\r\n        .then(mercs => (this.mercSrc as NowMap).mercs2ViewpointAsync(mercs))\r\n        .then(viewpoint => {\r\n          if (\r\n            this.mobileMapMoveBuffer &&\r\n            this.mobileMapMoveBuffer[0]![0] == viewpoint[0]![0] &&\r\n            this.mobileMapMoveBuffer[0]![1] == viewpoint[0]![1] &&\r\n            this.mobileMapMoveBuffer[1] == viewpoint[1] &&\r\n            this.mobileMapMoveBuffer[2] == viewpoint[2]\r\n          ) {\r\n            return;\r\n          }\r\n          this.mobileMapMoveBuffer = viewpoint;\r\n          const ll = transform(viewpoint[0]!, \"EPSG:3857\", \"EPSG:4326\");\r\n          const direction = normalizeDegree((viewpoint[2]! * 180) / Math.PI);\r\n          this.dispatchEvent(\r\n            new CustomEvent(\"changeViewpoint\", {\r\n              x: center[0],\r\n              y: center[1],\r\n              longitude: ll[0],\r\n              latitude: ll[1],\r\n              mercator_x: viewpoint[0]![0],\r\n              mercator_y: viewpoint[0]![1],\r\n              zoom,\r\n              mercZoom: viewpoint[1],\r\n              direction,\r\n              rotation\r\n            })\r\n          );\r\n          this.requestUpdateState({\r\n            position: {\r\n              x: center[0],\r\n              y: center[1],\r\n              zoom,\r\n              rotation\r\n            }\r\n          });\r\n        });\r\n    });\r\n  }\r\n  currentMapInfo() {\r\n    return createMapInfo(this.from);\r\n  }\r\n  mapInfo(mapID: string) {\r\n    return createMapInfo(this.cacheHash[mapID]);\r\n  }\r\n  setMarker(data: any) {\r\n    this.logger.debug(data);\r\n    const lnglat = data.lnglat || [\r\n      data.lng || data.longitude,\r\n      data.lat || data.latitude\r\n    ];\r\n    const x = data.x;\r\n    const y = data.y;\r\n    const coords = data.coordinates;\r\n    const src = this.from;\r\n    const icon = data.icon\r\n      ? this.__selectedMarker == data.namespaceID && data.selectedIcon\r\n        ? data.selectedIcon\r\n        : data.icon\r\n      : this.__selectedMarker == data.namespaceID\r\n      ? defaultpin_selected\r\n      : defaultpin;\r\n    const promise = coords\r\n      ? (function () {\r\n          return (src as HistMap | NowMap).merc2SysCoordAsync_ignoreBackground(\r\n            coords\r\n          );\r\n        })()\r\n      : x && y\r\n      ? new Promise(resolve => {\r\n          resolve((src as HistMap).xy2SysCoord([x, y]));\r\n        })\r\n      : (function () {\r\n          const merc = transform(lnglat, \"EPSG:4326\", \"EPSG:3857\");\r\n          return (src as HistMap | NowMap).merc2SysCoordAsync_ignoreBackground(\r\n            merc\r\n          );\r\n        })();\r\n    return promise.then((xy: any) => {\r\n      if (!xy) return;\r\n      if ((src as HistMap | NowMap).insideCheckSysCoord(xy)) {\r\n        this.mapObject.setMarker(xy, { datum: data }, icon);\r\n      }\r\n    });\r\n  }\r\n  resetMarker() {\r\n    this.mapObject.resetMarker();\r\n  }\r\n  setLine(data: any) {\r\n    // Ready for Polygon\r\n    data.type = \"Line\";\r\n    if (!data.style && data.stroke) {\r\n      data.style = {\r\n        stroke: data.stroke\r\n      };\r\n    }\r\n    this.setVector(data);\r\n  }\r\n  setVector(data: any) {\r\n    // Ready for Polygon\r\n    this.logger.debug(data);\r\n    let xyPromises;\r\n    const merc2XyRecurse = (coords: any, isLnglat = false) =>\r\n      Promise.all(\r\n        coords.map((coord: any) => {\r\n          if (Array.isArray(coord[0])) {\r\n            return merc2XyRecurse(coord, isLnglat);\r\n          } else {\r\n            if (isLnglat) coord = transform(coord, \"EPSG:4326\", \"EPSG:3857\");\r\n            return (this.from as HistMap | NowMap).merc2SysCoordAsync(coord);\r\n          }\r\n        })\r\n      );\r\n\r\n    if (data.coordinates) {\r\n      xyPromises = merc2XyRecurse(data.coordinates);\r\n    } else {\r\n      xyPromises = merc2XyRecurse(data.lnglats, true);\r\n    }\r\n    xyPromises.then(xys => {\r\n      this.mapObject.setVector(xys, data.type, data.style);\r\n    });\r\n  }\r\n  resetLine() {\r\n    // Ready for Polygon\r\n    this.resetVector();\r\n  }\r\n  resetVector() {\r\n    // Ready for Polygon\r\n    this.mapObject.resetVector();\r\n  }\r\n  redrawMarkers(source: HistMap | NowMap | undefined = undefined) {\r\n    if (!source) {\r\n      source = this.from;\r\n    }\r\n    if (this.__redrawMarkerBlock) {\r\n      if (!this.__redrawMarkerThrottle) this.__redrawMarkerThrottle = [];\r\n      const throttle = this.__redrawMarkerThrottle;\r\n      if (throttle.length == 0 || throttle[throttle.length - 1] !== source) {\r\n        throttle.push(source as HistMap | NowMap);\r\n        return;\r\n      }\r\n    }\r\n    this.__redrawMarkerBlock = true;\r\n    const redrawLogic = (source: any) => {\r\n      const promises: any = [];\r\n      this.resetMarker();\r\n      let selected: any;\r\n      if (!this.stateBuffer.hideMarker) {\r\n        Object.keys(this.pois).map(key => {\r\n          const cluster = this.pois[key];\r\n          if (!cluster.hide) {\r\n            cluster.pois.map((data: any) => {\r\n              const dataCopy = createIconSet(data, cluster, this);\r\n              createHtmlFromTemplate(dataCopy, cluster, this);\r\n              if (this.__selectedMarker == dataCopy.namespaceID) {\r\n                selected = dataCopy;\r\n              } else {\r\n                promises.push(this.setMarker(dataCopy));\r\n              }\r\n            });\r\n          }\r\n        });\r\n        if (source.pois) {\r\n          Object.keys(source.pois).map(key => {\r\n            const cluster = source.pois[key];\r\n            if (!cluster.hide) {\r\n              cluster.pois.map((data: any) => {\r\n                const dataCopy = createIconSet(data, cluster, source, this);\r\n                createHtmlFromTemplate(dataCopy, cluster, source, this);\r\n                if (this.__selectedMarker == dataCopy.namespaceID) {\r\n                  selected = dataCopy;\r\n                } else {\r\n                  promises.push(this.setMarker(dataCopy));\r\n                }\r\n              });\r\n            }\r\n          });\r\n        }\r\n      }\r\n      let promise_var = Promise.all(promises);\r\n      if (selected) {\r\n        promise_var = promise_var.then(() => this.setMarker(selected)) as any;\r\n      }\r\n      promise_var.then(() => {\r\n        if (\r\n          this.__redrawMarkerThrottle &&\r\n          this.__redrawMarkerThrottle.length > 0\r\n        ) {\r\n          redrawLogic(this.__redrawMarkerThrottle.shift());\r\n        } else {\r\n          this.__redrawMarkerBlock = false;\r\n        }\r\n      });\r\n    };\r\n    redrawLogic(source);\r\n  }\r\n  selectMarker(id: any) {\r\n    const data = this.getMarker(id);\r\n    if (!data) return;\r\n    this.__selectedMarker = id;\r\n    const latlng = {\r\n      latitude: data.lnglat\r\n        ? data.lnglat[1]\r\n        : data.lat\r\n        ? data.lat\r\n        : data.latitude,\r\n      longitude: data.lnglat\r\n        ? data.lnglat[0]\r\n        : data.lng\r\n        ? data.lng\r\n        : data.longitude\r\n    };\r\n    this.setViewpoint(latlng);\r\n    this.redrawMarkers();\r\n  }\r\n  unselectMarker() {\r\n    delete this.__selectedMarker;\r\n    this.redrawMarkers();\r\n  }\r\n  getMarker(id: any) {\r\n    if (id.indexOf(\"#\") < 0) {\r\n      let ret: any = undefined;\r\n      Object.keys(this.pois).map(key => {\r\n        this.pois[key].pois.map((poi: any, i: any) => {\r\n          if (poi.id == id) {\r\n            ret = this.pois[key].pois[i];\r\n          }\r\n        });\r\n      });\r\n      return ret;\r\n    } else {\r\n      const splits = id.split(\"#\");\r\n      const source = this.cacheHash[splits[0]];\r\n      if (source) {\r\n        return source.getPoi(splits[1]);\r\n      }\r\n    }\r\n  }\r\n  updateMarker(id: any, data: any, overwrite: any) {\r\n    const poi = this.getMarker(id);\r\n    if (!poi) return;\r\n    data = normalizePoi(data || {});\r\n    if (overwrite) {\r\n      Object.keys(poi).map(key => {\r\n        if (key != \"id\" && key != \"namespaceID\") {\r\n          delete poi[key];\r\n        }\r\n      });\r\n      Object.assign(poi, data);\r\n    } else {\r\n      Object.keys(data).map(key => {\r\n        if (key == \"id\" || key == \"namespaceID\") return;\r\n        if (data[key] == \"____delete____\") {\r\n          delete poi[key];\r\n        } else {\r\n          poi[key] = data[key];\r\n        }\r\n      });\r\n    }\r\n    this.redrawMarkers();\r\n  }\r\n  addMarker(data: any, clusterId: any) {\r\n    if (!clusterId) {\r\n      clusterId = \"main\";\r\n    }\r\n    if (clusterId.indexOf(\"#\") < 0) {\r\n      if (this.pois[clusterId]) {\r\n        this.pois[clusterId][\"pois\"].push(normalizePoi(data));\r\n        addIdToPoi(this.pois, clusterId, {\r\n          name: this.appName\r\n        });\r\n        this.dispatchPoiNumber();\r\n        this.redrawMarkers();\r\n        return data.namespaceID;\r\n      }\r\n    } else {\r\n      const splits = clusterId.split(\"#\");\r\n      const source = this.cacheHash[splits[0]];\r\n      if (source) {\r\n        const ret = source.addPoi(data, splits[1]);\r\n        this.dispatchPoiNumber();\r\n        this.redrawMarkers();\r\n        return ret;\r\n      }\r\n    }\r\n  }\r\n  removeMarker(id: any) {\r\n    if (id.indexOf(\"#\") < 0) {\r\n      Object.keys(this.pois).map(key => {\r\n        this.pois[key].pois.map((poi: any, i: any) => {\r\n          if (poi.id == id) {\r\n            delete this.pois[key].pois[i];\r\n            this.dispatchPoiNumber();\r\n            this.redrawMarkers();\r\n          }\r\n        });\r\n      });\r\n    } else {\r\n      const splits = id.split(\"#\");\r\n      const source = this.cacheHash[splits[0]];\r\n      if (source) {\r\n        source.removePoi(splits[1]);\r\n        this.dispatchPoiNumber();\r\n        this.redrawMarkers();\r\n      }\r\n    }\r\n  }\r\n  clearMarker(clusterId: any) {\r\n    if (!clusterId) {\r\n      clusterId = \"main\";\r\n    }\r\n    if (clusterId.indexOf(\"#\") < 0) {\r\n      if (clusterId == \"all\") {\r\n        Object.keys(this.pois).map(key => {\r\n          this.pois[key][\"pois\"] = [];\r\n        });\r\n      } else if (this.pois[clusterId]) {\r\n        this.pois[clusterId][\"pois\"] = [];\r\n      } else return;\r\n      this.dispatchPoiNumber();\r\n      this.redrawMarkers();\r\n    } else {\r\n      const splits = clusterId.split(\"#\");\r\n      const source = this.cacheHash[splits[0]];\r\n      if (source) {\r\n        source.clearPoi(splits[1]);\r\n        this.dispatchPoiNumber();\r\n        this.redrawMarkers();\r\n      }\r\n    }\r\n  }\r\n  showAllMarkers() {\r\n    this.requestUpdateState({ hideMarker: 0 });\r\n    this.redrawMarkers();\r\n  }\r\n  hideAllMarkers() {\r\n    this.requestUpdateState({ hideMarker: 1 });\r\n    this.redrawMarkers();\r\n  }\r\n  dispatchPoiNumber() {\r\n    this.dispatchEvent(\r\n      new CustomEvent(\r\n        \"poi_number\",\r\n        this.listPoiLayers(false, true).reduce(\r\n          (prev, curr) => prev + curr.pois.length,\r\n          0\r\n        )\r\n      )\r\n    );\r\n  }\r\n  listPoiLayers(hideOnly = false, nonzero = false) {\r\n    const appPois = Object.keys(this.pois)\r\n      .sort((a, b) => {\r\n        if (a == \"main\") return -1;\r\n        else if (b == \"main\") return 1;\r\n        else if (a < b) return -1;\r\n        else if (a > b) return 1;\r\n        else return 0;\r\n      })\r\n      .map(key => this.pois[key])\r\n      .filter(layer =>\r\n        nonzero\r\n          ? hideOnly\r\n            ? layer.pois.length && layer.hide\r\n            : layer.pois.length\r\n          : hideOnly\r\n          ? layer.hide\r\n          : true\r\n      );\r\n    const mapPois = (this.from as HistMap | NowMap).listPoiLayers(\r\n      hideOnly,\r\n      nonzero\r\n    );\r\n    return appPois.concat(mapPois);\r\n  }\r\n  showPoiLayer(id: any) {\r\n    const layer = this.getPoiLayer(id);\r\n    if (layer) {\r\n      delete layer.hide;\r\n      this.requestUpdateState({\r\n        hideLayer: this.listPoiLayers(true)\r\n          .map(layer => layer.namespaceID)\r\n          .join(\",\")\r\n      });\r\n      this.redrawMarkers();\r\n    }\r\n  }\r\n  hidePoiLayer(id: any) {\r\n    const layer = this.getPoiLayer(id);\r\n    if (layer) {\r\n      layer.hide = true;\r\n      this.requestUpdateState({\r\n        hideLayer: this.listPoiLayers(true)\r\n          .map(layer => layer.namespaceID)\r\n          .join(\",\")\r\n      });\r\n      this.redrawMarkers();\r\n    }\r\n  }\r\n  getPoiLayer(id: any) {\r\n    if (id.indexOf(\"#\") < 0) {\r\n      return this.pois[id];\r\n    } else {\r\n      const splits = id.split(\"#\");\r\n      const source = this.cacheHash[splits[0]];\r\n      if (source) {\r\n        return source.getPoiLayer(splits[1]);\r\n      }\r\n    }\r\n  }\r\n  addPoiLayer(id: any, data: any) {\r\n    if (id == \"main\") return;\r\n    if (this.pois[id]) return;\r\n    if (id.indexOf(\"#\") < 0) {\r\n      this.pois[id] = normalizeLayer(data || [], id, {\r\n        name: this.appName\r\n      });\r\n      this.redrawMarkers();\r\n    } else {\r\n      const splits = id.split(\"#\");\r\n      const source = this.cacheHash[splits[0]];\r\n      if (source) {\r\n        source.addPoiLayer(splits[1], data);\r\n        this.redrawMarkers();\r\n      }\r\n    }\r\n  }\r\n  removePoiLayer(id: any) {\r\n    if (id == \"main\") return;\r\n    if (!this.pois[id]) return;\r\n    if (id.indexOf(\"#\") < 0) {\r\n      delete this.pois[id];\r\n      this.requestUpdateState({\r\n        hideLayer: this.listPoiLayers(true)\r\n          .map(layer => layer.namespaceID)\r\n          .join(\",\")\r\n      });\r\n      this.dispatchPoiNumber();\r\n      this.redrawMarkers();\r\n    } else {\r\n      const splits = id.split(\"#\");\r\n      const source = this.cacheHash[splits[0]];\r\n      if (source) {\r\n        source.removePoiLayer(splits[1]);\r\n        this.requestUpdateState({\r\n          hideLayer: this.listPoiLayers(true)\r\n            .map(layer => layer.namespaceID)\r\n            .join(\",\")\r\n        });\r\n        this.dispatchPoiNumber();\r\n        this.redrawMarkers();\r\n      }\r\n    }\r\n  }\r\n  addLine(data: any) {\r\n    this.vectors.push(data);\r\n    this.setLine(data);\r\n  }\r\n  addVector(data: any) {\r\n    this.vectors.push(data);\r\n    this.setVector(data);\r\n  }\r\n  clearLine() {\r\n    this.vectors = [];\r\n    this.resetLine();\r\n  }\r\n  clearVector() {\r\n    this.vectors = [];\r\n    this.resetVector();\r\n  }\r\n  setGPSMarker(position: any) {\r\n    this.currentPosition = position;\r\n    (this.from as HistMap | NowMap).setGPSMarker(position, true);\r\n  }\r\n  changeMap(mapID: string, restore?: Restore) {\r\n    if (restore === undefined) restore = {};\r\n    const now = this.mercSrc;\r\n    const to: NowMap | HistMap = this.cacheHash[mapID];\r\n    if (!this.changeMapSeq) {\r\n      this.changeMapSeq = Promise.resolve();\r\n    }\r\n    return (this.changeMapSeq = this.changeMapSeq.then(\r\n      () =>\r\n        new Promise((resolve, _reject) => {\r\n          this.convertParametersFromCurrent(to, (size: any) => {\r\n            let backSrc: any = null;\r\n            let backTo: any = null;\r\n            const backRestore = restore!.backgroundID\r\n              ? this.cacheHash[restore!.backgroundID]\r\n              : undefined;\r\n            if (this.backMap) {\r\n              // Overlay = true case:\r\n              backSrc = this.backMap.getSource(); // Get current source of background map\r\n              if (!(to instanceof NowMap)) {\r\n                // If new foreground source is nonlinear map:\r\n                if (backRestore) {\r\n                  backTo = backRestore;\r\n                  this.backMap.exchangeSource(backTo);\r\n                } else {\r\n                  if (!backSrc) {\r\n                    // If current background source is not set, specify it\r\n                    backTo = now as any;\r\n                    if (this.from instanceof NowMap) {\r\n                      backTo =\r\n                        this.from instanceof TmsMap\r\n                          ? this.mapObject.getSource()\r\n                          : // If current foreground is TMS overlay, set current basemap as new background\r\n                            this.from; // If current foreground source is basemap, set current foreground as new background\r\n                    }\r\n                    this.backMap.exchangeSource(backTo);\r\n                  } else {\r\n                    // If current background source is set, use it again\r\n                    backTo = backSrc;\r\n                  }\r\n                }\r\n                this.requestUpdateState({ backgroundID: backTo.mapID });\r\n              } else {\r\n                // If new foreground source is basemap or TMS overlay, remove source from background map\r\n                this.backMap.exchangeSource();\r\n              }\r\n              // Overlay = true case: end\r\n            }\r\n            if (to instanceof TmsMap) {\r\n              // Foreground is TMS overlay case: set TMS as Layer\r\n              this.mapObject.setLayer(to);\r\n              // If current foreground is basemap then set it as basemap layer\r\n              if (backRestore) {\r\n                this.mapObject.exchangeSource(backRestore);\r\n              } else if (!(this.from instanceof NowMap)) {\r\n                const backToLocal = backSrc || now;\r\n                this.mapObject.exchangeSource(backToLocal);\r\n              }\r\n              this.requestUpdateState({\r\n                backgroundID: this.mapObject.getSource().mapID\r\n              });\r\n            } else {\r\n              // Remove overlay from foreground and set current source to foreground\r\n              this.mapObject.setLayer();\r\n              this.mapObject.exchangeSource(to);\r\n            }\r\n            const updateState = {\r\n              mapID: to.mapID\r\n            };\r\n            if (to instanceof NowMap && !(to instanceof TmsMap)) {\r\n              (updateState as any).backgroundID = \"____delete____\";\r\n            }\r\n            this.requestUpdateState(updateState);\r\n            // This must be here: Because, render process works after view.setCenter,\r\n            // and Changing \"from\" content must be finished before \"postrender\" event\r\n            this.from = to;\r\n            this.dispatchPoiNumber();\r\n            const view = this.mapObject.getView();\r\n            if (this.appData!.zoomRestriction) {\r\n              view.setMaxZoom(to.maxZoom!);\r\n              view.setMinZoom(to.minZoom || 0);\r\n            }\r\n            if (to.insideCheckSysCoord(size[0])) {\r\n              view.setCenter(size[0]);\r\n              view.setZoom(size[1]);\r\n              view.setRotation(this.noRotate ? 0 : size[2]);\r\n            } else if (!this.__init) {\r\n              this.dispatchEvent(new CustomEvent(\"outOfMap\", {}));\r\n              this.goHome(to);\r\n            }\r\n            to.setGPSMarker(this.currentPosition, true);\r\n            if (restore!.hideLayer) {\r\n              const layers = restore!.hideLayer.split(\",\");\r\n              layers.map((key: any) => {\r\n                const layer = this.getPoiLayer(key);\r\n                if (layer) {\r\n                  layer.hide = true;\r\n                }\r\n              });\r\n              this.requestUpdateState({ hideLayer: restore!.hideLayer });\r\n            }\r\n            if (restore!.hideMarker) {\r\n              this.hideAllMarkers();\r\n            } else {\r\n              this.redrawMarkers();\r\n            }\r\n            this.resetVector();\r\n            for (let i = 0; i < this.vectors.length; i++) {\r\n              (data => {\r\n                this.setVector(data);\r\n              })(this.vectors[i]);\r\n            }\r\n            this.dispatchEvent(\r\n              new CustomEvent(\"mapChanged\", this.getMapMeta(to.mapID))\r\n            );\r\n            this.mapObject.updateSize();\r\n            this.mapObject.renderSync();\r\n            if (restore!.position) {\r\n              this.__init = false;\r\n              to.setViewpoint(restore!.position);\r\n            }\r\n            if (restore!.transparency) {\r\n              this.setTransparency(restore!.transparency);\r\n            }\r\n            if (this.__init) {\r\n              this.__init = false;\r\n              this.goHome(to);\r\n            } else if (this.backMap && backTo) {\r\n              this.convertParametersFromCurrent(backTo, (size: any) => {\r\n                const view = (this.backMap as MaplatMap).getView();\r\n                view.setCenter(size[0]);\r\n                view.setZoom(size[1]);\r\n                view.setRotation(this.noRotate ? 0 : size[2]);\r\n                (this.backMap as MaplatMap).updateSize();\r\n                (this.backMap as MaplatMap).renderSync();\r\n              });\r\n            }\r\n            resolve(undefined);\r\n          });\r\n        })\r\n    ));\r\n  }\r\n  requestUpdateState(data: Restore) {\r\n    this.stateBuffer = Object.assign(this.stateBuffer, data);\r\n    if (this.stateBuffer.backgroundID == \"____delete____\") {\r\n      delete this.stateBuffer.backgroundID;\r\n    }\r\n    if (this.restoreSession) {\r\n      const currentTime = Math.floor(new Date().getTime() / 1000);\r\n      localStorage.setItem(\"epoch\", `${currentTime}`);\r\n      const loopSession = function (data: any) {\r\n        Object.keys(data).map(key => {\r\n          if (key == \"position\") {\r\n            loopSession(data[key]);\r\n          } else if (key == \"backgroundID\" && data[key] == \"____delete____\") {\r\n            localStorage.removeItem(key);\r\n          } else {\r\n            localStorage.setItem(key, data[key]);\r\n          }\r\n        });\r\n      };\r\n      loopSession(data);\r\n    }\r\n    if (this.timer) clearTimeout(this.timer);\r\n    this.timer = setTimeout(() => {\r\n      this.timer = undefined;\r\n      this.dispatchEvent(new CustomEvent(\"updateState\", this.stateBuffer));\r\n    }, 50);\r\n  }\r\n  setTransparency(percentage: any) {\r\n    this.__transparency = percentage;\r\n    this.mapObject.setTransparency(percentage);\r\n    this.requestUpdateState({ transparency: percentage });\r\n  }\r\n  getTransparency() {\r\n    return this.__transparency == null ? 0 : this.__transparency;\r\n  }\r\n  setViewpoint(cond: any) {\r\n    (this.from as HistMap | NowMap).setViewpoint(cond);\r\n  }\r\n  goHome(useTo?: HistMap | NowMap) {\r\n    const src = useTo || this.from!;\r\n    src.goHome();\r\n  }\r\n  resetRotation() {\r\n    this.from!.resetRotation();\r\n  }\r\n  resetDirection() {\r\n    this.from!.resetDirection();\r\n  }\r\n  resetCirculation() {\r\n    this.from!.resetCirculation();\r\n  }\r\n  getMapMeta(mapID: any) {\r\n    let source: NowMap | HistMap | undefined;\r\n    if (!mapID) {\r\n      source = this.from;\r\n    } else {\r\n      source = this.cacheHash[mapID];\r\n    }\r\n    if (!source) return;\r\n    return META_KEYS.reduce(\r\n      (prev: any, curr: string) => {\r\n        prev[curr] = (source as any)[curr];\r\n        return prev;\r\n      },\r\n      {\r\n        mapID: source.mapID,\r\n        label: source.label\r\n      }\r\n    );\r\n  }\r\n  getMapCacheEnable(mapID: string) {\r\n    let source: NowMap | HistMap | undefined;\r\n    if (!mapID) {\r\n      source = this.from;\r\n    } else {\r\n      source = this.cacheHash[mapID];\r\n    }\r\n    if (!source) return false;\r\n    return source.getCacheEnable();\r\n  }\r\n  async getMapTileCacheStatsAsync(mapID: string) {\r\n    let source: NowMap | HistMap | undefined;\r\n    if (!mapID) {\r\n      source = this.from;\r\n    } else {\r\n      source = this.cacheHash[mapID];\r\n    }\r\n    if (!source) return {};\r\n    return await source.getTileCacheStatsAsync();\r\n  }\r\n  async getMapTileCacheSizeAsync(mapID: string) {\r\n    const stats: any = await this.getMapTileCacheStatsAsync(mapID);\r\n    return stats.size || 0;\r\n  }\r\n  async clearMapTileCacheAsync(mapID: string) {\r\n    let source: NowMap | HistMap | undefined;\r\n    if (!mapID) {\r\n      source = this.from;\r\n    } else {\r\n      source = this.cacheHash[mapID];\r\n    }\r\n    if (!source) return;\r\n    await source.clearTileCacheAsync();\r\n  }\r\n  async fetchAllMapTileCacheAsync(mapID: string, callback: any) {\r\n    let source: NowMap | HistMap | undefined;\r\n    if (!mapID) {\r\n      source = this.from;\r\n    } else {\r\n      source = this.cacheHash[mapID];\r\n    }\r\n    if (!source) {\r\n      callback(\"stop\", {});\r\n      return;\r\n    }\r\n    await source.fetchAllTileCacheAsync(callback);\r\n  }\r\n  async cancelMapTileCacheAsync(mapID: string) {\r\n    let source: NowMap | HistMap | undefined;\r\n    if (!mapID) {\r\n      source = this.from;\r\n    } else {\r\n      source = this.cacheHash[mapID];\r\n    }\r\n    if (!source) return;\r\n    await source.cancelTileCacheAsync();\r\n  }\r\n  convertParametersFromCurrent(to: any, callback: any) {\r\n    const view = this.mapObject.getView();\r\n    let fromPromise = (this.from as HistMap | NowMap).viewpoint2MercsAsync();\r\n    const current = recursiveRound(\r\n      [view.getCenter(), view.getZoom(), view.getRotation()],\r\n      10\r\n    );\r\n    if (\r\n      this.mercBuffer &&\r\n      this.mercBuffer.mercs &&\r\n      this.mercBuffer.buffer[(this.from as HistMap | NowMap).mapID]\r\n    ) {\r\n      const buffer =\r\n        this.mercBuffer.buffer[(this.from as HistMap | NowMap).mapID];\r\n      if (\r\n        buffer[0][0] == current[0][0] &&\r\n        buffer[0][1] == current[0][1] &&\r\n        buffer[1] == current[1] &&\r\n        buffer[2] == current[2]\r\n      ) {\r\n        this.logger.debug(buffer);\r\n        this.logger.debug(current);\r\n        this.logger.debug(\"From: Use buffer\");\r\n        fromPromise = new Promise((res, _rej) => {\r\n          res(this.mercBuffer.mercs);\r\n        });\r\n      } else {\r\n        this.mercBuffer = {\r\n          buffer: {}\r\n        };\r\n        this.mercBuffer.buffer[(this.from as HistMap | NowMap).mapID] = current;\r\n      }\r\n    } else {\r\n      this.mercBuffer = {\r\n        buffer: {}\r\n      };\r\n      this.mercBuffer.buffer[(this.from as HistMap | NowMap).mapID] = current;\r\n    }\r\n    this.logger.debug(\r\n      `From: Center: ${current[0]} Zoom: ${current[1]} Rotation: ${current[2]}`\r\n    );\r\n    this.logger.debug(`From: ${(this.from as HistMap | NowMap).mapID}`);\r\n    fromPromise\r\n      .then((mercs: any) => {\r\n        this.mercBuffer.mercs = mercs;\r\n        this.logger.debug(`Mercs: ${mercs}`);\r\n        let toPromise = to.mercs2ViewpointAsync(mercs);\r\n        const key = to.mapID;\r\n        if (this.mercBuffer.buffer[key]) {\r\n          this.logger.debug(\"To: Use buffer\");\r\n          toPromise = new Promise((res, _rej) => {\r\n            res(this.mercBuffer.buffer[key]);\r\n          });\r\n        }\r\n        toPromise\r\n          .then((size: any) => {\r\n            this.logger.debug(\r\n              `To: Center: ${size[0]} Zoom: ${size[1]} Rotation: ${size[2]}`\r\n            );\r\n            this.logger.debug(`To: ${to.mapID}`);\r\n            this.mercBuffer.buffer[to.mapID] = recursiveRound(size, 10);\r\n            callback(size);\r\n          })\r\n          .catch((err: any) => {\r\n            throw err;\r\n          });\r\n      })\r\n      .catch((err: any) => {\r\n        throw err;\r\n      });\r\n  }\r\n  translate(\r\n    dataFragment?: Record<string, string> | string\r\n  ): string | undefined {\r\n    if (!dataFragment || typeof dataFragment === \"string\")\r\n      return dataFragment as any;\r\n    const langs = Object.keys(dataFragment);\r\n    let key = langs.reduce((prev: any, curr, idx, arr) => {\r\n      if (curr == this.appLang) {\r\n        prev = [dataFragment[curr], true];\r\n      } else if (!prev || (curr == \"en\" && !prev[1])) {\r\n        prev = [dataFragment[curr], false];\r\n      }\r\n      if (idx == arr.length - 1) return prev[0];\r\n      return prev;\r\n    }, undefined);\r\n    key = typeof key === \"string\" ? key : `${key}`;\r\n    if (\r\n      this.i18n!.exists(key, {\r\n        ns: \"translation\",\r\n        nsSeparator: \"__X__yX__X__\"\r\n      })\r\n    )\r\n      return this.t!(key, {\r\n        ns: \"translation\",\r\n        nsSeparator: \"__X__yX__X__\"\r\n      });\r\n    for (let i = 0; i < langs.length; i++) {\r\n      const lang = langs[i];\r\n      this.i18n!.addResource(lang, \"translation\", key, dataFragment[lang]);\r\n    }\r\n    return this.t!(key, {\r\n      ns: \"translation\",\r\n      nsSeparator: \"__X__yX__X__\"\r\n    });\r\n  }\r\n  remove() {\r\n    if (this.mapboxMap) {\r\n      this.mapboxMap.remove();\r\n    }\r\n    this.mapDivDocument!.innerHTML = \"\";\r\n    this.mapDivDocument!.classList.remove(\"maplat\");\r\n  }\r\n}\r\nexport { createElement };\r\nexport { CustomEvent };\r\n","export default \"assets/images/f115726e6249018905cca51653e1262c.png\";","import { MaplatApp } from \"../src/index.ts\";\r\nimport \"../less/core.less\";\r\n\r\n(async () => {\r\n  const option = {\r\n    mapboxgl,\r\n    mapboxToken: 'YOUR-ACCESS-TOKEN',\r\n    northUp: true,\r\n    tapDuration: 60000,\r\n    homeMarginPixels: 100,\r\n    tapUIVanish: true,\r\n    div: \"map\",\r\n  };\r\n  const app = new MaplatApp(option);\r\n  await app.waitReady;\r\n  console.log(\"####Message appReady\");\r\n  console.log(app);\r\n  console.log(app.currentMapInfo());\r\n  console.log(app.mapInfo(\"gsi\"));\r\n  let moveFlag = false;\r\n  app.addEventListener(\"clickMarker\", evt => {\r\n    app.selectMarker(evt.detail.namespaceID);\r\n    console.log(`####Message clickMarker ${JSON.stringify(evt.detail)}`);\r\n  });\r\n  app.addEventListener(\"clickMap\", evt => console.log(`####Message clickMap ${JSON.stringify(evt.detail)}`));\r\n  app.addLine({\r\n    lnglats: [\r\n      [141.151995, 39.701599],\r\n      [141.151137, 39.703736],\r\n      [141.1521671, 39.7090232]\r\n    ],\r\n    stroke: {\r\n      color: \"#ffcc33\",\r\n      width: 2\r\n    }\r\n  });\r\n  app.addVector({\r\n    type: \"Line\",\r\n    lnglats: [\r\n      [141.14791274070737, 39.69741334474737],\r\n      [141.14660382270813, 39.69681897707071],\r\n      [141.14725828170776, 39.69597694743377],\r\n      [141.14853501319885, 39.69661259820805],\r\n      [141.14900708198547, 39.696034734109695]\r\n    ],\r\n    style: {\r\n      stroke: {\r\n        color: \"#ff0000\",\r\n        width: 2\r\n      }\r\n    }\r\n  });\r\n  app.addVector({\r\n    type: \"Polygon\",\r\n    lnglats: [[\r\n      [141.15129232406616, 39.6978013319974],\r\n      [141.14970445632935, 39.696967569469734],\r\n      [141.15129232406616, 39.695877884448194],\r\n      [141.15272998809814, 39.69686850790594],\r\n      [141.15129232406616, 39.6978013319974]\r\n    ], [\r\n      [141.15143179893494, 39.697273008396415],\r\n      [141.1508524417877, 39.69687676304167],\r\n      [141.15146398544312, 39.69657957753276],\r\n      [141.15143179893494, 39.697273008396415]\r\n    ]],\r\n    style: {\r\n      stroke: {\r\n        color: [0, 255, 0],\r\n        width: 2\r\n      },\r\n      fill: {\r\n        color: [0, 255, 0, 0.4]\r\n      }\r\n    }\r\n  });\r\n  app.addPoiLayer(\"main2\");\r\n  app.addPoiLayer(\"morioka_ndl2#main2\", {\r\n    icon: \"parts_test/blue_marker.png\",\r\n    selectedIcon: \"parts_test/red_marker.png\"\r\n  });\r\n  document.getElementById(\"show\").addEventListener(\"click\", () => app.showPoiLayer(\"main\"));\r\n  document.getElementById(\"hide\").addEventListener(\"click\", () => app.hidePoiLayer(\"main\"));\r\n  document.getElementById(\"clear\").addEventListener(\"click\", () => app.clearMarker(\"main\"));\r\n  document.getElementById(\"move\").addEventListener(\"click\", () => {\r\n    let data;\r\n    if (moveFlag) {\r\n      data = { lnglat: [141.145358, 39.69862] };\r\n    } else {\r\n      data = { lnglat: [141.146534, 39.694758] };\r\n    }\r\n    moveFlag = !moveFlag;\r\n    app.updateMarker(\"main_1\", data);\r\n  });\r\n  document.getElementById(\"remove\").addEventListener(\"click\", () => app.removeMarker(\"main_2\"));\r\n  document.getElementById(\"add2\").addEventListener(\"click\", () => app.addMarker({\r\n    address: \"1-42\",\r\n    desc: \"\",\r\n    icon: undefined,\r\n    image: \"sakurayama_jinja.jpg\",\r\n    lnglat: [141.151995, 39.701599],\r\n    name: \"\",\r\n    selectedIcon: undefined,\r\n    start: 1749\r\n  }, \"main2\"));\r\n  document.getElementById(\"clear2\").addEventListener(\"click\", () => app.clearMarker(\"main2\"));\r\n  document.getElementById(\"addMap\").addEventListener(\"click\", () => app.addMarker({\r\n    address: \"1-37\",\r\n    desc: \"\",\r\n    icon: undefined,\r\n    image: \"moriokajo.jpg\",\r\n    lnglat: [141.1501111, 39.69994722],\r\n    name: { ja: \"\", en: \"Morioka Castle\" },\r\n    selectedIcon: undefined,\r\n    start: 1598\r\n  }, \"morioka_ndl2#main2\"));\r\n  document.getElementById(\"clearMap\").addEventListener(\"click\", () => app.clearMarker(\"morioka_ndl2#all\"));\r\n  document.getElementById(\"unSelect\").addEventListener(\"click\", () => app.unselectMarker());\r\n  document.getElementById(\"showAll\").addEventListener(\"click\", () => app.showAllMarkers());\r\n  document.getElementById(\"hideAll\").addEventListener(\"click\", () => app.hideAllMarkers());\r\n  document.getElementById(\"morioka\").addEventListener(\"click\", () => app.changeMap(\"morioka\"));\r\n  document.getElementById(\"maplat\").addEventListener(\"click\", () => app.changeMap(\"morioka_ndl2\"));\r\n  document.getElementById(\"tms\").addEventListener(\"click\", () => app.changeMap(\"morioka_ndl_affine\"));\r\n  document.getElementById(\"osm\").addEventListener(\"click\", () => app.changeMap(\"osm\"));\r\n  document.getElementById(\"gsi\").addEventListener(\"click\", () => app.changeMap(\"gsi\"));\r\n  document.getElementById(\"mapbox\").addEventListener(\"click\", () => app.changeMap(\"mapbox\"));\r\n  document.getElementById(\"go_home\").addEventListener(\"click\", () => app.goHome());\r\n  document.getElementById(\"reset_rotation\").addEventListener(\"click\", () => app.resetRotation());\r\n  document.getElementById(\"reset_direction\").addEventListener(\"click\", () => app.resetDirection());\r\n  document.getElementById(\"reset_circulation\").addEventListener(\"click\", () => app.resetCirculation());\r\n  document.getElementById(\"map_remove\").addEventListener(\"click\", () => app.remove());\r\n})();"],"names":["module","exports","reInterpolate","templateSettings","INFINITY","MAX_SAFE_INTEGER","argsTag","asyncTag","domExcTag","errorTag","funcTag","genTag","nullTag","objectTag","proxyTag","symbolTag","undefinedTag","reEmptyStringLeading","reEmptyStringMiddle","reEmptyStringTrailing","reEsTemplate","reIsHostCtor","reIsUint","reNoMatch","reUnescapedString","typedArrayTags","stringEscapes","freeGlobal","g","Object","freeSelf","self","root","Function","freeExports","nodeType","freeModule","moduleExports","freeProcess","process","nodeUtil","types","require","binding","e","nodeIsTypedArray","isTypedArray","apply","func","thisArg","args","length","call","arrayMap","array","iteratee","index","result","Array","escapeStringChar","chr","overArg","transform","arg","uid","funcProto","prototype","objectProto","coreJsData","funcToString","toString","hasOwnProperty","maskSrcKey","exec","keys","IE_PROTO","nativeObjectToString","objectCtorString","reIsNative","RegExp","replace","Buffer","undefined","Symbol","getPrototype","getPrototypeOf","propertyIsEnumerable","symToStringTag","toStringTag","defineProperty","value","isObject","isMasked","pattern","isFunction","test","toSource","baseIsNative","object","key","getValue","nativeIsBuffer","isBuffer","nativeKeys","nativeMax","Math","max","nativeNow","Date","now","symbolProto","symbolToString","arrayLikeKeys","inherited","isArr","isArray","isArg","isArguments","isBuff","isType","skipIndexes","n","baseTimes","String","isIndex","push","assignValue","objValue","eq","baseAssignValue","baseGetTag","isOwn","tag","unmasked","getRawTag","objectToString","baseIsArguments","isObjectLike","baseKeysIn","nativeKeysIn","isProto","isPrototype","baseRest","start","setToString","arguments","otherArgs","this","overRest","identity","baseSetToString","string","baseToString","isSymbol","customDefaultsAssignIn","srcValue","type","isIterateeCall","isArrayLike","Ctor","constructor","count","lastCalled","stamp","remaining","other","isLength","isError","message","name","proto","isPlainObject","baseUnary","assigner","assignInWith","source","srcIndex","customizer","props","isNew","newValue","copyObject","keysIn","sources","guard","baseKeys","attempt","Error","options","settings","imports","_","isEscaping","isEvaluating","importsKeys","importsValues","interpolate","reDelimiters","escape","evaluate","sourceURL","match","escapeValue","interpolateValue","esTemplateValue","evaluateValue","offset","slice","variable","reUnescapedHtml","reHasUnescapedHtml","escapeHtmlChar","_typeof","o","iterator","_classCallCheck","instance","Constructor","TypeError","toPropertyKey","t","i","r","toPrimitive","Number","_defineProperties","target","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_assertThisInitialized","ReferenceError","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inherits","subClass","superClass","create","_possibleConstructorReturn","_getPrototypeOf","_defineProperty","obj","_arrayLikeToArray","arr","len","arr2","_toArray","iter","from","minLen","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","forEach","getOwnPropertyDescriptors","defineProperties","consoleLogger","log","output","warn","error","console","Logger","concreteLogger","init","prefix","logger","debug","bool","_len","_key","forward","_len2","_key2","_len3","_key3","_len4","_key4","lvl","debugOnly","concat","moduleName","baseLogger","EventEmitter","observers","events","listener","_this","split","event","l","observer","defer","res","rej","promise","Promise","resolve","reject","makeString","getLastOfPath","path","Empty","cleanKey","indexOf","canNotTraverseDeeper","stack","shift","k","setPath","_getLastOfPath","getPath","_getLastOfPath3","getPathWithDefaults","data","defaultData","deepExtend","overwrite","prop","regexEscape","str","_entityMap","s","isIE10","window","navigator","userAgentData","userAgent","chars","ownKeys$1","_objectSpread$1","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Boolean","valueOf","_isNativeReflectConstruct","Super","NewTarget","deepFind","keySeparator","paths","current","j","join","mix","endsWith","joinedPath","ResourceStore","_EventEmitter","_super","ns","defaultNS","ignoreJSONStructure","splice","lng","silent","addNamespaces","emit","resources","m","addResource","deep","pack","hasResourceBundle","removeNamespaces","getResource","compatibilityAPI","getDataByLanguage","find","v","postProcessor","processors","addPostProcessor","handle","translator","processor","ownKeys$2","_objectSpread$2","_createSuper$1","_isNativeReflectConstruct$1","checkedLoadedFor","Translator","services","a","copy","language","interpolation","resolved","nsSeparator","namespaces","wouldCheckForNsInKey","seemsNaturalLanguage","userDefinedKeySeparator","userDefinedNsSeparator","possibleChars","c","map","matched","ki","substring","looksLikeObjectPath","interpolator","nestingRegexp","parts","lastKey","_this2","overloadTranslationOptionHandler","returnDetails","_this$extractFromKey","extractFromKey","namespace","appendNamespaceToCIMode","toLowerCase","resUsedKey","usedKey","resExactUsedKey","exactUsedKey","resType","joinArrays","handleAsObjectInI18nFormat","i18nFormat","handleAsObject","returnObjects","returnedObjectHandler","resTypeIsArray","newKeyToUse","deepKey","translate","extendTranslation","usedDefault","needsPluralHandling","hasDefaultValue","defaultValueSuffix","pluralResolver","getSuffix","defaultValue","isValidLookup","resForMissing","missingKeyNoValueFallbackToKey","updateMissing","fk","lngs","fallbackLngs","languageUtils","getFallbackCodes","fallbackLng","saveMissingTo","toResolveHierarchy","send","specificDefaultValue","defaultForMissing","missingKeyHandler","backendConnector","saveMissing","saveMissingPlurals","getSuffixes","suffix","appendNamespaceToMissingKey","parseMissingKeyHandler","_this3","parse","defaultVariables","usedLng","usedNS","skipInterpolation","nestBef","skipOnVariables","nb","na","nest","context","reset","postProcess","postProcessorNames","applyPostProcessor","postProcessPassResolved","i18nResolved","found","_this4","extracted","fallbackNS","needsZeroSuffixLookup","ordinal","shouldUseIntlApi","needsContextHandling","codes","utils","hasLoadedNamespace","code","possibleKey","finalKeys","addLookupKeys","pluralSuffix","zeroSuffix","contextKey","contextSeparator","pop","returnNull","returnEmptyString","resourceStore","option","capitalize","charAt","toUpperCase","LanguageUtil","supportedLngs","formatLanguageCode","specialCases","lowerCaseLng","part","cleanCode","load","nonExplicitSupportedLngs","getLanguagePartFromCode","cleanedLng","isSupportedCode","lngOnly","supportedLng","fallbacks","getScriptPartFromCode","fallbackCode","fallbackCodes","addCode","fc","sets","nr","_rulesPluralsTypes","deprecatedJsonVersions","suffixesOrder","zero","one","two","few","many","PluralResolver","rules","compatibilityJSON","Intl","PluralRules","set","numbers","plurals","_unused","rule","getRule","resolvedOptions","pluralCategories","sort","pluralCategory1","pluralCategory2","pluralCategory","prepend","number","select","getSuffixRetroCompatible","idx","noAbs","abs","simplifyPluralSuffix","returnSuffix","includes","ownKeys$3","_objectSpread$3","Interpolator","format","iOpts","useRawValueToEscape","prefixEscaped","suffixEscaped","formatSeparator","unescapePrefix","unescapeSuffix","nestingPrefix","nestingPrefixEscaped","nestingSuffix","nestingSuffixEscaped","nestingOptionsSeparator","maxReplaces","alwaysFormat","resetRegExp","regexpStr","regexp","regexpUnescapeStr","regexpUnescape","nestingRegexpStr","replaces","regexSafe","val","handleFormat","interpolationkey","trim","f","missingInterpolationHandler","regex","safeValue","todo","matchedVar","temp","lastIndex","clonedOptions","handleHasOptions","inheritedOptions","sep","optionsString","JSON","formatters","doReduce","elem","reduce","ownKeys$4","_objectSpread$4","Formatter","formats","NumberFormat","currency","style","datetime","DateTimeFormat","relativetime","RelativeTimeFormat","range","list","ListFormat","_format","mem","_parseFormatStr","formatStr","formatName","formatOptions","optStr","opt","_opt$split2","isNaN","parseInt","parseFormatStr","formatted","valOptions","formatParams","locale","ownKeys$5","_objectSpread$5","_createSuper$2","_isNativeReflectConstruct$2","Connector","backend","store","waitingReads","maxParallelReads","readingCalls","state","queue","languages","callback","toLoad","pending","toLoadLanguages","toLoadNamespaces","hasAllNamespaces","reload","pendingCount","loaded","errors","err","addResourceBundle","q","_getLastOfPath2","removePending","done","loadedKeys","fcName","tried","wait","setTimeout","read","next","queueLoad","loadOne","prepareLoading","_this5","fallbackValue","isUpdate","transformOptions","ownKeys$6","_objectSpread$6","_createSuper$3","_isNativeReflectConstruct$3","noop","I18n","inst","modules","external","getOwnPropertyNames","isInitialized","isClone","initImmediate","defOpts","preload","pluralSeparator","partialBundledLanguages","ret","tDescription","createClassOnDemand","ClassOrObject","formatter","lu","on","languageDetector","detection","_this2$store","_this2$store2","deferred","finish","initializedStoreOnce","changeLanguage","usedCallback","append","resolvedLanguage","setResolvedLanguage","li","lngInLngs","hasLanguageSomeTranslations","isLanguageChangingTo","setLngProps","setLng","getBestMatchFromCodes","cacheUserLanguage","loadResources","async","detect","keyPrefix","fixedT","opts","rest","resultKey","_this$translator","_this$translator2","exists","_this6","lastLng","loadNotPending","loadState","precheck","preResult","_this7","preloaded","newLngs","_this8","mergedOptions","clone","createInstance","reloadResources","use","getFixedT","setDefaultNamespace","loadNamespaces","loadLanguages","each","addQueryString","url","params","queryString","encodeURIComponent","paramName","ajax","cache","queryStringParams","x","XMLHttpRequest","ActiveXObject","open","crossDomain","setRequestHeader","withCredentials","overrideMimeType","h","customHeaders","onreadystatechange","readyState","responseText","Backend","defaults","loadPath","addPath","allowMultiLoading","parsePayload","loadUrl","xhr","status","payload","Event","detail","super","ua","lang","browserLanguage","userLanguage","excludeKeys","LOGGER_LEVEL","ALL","DEBUG","INFO","WARN","ERROR","OFF","level","make","MERC_MAX","MERC_CROSSMATRIX","transPng","tileSize","canvBase","nodesLoader","nodes","responseType","onload","_e","resp","response","normalizeLayers","layers","all","prev","layer","id","properties","normalizeLayer","main","addIdToPoi","pois","normalizePoi","buffer","assign","features","namespaceID","poi","lnglat","geometry","coordinates","longitude","lat","latitude","cluster","__nextId","setCustomFunction","Base","officialTitle","title","mapID","label","homeMarginPixels","getCacheEnable","weiwudi","stats","getTileCacheStatsAsync","size","listner","deleteListner","removeEventListener","addEventListener","fetchAll","cancel","clean","getMap","_map","setMap","setViewpointRadian","cond","merc","xy","mercZoom","zoom","direction","rotation","view","getView","y","viewpoint2MercsAsync","then","mercs","mercs2MercViewpoint","mercViewpoint","mercViewpoint2Mercs","mercs2ViewpointAsync","viewpoint","setCenter","setZoom","setRotation","setViewpoint","PI","goHome","div","getTarget","document","getElementById","screenSize","clientWidth","clientHeight","homePosition","defZoom","northUp","resetRotation","resetDirection","resetCirculation","setGPSMarkerAsync","position","ignoreMove","_reject","setGPSPosition","mercsFromGPSValue","acc","mercs2SysCoordsAsync_multiLayer","results","hide","xys","sub","pos","insideCheckSysCoord","handleGPS","news","rad","curr","sqrt","pow","catch","setGPSMarker","latrad","delta","cos","rotateMatrix","theta","getRotation","sin","getPoi","addPoi","clusterId","removePoi","clearPoi","listPoiLayers","hideOnly","nonzero","b","getPoiLayer","addPoiLayer","removePoiLayer","merc2SysCoordAsync_ignoreBackground","merc2XyAsync_ignoreBackground","xy2SysCoord","merc2SysCoordAsync","merc2XyAsync","sysCoord2MercAsync","sysCoord","sysCoord2Xy","xy2MercAsync","zoom2Radius","radius","floor","min","getDecimalZoom","viewpoint2SysCoords","center","rotate","getCenter","getSize","sysCoords2Viewpoint","sysCoords","neswDelta","normal","abss","cosx","sinx","norm","outer","inner","acos","scale","omega","atan2","sysCoords2Xys","xys2SysCoords","mercs2XysAsync","xys2MercsAsync","META_KEYS","META_KEYS_OPTION","setCustomInitialize","normalizeArg","maxZoom","minZoom","poiTemplate","poiStyle","iconTemplate","icon","selectedIcon","mercatorXShift","mercatorYShift","envelopeLngLats","envelope","centroid","option_key","thumbWait","thumbnail","fetch","ok","_error","sourceID","poisWait","resolvePois","initialWait","setupTileLoadFunction","setTileLoadFunction","tileLoadFn","getTileLoadFunction","tile","_src","tileCoord","tileX","tileY","pixelXShift","round","pixelYShift","tmp","createElement","innerHTML","tCanv","childNodes","promises","item","tileUrlFunction","tilePixelRatio_","projection_","_tileCoord","src","sx","sy","sw","sh","loader","fallback","tImage","crossOrigin","onerror","width","height","ctx","getContext","dx","dy","drawImage","tImageLoader","rets","handleImageError_","dataUrl","toDataURL","getImage","_err","domStr","fragment","createDocumentFragment","appendChild","node","nodeName","script","text","normalizeDegree","degree","createMapInfo","table","max_zoom","min_zoom","envelope_lnglats","envelopLngLats","image_extention","image_extension","imageExtention","map_id","source_id","merc_max_zoom","merc_min_zoom","zoom_restriction","enable_cache","default_zoom","start_from","home_position","fake_radius","fake_center","fake_gps","app_name","setting_file","merc_zoom","mapbox_token","translate_ui","restore_session","no_rotate","poi_template","poi_style","icon_template","default_center","default_rotation","selected_icon","namespace_id","mercator_x_shift","mercator_y_shift","Property","GeolocationErrorType","GeolocationError","Geolocation","once","un","position_","transform_","watchId_","addChangeListener","handleProjectionChanged_","handleTrackingChanged_","projection","setProjection","trackingOptions","setTrackingOptions","setTracking","tracking","disposeInternal","getProjection","getTracking","geolocation","watchPosition","positionChange_","positionError_","getTrackingOptions","clearWatch","coords","accuracy","altitude","altitudeAccuracy","heading","projectedPosition","speed","applyTransform","changed","dispatchEvent","getAccuracy","get","getAccuracyGeometry","getAltitude","getAltitudeAccuracy","getHeading","getPosition","getSpeed","View","resolution","getResolution","maxResolution_","minZoom_","CanvasTileLayerRenderer","tileLayer","extentChanged","renderedExtent_","renderedPixelRatio","renderedProjection","renderedRevision","renderedTiles","newTiles_","tmpExtent","tmpTileRange_","TileRange","isDrawableTile","getLayer","tileState","getState","useInterimTilesOnError","getUseInterimTilesOnError","TileState","getTile","z","frameState","pixelRatio","viewState","getSource","getPreload","getInterimTile","getData","pixel","coordinate","pixelToCoordinateTransform","layerExtent","getExtent","getRenderSource","tileGrid","getTileGridForProjection","tilePixelRatio","getTilePixelRatio","getZForResolution","getMinZoom","getTileCoordForCoordAndZ","ImageTile","tileOrigin","getOrigin","getTileSize","tileResolution","col","row","gutter","getGutterForProjection","getImageData","loadedTileCallback","tiles","prepareFrame","renderFrame","layerState","layerStatesArray","layerIndex","viewResolution","viewCenter","tileSource","sourceRevision","getRevision","zDirection","extent","canvasExtent","tileRange","getTileRangeForExtentAndZ","tilesToDrawByZ","findLoadedTiles","createLoadedTileFinder","tmpTileRange","viewport","minX","maxX","minY","maxY","tileCoordIntersectsViewport","inTransition","opacity","endTransition","getAlpha","time","childTileRange","getTileCoordChildTileRange","covered","forEachTileCoordParentTileRange","canvasScale","pixelTransform","canvasTransform","useContainer","getBackground","canvas","inversePixelTransform","tempTransform","containerReused","clearRect","clipUnrotated","getInterpolate","imageSmoothingEnabled","preRender","clips","clipZs","currentClip","zs","getOpaque","reverse","currentZ","currentTilePixelSize","getTilePixelSize","currentScale","originTileCoord","originTileExtent","getTileCoordExtent","origin","tileGutter","tilesToDraw","tileCoordKey","xIndex","nextX","yIndex","nextY","w","transition","contextSaved","ii","clip","save","beginPath","moveTo","lineTo","drawTileImage","restore","unshift","updateUsedTiles","usedTiles","renderedResolution","manageTilePyramid","scheduleExpireCache","postRender","container","image","getTileImage","alpha","alphaChanged","globalAlpha","animate","canExpireCache","postRenderFunction","tileSourceKey","expireCache","postRenderFunctions","getKey","tileCallback","wantedTiles","tileQueue","tileCount","isKeyQueued","enqueue","getTileCoordCenter","useTile","updateCacheSize","TileLayer","BaseTile","createRenderer","Circle","SimpleGeometry","layout","setFlatCoordinates","setCenterAndRadius","circle","flatCoordinates","applyProperties","closestPointXY","closestPoint","minSquaredDistance","squaredDistance","stride","getRadius","containsXY","getRadiusSquared_","computeExtent","getType","intersectsExtent","circleExtent","intersectsCoordinate","setLayout","deflate","getCoordinates","setCoordinates","setRadius","angle","anchor","getStride","OSM","XYZ","attributions","attributionsCollapsible","cacheSize","opaque","reprojectionErrorThreshold","tileLoadFunction","wrapX","booleanPointInPolygon","point","polygon","pt","geom","bbox","polys","inBBox","insidePoly","inRing","ignoreBoundary","inHole","ring","isInside","xi","yi","xj","yj","NowMap","imageExtension","urls","tms","static","insideCheckXy","histCoords","modulateXyInside","expandLine","intersect","modulateSysCoordInside","MapboxMap","accessToken","mapboxMap","randomFromCenter","random","recursiveRound","decimal","decVal","radians","deg","MapboxLayer","render","mbMap","setStyle","getCanvas","visible","getVisible","display","getOpacity","newBearing","newLonLat","newZoom","nowBearing","getBearing","nowLonLat","toArray","nowZoom","getZoom","rotateTo","jumpTo","_frame","_render","gpsStyle","Style","Icon","anchorXUnits","anchorYUnits","gpsHideStyle","gpsSubStyle","accCircleStyle","fill","Fill","color","stroke","Stroke","markerDefaultStyle","defaultpin","MaplatMap","Map","optOptions","vectorLayer","markerLayer","featureLayer","envelopeLayer","baseLayer","spawnLayer","overlayLayer","Group","controls","defaultCenter","defaultZoom","defaultRotation","multiWorld","interactions","_overlay_group","fakeGps","fakeRadius","tapDuration","tapUIVanish","__AvoidFirstMoveStart","movestart","setSource","recur","filtered","getArray","getLayers","setFeature","feature","Feature","addFeature","removeFeature","resetFeature","clear","Point","setMarker","markerStyle","resetMarker","setLine","setVector","styleObj","LineString","Polygon","resetLine","resetVector","setEnvelope","removeEnvelope","resetEnvelope","setFillEnvelope","exchangeSource","prevLayer","setAt","setLayer","setTransparency","percentage","setOpacity","launch","avoidEventForOff","_first_gps_request","_evt","lnglat1","lnglat2","gpsVal","MapEvent","DragRotateAndZoom","Pointer","condition_","condition","lastAngle_","lastMagnitude_","lastScaleDelta_","duration_","duration","handleDragEvent","mapBrowserEvent","deltaX","deltaY","magnitude","angleDelta","adjustRotationInternal","adjustResolutionInternal","handleUpEvent","endInteraction","handleDownEvent","beginInteraction","maxxy","units","HistMap","zW","log2","zH","ceil","coord","_tileUrlFunction","_maxxy","da","screenWidth","screenHeight","delZoomOfWidth","delZoomOfHeight","delZoom","TmsMap","BASEURL","swChecking","swChecked","CustomEvent","bubbles","cancelable","evt","createEvent","initCustomEvent","EventTarget","listeners","defaultPrevented","Weiwudi","swOptions","reg","serviceWorker","register","newWorker","installing","waitingWoker","waiting","location","onupdatefound","update","swCheck","URLSearchParams","URL","search","href","attrs","release","checkAspect","removeMap","transformDirect","dist","srcCode","getCode","distCode","srcFunc","distFunc","invFunc","store2HistMap_internal","byCompiled","coreLogic","tins","compiled","wh","strictMode","vertexMode","yaxisMode","tin","setCompiled","getCompiled","gcps","points","edges","createTinFromGcpsAsync","sub_maps","sub_map","importance","priority","bounds","strict","vertex","yaxis","setWh","setBounds","setStrictMode","setVertexMode","setPoints","setEdges","updateTinAsync","HistMap_tin","histmaps","store2HistMap4Core","proj","Projection","projKey","xyBounds","mercBounds","xyBoundsPolygon","mercBoundsPolygon","xy2MercAsync_specifyLayer","layerId","layerKey","merc2XyAsync_specifyLayer","xy2MercAsync_returnLayer","tinSorted","merc2XyAsync_returnLayer","priIndex","arry","targetTin","storedTin","_row","setupMapParameter","mercCenter","dir4","proms","prom","centerXy","merc2XyAsync_base","ignoreBackground","cross","centerMerc","global","globalThis","support","searchParams","iterable","blob","Blob","formData","arrayBuffer","viewClasses","isArrayBufferView","ArrayBuffer","isView","normalizeName","normalizeValue","iteratorFor","items","Headers","headers","header","consumed","body","bodyUsed","fileReaderReady","reader","readBlobAsArrayBuffer","FileReader","readAsArrayBuffer","bufferClone","buf","Uint8Array","byteLength","Body","_initBody","_bodyInit","_bodyText","isPrototypeOf","_bodyBlob","FormData","_bodyFormData","DataView","_bodyArrayBuffer","rejected","isConsumed","byteOffset","readAsText","fromCharCode","readArrayBufferAsText","decode","json","oldValue","has","values","entries","methods","Request","input","method","upcased","credentials","mode","signal","referrer","reParamSearch","getTime","form","bytes","decodeURIComponent","Response","bodyInit","statusText","redirectStatuses","redirect","RangeError","DOMException","request","aborted","abortXhr","abort","rawHeaders","getAllResponseHeaders","substr","line","responseURL","ontimeout","onabort","fixUrl","polyfill","baseDict","osm","ja","en","attr","maptype","gsi","gsi_ortho","mapSourceFactory","commonOptions","year","targetSrc","homePos","zoomRestriction","mercMaxZoom","mercMinZoom","registerMapToSW","createAsync","noload","settingFile","setting","enableCache","lngLats","minMax","Infinity","registerMap","createIconSet","ancestors","dataCopy","fromAncestor","createHtmlFromTemplate","html","MaplatApp","appOption","translateUI","noRotate","initialRestore","mapDiv","restoreSession","stateBuffer","overlay","appLang","timer","startFrom","vectors","__backMapMoving","__init","__redrawMarkerBlock","__redrawMarkerThrottle","appid","mapboxgl","mapboxToken","mapDivDocument","querySelector","classList","add","lastEpoch","localStorage","getItem","currentTime","backgroundID","parseFloat","transparency","hideMarker","hideLayer","newElems","insertBefore","firstChild","prevDefs","querySelectorAll","preventDefault","waitReady","settingLoader","handleSetting","localesFlag","mapReturnValue","dataSource","appData","sourcePromise","commonOption","i18nLoader","handleI18n","i18nObj","i18n","prepareMap","handlePois","mercBuffer","appName","fake","currentPosition","frontDiv","newElem","mapObject","altShiftDragRotate","pinchRotate","extend","backDiv","backMap","off_control","mapboxDiv","attributionControl","boxZoom","doubleClickZoom","dragPan","dragRotate","interactive","keyboard","pitchWithRotate","scrollZoom","touchZoomRotate","sourcesLoader","handleSources","mercSrc","cacheHash","setInitialMap","setMapClick","setPointerEvents","setMapOnOff","setMouseCursor","setBackMapBehavior","raiseChangeViewpoint","initial","changeMap","lastClickEvent","forEachFeatureAtPixel","xyBuffer","dragging","pointerCounter","pointermoveHandler","originalEvent","pointerId","touches","clearTimeout","ctls","contains","remove","getEventPixel","hit","hasFeatureAtPixel","cursor","histCoord","backSrc","convertParametersFromCurrent","mobileMapMoveBuffer","ll","mercator_x","mercator_y","requestUpdateState","currentMapInfo","mapInfo","__selectedMarker","datum","xyPromises","merc2XyRecurse","isLnglat","lnglats","redrawMarkers","throttle","redrawLogic","selected","promise_var","selectMarker","getMarker","latlng","unselectMarker","splits","updateMarker","addMarker","dispatchPoiNumber","removeMarker","clearMarker","showAllMarkers","hideAllMarkers","appPois","mapPois","showPoiLayer","hidePoiLayer","addLine","addVector","clearLine","clearVector","to","changeMapSeq","backTo","backRestore","backToLocal","updateState","setMaxZoom","setMinZoom","getMapMeta","updateSize","renderSync","setItem","loopSession","removeItem","__transparency","getTransparency","useTo","getMapCacheEnable","getMapTileCacheStatsAsync","clearTileCacheAsync","fetchAllTileCacheAsync","cancelTileCacheAsync","fromPromise","_rej","toPromise","dataFragment","langs","app","moveFlag","stringify","address","desc"],"sourceRoot":""}